(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{190:function(t,e,n){"use strict";var i=n(279);n.d(e,"b",(function(){return i.a}));var r=n(221);n.d(e,"a",(function(){return r.c}))},191:function(t,e,n){"use strict";n.d(e,"h",(function(){return m})),n.d(e,"c",(function(){return S})),n.d(e,"a",(function(){return M})),n.d(e,"b",(function(){return A})),n.d(e,"d",(function(){return En})),n.d(e,"f",(function(){return Qn})),n.d(e,"j",(function(){return bi})),n.d(e,"i",(function(){return Ni})),n.d(e,"k",(function(){return ji})),n.d(e,"l",(function(){return Ba.b})),n.d(e,"e",(function(){return Ba.a})),n.d(e,"g",(function(){return za})),n.d(e,"m",(function(){return Uo})),n.d(e,"n",(function(){return Io}));var i=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},r=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return i(e(t),n)}),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)<0?i=a+1:r=a}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)>0?r=a:i=a+1}return i}}};var a=r(i),o=a.right,s=(a.left,o);var l=Array.prototype,c=(l.slice,l.map,function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a}),u=Math.sqrt(50),h=Math.sqrt(10),d=Math.sqrt(2),p=function(t,e,n){var i,r,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=f(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(r=Math.ceil(t-e+1));++s<r;)a[s]=(t-s)/o;return i&&a.reverse(),a};function f(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=u?10:a>=h?5:a>=d?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=u?10:a>=h?5:a>=d?2:1)}function g(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=u?r*=10:a>=h?r*=5:a>=d&&(r*=2),e<t?-r:r}var m=function(t,e){var n,i,r=t.length,a=-1;if(null==e){for(;++a<r;)if(null!=(n=t[a])&&n>=n)for(i=n;++a<r;)null!=(n=t[a])&&n>i&&(i=n)}else for(;++a<r;)if(null!=(n=e(t[a],a,t))&&n>=n)for(i=n;++a<r;)null!=(n=e(t[a],a,t))&&n>i&&(i=n);return i};var b=Array.prototype.slice,v=function(t){return t};function y(t){return"translate("+(t+.5)+",0)"}function _(t){return"translate(0,"+(t+.5)+")"}function w(t){return function(e){return+t(e)}}function x(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function C(){return!this.__axis}function E(t,e){var n=[],i=null,r=null,a=6,o=6,s=3,l=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",u=1===t||3===t?y:_;function h(h){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,p=null==r?e.tickFormat?e.tickFormat.apply(e,n):v:r,f=Math.max(a,0)+s,g=e.range(),m=+g[0]+.5,b=+g[g.length-1]+.5,y=(e.bandwidth?x:w)(e.copy()),_=h.selection?h.selection():h,E=_.selectAll(".domain").data([null]),S=_.selectAll(".tick").data(d,e).order(),M=S.exit(),A=S.enter().append("g").attr("class","tick"),O=S.select("line"),k=S.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(A),O=O.merge(A.append("line").attr("stroke","currentColor").attr(c+"2",l*a)),k=k.merge(A.append("text").attr("fill","currentColor").attr(c,l*f).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==_&&(E=E.transition(h),S=S.transition(h),O=O.transition(h),k=k.transition(h),M=M.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=y(t))?u(t):this.getAttribute("transform")})),A.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return u(e&&isFinite(e=e(t))?e:y(t))}))),M.remove(),E.attr("d",4===t||2==t?o?"M"+l*o+","+m+"H0.5V"+b+"H"+l*o:"M0.5,"+m+"V"+b:o?"M"+m+","+l*o+"V0.5H"+b+"V"+l*o:"M"+m+",0.5H"+b),S.attr("opacity",1).attr("transform",(function(t){return u(y(t))})),O.attr(c+"2",l*a),k.attr(c,l*f).text(p),_.filter(C).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),_.each((function(){this.__axis=y}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=b.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:b.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(i=null==t?null:b.call(t),h):i&&i.slice()},h.tickFormat=function(t){return arguments.length?(r=t,h):r},h.tickSize=function(t){return arguments.length?(a=o=+t,h):a},h.tickSizeInner=function(t){return arguments.length?(a=+t,h):a},h.tickSizeOuter=function(t){return arguments.length?(o=+t,h):o},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function S(t){return E(2,t)}function M(t){return E(3,t)}function A(t){return E(4,t)}var O={value:function(){}};function k(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new T(i)}function T(t){this._=t}function N(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function L(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function D(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=O,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}T.prototype=k.prototype={constructor:T,on:function(t,e){var n,i=this._,r=N(t+"",i),a=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=r[a]).type)i[n]=D(i[n],t.name,e);else if(null==e)for(n in i)i[n]=D(i[n],t.name,null);return this}for(;++a<o;)if((n=(t=r[a]).type)&&(n=L(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new T(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};var I=k,P=n(279),j=n(221);var R=function(){j.c.preventDefault(),j.c.stopImmediatePropagation()},F=function(t){var e=t.document.documentElement,n=Object(P.a)(t).on("dragstart.drag",R,!0);"onselectstart"in e?n.on("selectstart.drag",R,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function B(t,e){var n=t.document.documentElement,i=Object(P.a)(t).on("dragstart.drag",null);e&&(i.on("click.drag",R,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var H=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function $(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function q(){}var U="\\s*([+-]?\\d+)\\s*",W="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",z="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",G=/^#([0-9a-f]{3,8})$/,V=new RegExp("^rgb\\("+[U,U,U]+"\\)$"),Z=new RegExp("^rgb\\("+[z,z,z]+"\\)$"),Y=new RegExp("^rgba\\("+[U,U,U,W]+"\\)$"),X=new RegExp("^rgba\\("+[z,z,z,W]+"\\)$"),K=new RegExp("^hsl\\("+[W,z,z]+"\\)$"),J=new RegExp("^hsla\\("+[W,z,z,W]+"\\)$"),Q={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tt(){return this.rgb().formatHex()}function et(){return this.rgb().formatRgb()}function nt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=G.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?it(e):3===n?new st(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?rt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?rt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=V.exec(t))?new st(e[1],e[2],e[3],1):(e=Z.exec(t))?new st(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Y.exec(t))?rt(e[1],e[2],e[3],e[4]):(e=X.exec(t))?rt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=K.exec(t))?ht(e[1],e[2]/100,e[3]/100,1):(e=J.exec(t))?ht(e[1],e[2]/100,e[3]/100,e[4]):Q.hasOwnProperty(t)?it(Q[t]):"transparent"===t?new st(NaN,NaN,NaN,0):null}function it(t){return new st(t>>16&255,t>>8&255,255&t,1)}function rt(t,e,n,i){return i<=0&&(t=e=n=NaN),new st(t,e,n,i)}function at(t){return t instanceof q||(t=nt(t)),t?new st((t=t.rgb()).r,t.g,t.b,t.opacity):new st}function ot(t,e,n,i){return 1===arguments.length?at(t):new st(t,e,n,null==i?1:i)}function st(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function lt(){return"#"+ut(this.r)+ut(this.g)+ut(this.b)}function ct(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ut(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ht(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pt(t,e,n,i)}function dt(t){if(t instanceof pt)return new pt(t.h,t.s,t.l,t.opacity);if(t instanceof q||(t=nt(t)),!t)return new pt;if(t instanceof pt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new pt(o,s,l,t.opacity)}function pt(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function ft(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function gt(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}H(q,nt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tt,formatHex:tt,formatHsl:function(){return dt(this).formatHsl()},formatRgb:et,toString:et}),H(st,ot,$(q,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new st(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new st(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lt,formatHex:lt,formatRgb:ct,toString:ct})),H(pt,(function(t,e,n,i){return 1===arguments.length?dt(t):new pt(t,e,n,null==i?1:i)}),$(q,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new pt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new pt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new st(ft(t>=240?t-240:t+120,r,i),ft(t,r,i),ft(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var mt=function(t){return function(){return t}};function bt(t,e){return function(n){return t+n*e}}function vt(t){return 1==(t=+t)?yt:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):mt(isNaN(e)?n:e)}}function yt(t,e){var n=e-t;return n?bt(t,n):mt(isNaN(t)?e:t)}var _t=function t(e){var n=vt(e);function i(t,e){var i=n((t=ot(t)).r,(e=ot(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=yt(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function wt(t){return function(e){var n,i,r=e.length,a=new Array(r),o=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=ot(e[n]),a[n]=i.r||0,o[n]=i.g||0,s[n]=i.b||0;return a=t(a),o=t(o),s=t(s),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=s(t),i+""}}}wt((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,s=i<e-1?t[i+2]:2*a-r;return gt((n-i/e)*e,o,r,a,s)}})),wt((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],s=t[(i+2)%e];return gt((n-i/e)*e,r,a,o,s)}}));var xt=function(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}};function Ct(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Et(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=Dt(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}var St=function(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}},Mt=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},At=function(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Dt(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},Ot=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kt=new RegExp(Ot.source,"g");var Tt,Nt,Lt=function(t,e){var n,i,r,a=Ot.lastIndex=kt.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=Ot.exec(t))&&(i=kt.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:Mt(n,i)})),a=kt.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})},Dt=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?mt(e):("number"===i?Mt:"string"===i?(n=nt(e))?(e=n,_t):Lt:e instanceof nt?_t:e instanceof Date?St:Ct(e)?xt:Array.isArray(e)?Et:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?At:Mt)(t,e)},It=n(277),Pt=n(280),jt=n(239),Rt=0,Ft=0,Bt=0,Ht=0,$t=0,qt=0,Ut="object"==typeof performance&&performance.now?performance:Date,Wt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function zt(){return $t||(Wt(Gt),$t=Ut.now()+qt)}function Gt(){$t=0}function Vt(){this._call=this._time=this._next=null}function Zt(t,e,n){var i=new Vt;return i.restart(t,e,n),i}function Yt(){$t=(Ht=Ut.now())+qt,Rt=Ft=0;try{!function(){zt(),++Rt;for(var t,e=Tt;e;)(t=$t-e._time)>=0&&e._call.call(null,t),e=e._next;--Rt}()}finally{Rt=0,function(){var t,e,n=Tt,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Tt=e);Nt=t,Kt(i)}(),$t=0}}function Xt(){var t=Ut.now(),e=t-Ht;e>1e3&&(qt-=e,Ht=t)}function Kt(t){Rt||(Ft&&(Ft=clearTimeout(Ft)),t-$t>24?(t<1/0&&(Ft=setTimeout(Yt,t-Ut.now()-qt)),Bt&&(Bt=clearInterval(Bt))):(Bt||(Ht=Ut.now(),Bt=setInterval(Xt,1e3)),Rt=1,Wt(Yt)))}Vt.prototype=Zt.prototype={constructor:Vt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?zt():+n)+(null==e?0:+e),this._next||Nt===this||(Nt?Nt._next=this:Tt=this,Nt=this),this._call=t,this._time=n,Kt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kt())}};var Jt=function(t,e,n){var i=new Vt;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i},Qt=I("start","end","cancel","interrupt"),te=[],ee=function(t,e,n,i,r,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function a(l){var c,u,h,d;if(1!==n.state)return s();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return Jt(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Jt((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function o(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Zt((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Qt,tween:te,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function ne(t,e){var n=re(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ie(t,e){var n=re(t,e);if(n.state>3)throw new Error("too late; already running");return n}function re(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var ae,oe,se,le,ce=function(t,e){var n,i,r,a=t.__transition,o=!0;if(a){for(r in e=null==e?null:e+"",a)(n=a[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[r]):o=!1;o&&delete t.__transition}},ue=180/Math.PI,he={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},de=function(t,e,n,i,r,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*ue,skewX:Math.atan(l)*ue,scaleX:o,scaleY:s}};function pe(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],l=[];return a=t(a),o=t(o),function(t,i,r,a,o,s){if(t!==r||i!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:Mt(t,r)},{i:l-2,x:Mt(i,a)})}else(r||a)&&o.push("translate("+r+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(r(n)+"rotate(",null,i)-2,x:Mt(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(a.rotate,o.rotate,s,l),function(t,e,n,a){t!==e?a.push({i:n.push(r(n)+"skewX(",null,i)-2,x:Mt(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(a.skewX,o.skewX,s,l),function(t,e,n,i,a,o){if(t!==n||e!==i){var s=a.push(r(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Mt(t,n)},{i:s-2,x:Mt(e,i)})}else 1===n&&1===i||a.push(r(a)+"scale("+n+","+i+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var fe=pe((function(t){return"none"===t?he:(ae||(ae=document.createElement("DIV"),oe=document.documentElement,se=document.defaultView),ae.style.transform=t,t=se.getComputedStyle(oe.appendChild(ae),null).getPropertyValue("transform"),oe.removeChild(ae),t=t.slice(7,-1).split(","),de(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),ge=pe((function(t){return null==t?he:(le||(le=document.createElementNS("http://www.w3.org/2000/svg","g")),le.setAttribute("transform",t),(t=le.transform.baseVal.consolidate())?(t=t.matrix,de(t.a,t.b,t.c,t.d,t.e,t.f)):he)}),", ",")",")"),me=n(231);function be(t,e){var n,i;return function(){var r=ie(this,t),a=r.tween;if(a!==n)for(var o=0,s=(i=n=a).length;o<s;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function ve(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var a=ie(this,t),o=a.tween;if(o!==i){r=(i=o).slice();for(var s={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=s;break}l===c&&r.push(s)}a.tween=r}}function ye(t,e,n){var i=t._id;return t.each((function(){var t=ie(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return re(t,i).value[e]}}var _e=function(t,e){var n;return("number"==typeof e?Mt:e instanceof nt?_t:(n=nt(e))?(e=n,_t):Lt)(t,e)};function we(t){return function(){this.removeAttribute(t)}}function xe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ce(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===i?r:r=e(i=o,n)}}function Ee(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===i?r:r=e(i=o,n)}}function Se(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttribute(t)}}function Me(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function Ae(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Oe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ke(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Oe(t,r)),n}return r._value=e,r}function Te(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Ae(t,r)),n}return r._value=e,r}function Ne(t,e){return function(){ne(this,t).delay=+e.apply(this,arguments)}}function Le(t,e){return e=+e,function(){ne(this,t).delay=e}}function De(t,e){return function(){ie(this,t).duration=+e.apply(this,arguments)}}function Ie(t,e){return e=+e,function(){ie(this,t).duration=e}}function Pe(t,e){if("function"!=typeof e)throw new Error;return function(){ie(this,t).ease=e}}var je=n(251);function Re(t,e,n){var i,r,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ne:ie;return function(){var o=a(this,t),s=o.on;s!==i&&(r=(i=s).copy()).on(e,n),o.on=r}}var Fe=n(233),Be=n(252),He=jt.b.prototype.constructor,$e=n(253);function qe(t){return function(){this.style.removeProperty(t)}}function Ue(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function We(t,e,n){var i,r;function a(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&Ue(t,a,n)),i}return a._value=e,a}function ze(t){return function(e){this.textContent=t.call(this,e)}}function Ge(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&ze(i)),e}return i._value=t,i}var Ve=0;function Ze(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Ye(){return++Ve}var Xe=jt.b.prototype;Ze.prototype=function(t){return Object(jt.b)().transition(t)}.prototype={constructor:Ze,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Object(Fe.a)(t));for(var i=this._groups,r=i.length,a=new Array(r),o=0;o<r;++o)for(var s,l,c=i[o],u=c.length,h=a[o]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,ee(h[d],e,n,d,h,re(s,n)));return new Ze(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Object(Be.a)(t));for(var i=this._groups,r=i.length,a=[],o=[],s=0;s<r;++s)for(var l,c=i[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,p=t.call(l,l.__data__,h,c),f=re(l,n),g=0,m=p.length;g<m;++g)(d=p[g])&&ee(d,e,n,g,p,f);a.push(p),o.push(l)}return new Ze(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=Object(je.a)(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new Ze(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var l,c=e[s],u=n[s],h=c.length,d=o[s]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<i;++s)o[s]=e[s];return new Ze(o,this._parents,this._name,this._id)},selection:function(){return new He(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ye(),i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,c=0;c<l;++c)if(o=s[c]){var u=re(o,e);ee(o,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ze(i,this._parents,t,n)},call:Xe.call,nodes:Xe.nodes,node:Xe.node,size:Xe.size,empty:Xe.empty,each:Xe.each,on:function(t,e){var n=this._id;return arguments.length<2?re(this.node(),n).on.on(t):this.each(Re(n,t,e))},attr:function(t,e){var n=Object(me.a)(t),i="transform"===n?ge:_e;return this.attrTween(t,"function"==typeof e?(n.local?Me:Se)(n,i,ye(this,"attr."+t,e)):null==e?(n.local?xe:we)(n):(n.local?Ee:Ce)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Object(me.a)(t);return this.tween(n,(i.local?ke:Te)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?fe:_e;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var a=Object($e.b)(this,t),o=(this.style.removeProperty(t),Object($e.b)(this,t));return a===o?null:a===n&&o===i?r:r=e(n=a,i=o)}}(t,i)).on("end.style."+t,qe(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,a;return function(){var o=Object($e.b)(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=Object($e.b)(this,t)),o===l?null:o===i&&l===r?a:(r=l,a=e(i=o,s))}}(t,i,ye(this,"style."+t,e))).each(function(t,e){var n,i,r,a,o="style."+e,s="end."+o;return function(){var l=ie(this,t),c=l.on,u=null==l.value[o]?a||(a=qe(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(s,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,a=n+"";return function(){var o=Object($e.b)(this,t);return o===a?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,We(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ye(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Ge(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=re(this.node(),n).tween,a=0,o=r.length;a<o;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((null==e?be:ve)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ne:Le)(e,t)):re(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?De:Ie)(e,t)):re(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Pe(e,t)):re(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--r&&a()}};n.each((function(){var n=ie(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))}};var Ke={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Je(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Ke.time=zt(),Ke;return n}jt.b.prototype.interrupt=function(t){return this.each((function(){ce(this,t)}))},jt.b.prototype.transition=function(t){var e,n;t instanceof Ze?(e=t._id,t=t._name):(e=Ye(),(n=Ke).time=zt(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,c=0;c<l;++c)(o=s[c])&&ee(o,t,e,c,s,n||Je(o,e));return new Ze(i,this._parents,t,e)};var Qe=function(t){return function(){return t}},tn=function(t,e,n){this.target=t,this.type=e,this.selection=n};function en(){j.c.stopImmediatePropagation()}var nn=function(){j.c.preventDefault(),j.c.stopImmediatePropagation()},rn={name:"drag"},an={name:"space"},on={name:"handle"},sn={name:"center"};function ln(t){return[+t[0],+t[1]]}function cn(t){return[ln(t[0]),ln(t[1])]}function un(t){return function(e){return Object(It.a)(e,j.c.touches,t)}}var hn={name:"x",handles:["w","e"].map(vn),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},dn={name:"y",handles:["n","s"].map(vn),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},pn=(["n","w","e","s","nw","ne","sw","se"].map(vn),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),fn={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},gn={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},mn={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},bn={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vn(t){return{type:t}}function yn(){return!j.c.ctrlKey&&!j.c.button}function _n(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function wn(){return navigator.maxTouchPoints||"ontouchstart"in this}function xn(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Cn(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function En(){return Sn(hn)}function Sn(t){var e,n=_n,i=yn,r=wn,a=!0,o=I("start","brush","end"),s=6;function l(e){var n=e.property("__brush",g).selectAll(".overlay").data([vn("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",pn.overlay).merge(n).each((function(){var t=xn(this).extent;Object(P.a)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([vn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",pn.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return pn[t.type]})),e.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(r).on("touchstart.brush",d).on("touchmove.brush",p).on("touchend.brush touchcancel.brush",f).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=Object(P.a)(this),e=xn(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){var i=t.__brush.emitter;return!i||n&&i.clean?new h(t,e,n):i}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(){if((!e||j.c.touches)&&i.apply(this,arguments)){var n,r,o,s,l,h,d,p,f,g,m,b=this,v=j.c.target.__data__.type,y="selection"===(a&&j.c.metaKey?v="overlay":v)?rn:a&&j.c.altKey?sn:on,_=t===dn?null:mn[v],w=t===hn?null:bn[v],x=xn(b),C=x.extent,E=x.selection,S=C[0][0],M=C[0][1],A=C[1][0],O=C[1][1],k=0,T=0,N=_&&w&&a&&j.c.shiftKey,L=j.c.touches?un(j.c.changedTouches[0].identifier):Pt.a,D=L(b),I=D,R=u(b,arguments,!0).beforestart();"overlay"===v?(E&&(f=!0),x.selection=E=[[n=t===dn?S:D[0],o=t===hn?M:D[1]],[l=t===dn?A:n,d=t===hn?O:o]]):(n=E[0][0],o=E[0][1],l=E[1][0],d=E[1][1]),r=n,s=o,h=l,p=d;var H=Object(P.a)(b).attr("pointer-events","none"),$=H.selectAll(".overlay").attr("cursor",pn[v]);if(j.c.touches)R.moved=U,R.ended=z;else{var q=Object(P.a)(j.c.view).on("mousemove.brush",U,!0).on("mouseup.brush",z,!0);a&&q.on("keydown.brush",G,!0).on("keyup.brush",V,!0),F(j.c.view)}en(),ce(b),c.call(b),R.start()}function U(){var t=L(b);!N||g||m||(Math.abs(t[0]-I[0])>Math.abs(t[1]-I[1])?m=!0:g=!0),I=t,f=!0,nn(),W()}function W(){var t;switch(k=I[0]-D[0],T=I[1]-D[1],y){case an:case rn:_&&(k=Math.max(S-n,Math.min(A-l,k)),r=n+k,h=l+k),w&&(T=Math.max(M-o,Math.min(O-d,T)),s=o+T,p=d+T);break;case on:_<0?(k=Math.max(S-n,Math.min(A-n,k)),r=n+k,h=l):_>0&&(k=Math.max(S-l,Math.min(A-l,k)),r=n,h=l+k),w<0?(T=Math.max(M-o,Math.min(O-o,T)),s=o+T,p=d):w>0&&(T=Math.max(M-d,Math.min(O-d,T)),s=o,p=d+T);break;case sn:_&&(r=Math.max(S,Math.min(A,n-k*_)),h=Math.max(S,Math.min(A,l+k*_))),w&&(s=Math.max(M,Math.min(O,o-T*w)),p=Math.max(M,Math.min(O,d+T*w)))}h<r&&(_*=-1,t=n,n=l,l=t,t=r,r=h,h=t,v in fn&&$.attr("cursor",pn[v=fn[v]])),p<s&&(w*=-1,t=o,o=d,d=t,t=s,s=p,p=t,v in gn&&$.attr("cursor",pn[v=gn[v]])),x.selection&&(E=x.selection),g&&(r=E[0][0],h=E[1][0]),m&&(s=E[0][1],p=E[1][1]),E[0][0]===r&&E[0][1]===s&&E[1][0]===h&&E[1][1]===p||(x.selection=[[r,s],[h,p]],c.call(b),R.brush())}function z(){if(en(),j.c.touches){if(j.c.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else B(j.c.view,f),q.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);H.attr("pointer-events","all"),$.attr("cursor",pn.overlay),x.selection&&(E=x.selection),Cn(E)&&(x.selection=null,c.call(b)),R.end()}function G(){switch(j.c.keyCode){case 16:N=_&&w;break;case 18:y===on&&(_&&(l=h-k*_,n=r+k*_),w&&(d=p-T*w,o=s+T*w),y=sn,W());break;case 32:y!==on&&y!==sn||(_<0?l=h-k:_>0&&(n=r-k),w<0?d=p-T:w>0&&(o=s-T),y=an,$.attr("cursor",pn.selection),W());break;default:return}nn()}function V(){switch(j.c.keyCode){case 16:N&&(g=m=N=!1,W());break;case 18:y===sn&&(_<0?l=h:_>0&&(n=r),w<0?d=p:w>0&&(o=s),y=on,W());break;case 32:y===an&&(j.c.altKey?(_&&(l=h-k*_,n=r+k*_),w&&(d=p-T*w,o=s+T*w),y=sn):(_<0?l=h:_>0&&(n=r),w<0?d=p:w>0&&(o=s),y=on),$.attr("cursor",pn[v]),W());break;default:return}nn()}}function p(){u(this,arguments).moved()}function f(){u(this,arguments).ended()}function g(){var e=this.__brush||{selection:null};return e.extent=cn(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){u(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){u(this,arguments).end()})).tween("brush",(function(){var e=this,i=e.__brush,r=u(e,arguments),a=i.selection,o=t.input("function"==typeof n?n.apply(this,arguments):n,i.extent),s=Dt(a,o);function l(t){i.selection=1===t&&null===o?null:s(t),c.call(e),r.brush()}return null!==a&&null!==o?l:l(1)})):e.each((function(){var e=this,i=arguments,r=e.__brush,a=t.input("function"==typeof n?n.apply(e,i):n,r.extent),o=u(e,i).beforestart();ce(e),r.selection=null===a?null:a,c.call(e),o.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Object(j.a)(new tn(l,e,t.output(this.state.selection)),o.apply,o,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:Qe(cn(t)),l):n},l.filter=function(t){return arguments.length?(i="function"==typeof t?t:Qe(!!t),l):i},l.touchable=function(t){return arguments.length?(r="function"==typeof t?t:Qe(!!t),l):r},l.handleSize=function(t){return arguments.length?(s=+t,l):s},l.keyModifiers=function(t){return arguments.length?(a=!!t,l):a},l.on=function(){var t=o.on.apply(o,arguments);return t===o?l:t},l}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Mn=Math.PI,An=2*Mn,On=An-1e-6;function kn(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Tn(){return new kn}kn.prototype=Tn.prototype={constructor:kn,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,o=this._y1,s=n-t,l=i-e,c=a-t,u=o-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(u*s-l*c)>1e-6&&r){var d=n-a,p=i-o,f=s*s+l*l,g=d*d+p*p,m=Math.sqrt(f),b=Math.sqrt(h),v=r*Math.tan((Mn-Math.acos((f+h-g)/(2*m*b)))/2),y=v/b,_=v/m;Math.abs(y-1)>1e-6&&(this._+="L"+(t+y*c)+","+(e+y*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*p)+","+(this._x1=t+_*s)+","+(this._y1=e+_*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=t+o,c=e+s,u=1^a,h=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%An+An),h>On?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Mn)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var Nn=Tn;function Ln(){}function Dn(t,e){var n=new Ln;if(t instanceof Ln)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var i,r=-1,a=t.length;if(null==e)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e(i=t[r],r,t),i)}else if(t)for(var o in t)n.set(o,t[o]);return n}Ln.prototype=Dn.prototype={constructor:Ln,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var In=Dn;function Pn(){}var jn=In.prototype;function Rn(t,e){var n=new Pn;if(t instanceof Pn)t.each((function(t){n.add(t)}));else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}Pn.prototype=Rn.prototype={constructor:Pn,has:jn.has,add:function(t){return this["$"+(t+="")]=t,this},remove:jn.remove,clear:jn.clear,values:jn.keys,size:jn.size,empty:jn.empty,each:jn.each};Array.prototype.slice;function Fn(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a,o,s,l,c,u,h,d,p=t._root,f={data:i},g=t._x0,m=t._y0,b=t._x1,v=t._y1;if(!p)return t._root=f,t;for(;p.length;)if((c=e>=(a=(g+b)/2))?g=a:b=a,(u=n>=(o=(m+v)/2))?m=o:v=o,r=p,!(p=p[h=u<<1|c]))return r[h]=f,t;if(s=+t._x.call(null,p.data),l=+t._y.call(null,p.data),e===s&&n===l)return f.next=p,r?r[h]=f:t._root=f,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(a=(g+b)/2))?g=a:b=a,(u=n>=(o=(m+v)/2))?m=o:v=o}while((h=u<<1|c)==(d=(l>=o)<<1|s>=a));return r[d]=p,r[h]=f,t}var Bn=function(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r};function Hn(t){return t[0]}function $n(t){return t[1]}function qn(t,e,n){var i=new Un(null==e?Hn:e,null==n?$n:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Un(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function Wn(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var zn=qn.prototype=Un.prototype;zn.copy=function(){var t,e,n=new Un(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Wn(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Wn(e));return n},zn.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Fn(this.cover(e,n),e,n,t)},zn.addAll=function(t){var e,n,i,r,a=t.length,o=new Array(a),s=new Array(a),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(o[n]=i,s[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<a;++n)Fn(this,o[n],s[n],t[n]);return this},zn.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o,s,l=r-n,c=this._root;n>t||t>=r||i>e||e>=a;)switch(s=(e<i)<<1|t<n,(o=new Array(4))[s]=c,c=o,l*=2,s){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this},zn.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},zn.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},zn.find=function(t,e,n){var i,r,a,o,s,l,c,u=this._x0,h=this._y0,d=this._x1,p=this._y1,f=[],g=this._root;for(g&&f.push(new Bn(g,u,h,d,p)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,p=e+n,n*=n);l=f.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(a=l.y0)>p||(o=l.x1)<u||(s=l.y1)<h))if(g.length){var m=(r+o)/2,b=(a+s)/2;f.push(new Bn(g[3],m,b,o,s),new Bn(g[2],r,b,m,s),new Bn(g[1],m,a,o,b),new Bn(g[0],r,a,m,b)),(c=(e>=b)<<1|t>=m)&&(l=f[f.length-1],f[f.length-1]=f[f.length-1-c],f[f.length-1-c]=l)}else{var v=t-+this._x.call(null,g.data),y=e-+this._y.call(null,g.data),_=v*v+y*y;if(_<n){var w=Math.sqrt(n=_);u=t-w,h=e-w,d=t+w,p=e+w,i=g.data}}return i},zn.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,a,o,s,l,c,u,h,d,p=this._root,f=this._x0,g=this._y0,m=this._x1,b=this._y1;if(!p)return this;if(p.length)for(;;){if((c=a>=(s=(f+m)/2))?f=s:m=s,(u=o>=(l=(g+b)/2))?g=l:b=l,e=p,!(p=p[h=u<<1|c]))return this;if(!p.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;p.data!==t;)if(i=p,!(p=p.next))return this;return(r=p.next)&&delete p.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[d]=p:this._root=p),this):(this._root=r,this)},zn.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},zn.root=function(){return this._root},zn.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},zn.visit=function(t){var e,n,i,r,a,o,s=[],l=this._root;for(l&&s.push(new Bn(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,a=e.x1,o=e.y1)&&l.length){var c=(i+a)/2,u=(r+o)/2;(n=l[3])&&s.push(new Bn(n,c,u,a,o)),(n=l[2])&&s.push(new Bn(n,i,u,c,o)),(n=l[1])&&s.push(new Bn(n,c,r,a,u)),(n=l[0])&&s.push(new Bn(n,i,r,c,u))}return this},zn.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Bn(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var a,o=e.x0,s=e.y0,l=e.x1,c=e.y1,u=(o+l)/2,h=(s+c)/2;(a=r[0])&&n.push(new Bn(a,o,s,u,h)),(a=r[1])&&n.push(new Bn(a,u,s,l,h)),(a=r[2])&&n.push(new Bn(a,o,h,u,c)),(a=r[3])&&n.push(new Bn(a,u,h,l,c))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},zn.x=function(t){return arguments.length?(this._x=t,this):this._x},zn.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);function Gn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}var Vn=function(t){return(t=Gn(Math.abs(t)))?t[1]:NaN},Zn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yn(t){if(!(e=Zn.exec(t)))throw new Error("invalid format: "+t);var e;return new Xn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Xn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Yn.prototype=Xn.prototype,Xn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Kn,Jn,Qn,ti,ei=function(t,e){var n=Gn(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},ni={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return ei(100*t,e)},r:ei,s:function(t,e){var n=Gn(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Kn=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Gn(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},ii=function(t){return t},ri=Array.prototype.map,ai=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];Jn=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?ii:(e=ri.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?ii:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ri.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Yn(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,g=t.comma,m=t.precision,b=t.trim,v=t.type;"n"===v?(g=!0,v="g"):ni[v]||(void 0===m&&(m=12),b=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_="$"===d?a:/[%p]/.test(v)?l:"",w=ni[v],x=/[defgprs%]/.test(v);function C(t){var r,a,l,d=y,C=_;if("c"===v)C=w(t)+C,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:w(Math.abs(t),m),b&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==h&&(E=!1),d=(E?"("===h?h:c:"-"===h||"("===h?"":h)+d,C=("s"===v?ai[8+Kn/3]:"")+C+(E&&"("===h?")":""),x)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){C=(46===l?o+t.slice(r+1):t.slice(r))+C,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var S=d.length+t.length+C.length,M=S<f?new Array(f-S+1).join(e):"";switch(g&&p&&(t=i(M+t,M.length?f-C.length:1/0),M=""),n){case"<":t=d+t+C+M;break;case"=":t=d+M+t+C;break;case"^":t=M.slice(0,S=M.length>>1)+d+t+C+M.slice(S);break;default:t=M+d+t+C}return s(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),C.toString=function(){return t+""},C}return{format:h,formatPrefix:function(t,e){var n=h(((t=Yn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Vn(e)/3))),r=Math.pow(10,-i),a=ai[8+i/3];return function(t){return n(r*t)+a}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Qn=Jn.format,ti=Jn.formatPrefix;var oi=function(){return Math.random()},si=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(oi),function t(e){function n(t,n){var i,r;return t=null==t?0:+t,n=null==n?1:+n,function(){var a;if(null!=i)a=i,i=null;else do{i=2*e()-1,a=2*e()-1,r=i*i+a*a}while(!r||r>1);return t+n*a*Math.sqrt(-2*Math.log(r)/r)}}return n.source=t,n}(oi)),li=(function t(e){function n(){var t=si.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(oi),function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(oi));(function t(e){function n(t){var n=li.source(e)(t);return function(){return n()/t}}return n.source=t,n})(oi),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(oi);function ci(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var ui=Array.prototype,hi=ui.map,di=ui.slice,pi={name:"implicit"};function fi(){var t=In(),e=[],n=[],i=pi;function r(r){var a=r+"",o=t.get(a);if(!o){if(i!==pi)return i;t.set(a,o=e.push(r))}return n[(o-1)%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=In();for(var i,a,o=-1,s=n.length;++o<s;)t.has(a=(i=n[o])+"")||t.set(a,e.push(i));return r},r.range=function(t){return arguments.length?(n=di.call(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return fi(e,n).unknown(i)},ci.apply(r,arguments),r}function gi(){var t,e,n=fi().unknown(void 0),i=n.domain,r=n.range,a=[0,1],o=!1,s=0,l=0,u=.5;function h(){var n=i().length,h=a[1]<a[0],d=a[h-0],p=a[1-h];t=(p-d)/Math.max(1,n-s+2*l),o&&(t=Math.floor(t)),d+=(p-d-t*(n-s))*u,e=t*(1-s),o&&(d=Math.round(d),e=Math.round(e));var f=c(n).map((function(e){return d+t*e}));return r(h?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),h()):i()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],h()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,h()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,l=+t),h()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),h()):s},n.paddingOuter=function(t){return arguments.length?(l=+t,h()):l},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},n.copy=function(){return gi(i(),a).round(o).paddingInner(s).paddingOuter(l).align(u)},ci.apply(h(),arguments)}function mi(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return mi(e())},t}function bi(){return mi(gi.apply(null,arguments).paddingInner(1))}var vi=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},yi=function(t){return+t},_i=[0,1];function wi(t){return t}function xi(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ci(t){var e,n=t[0],i=t[t.length-1];return n>i&&(e=n,n=i,i=e),function(t){return Math.max(n,Math.min(i,t))}}function Ei(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=xi(r,i),a=n(o,a)):(i=xi(i,r),a=n(a,o)),function(t){return a(i(t))}}function Si(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=xi(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=s(t,e,1,i)-1;return a[n](r[n](e))}}function Mi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ai(){var t,e,n,i,r,a,o=_i,s=_i,l=Dt,c=wi;function u(){return i=Math.min(o.length,s.length)>2?Si:Ei,r=a=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(o.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((a||(a=i(s,o.map(t),Mt)))(n)))},h.domain=function(t){return arguments.length?(o=hi.call(t,yi),c===wi||(c=Ci(o)),u()):o.slice()},h.range=function(t){return arguments.length?(s=di.call(t),u()):s.slice()},h.rangeRound=function(t){return s=di.call(t),l=vi,u()},h.clamp=function(t){return arguments.length?(c=t?Ci(o):wi,h):c!==wi},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}function Oi(t,e){return Ai()(t,e)}var ki=function(t,e,n,i){var r,a=g(t,e,n);switch((i=Yn(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Vn(e)/3)))-Vn(Math.abs(t)))}(a,o))||(i.precision=r),ti(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Vn(e)-Vn(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Vn(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return Qn(i)};function Ti(t){var e=t.domain;return t.ticks=function(t){var n=e();return p(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return ki(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(i=s,s=l,l=i,i=a,a=o,o=i),(i=f(s,l,n))>0?i=f(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=f(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,n)),i>0?(r[a]=Math.floor(s/i)*i,r[o]=Math.ceil(l/i)*i,e(r)):i<0&&(r[a]=Math.ceil(s*i)/i,r[o]=Math.floor(l*i)/i,e(r)),t},t}function Ni(){var t=Oi(wi,wi);return t.copy=function(){return Mi(t,Ni())},ci.apply(t,arguments),Ti(t)}function Li(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Di(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Ii(t){return t<0?-t*t:t*t}function Pi(t){var e=t(wi,wi),n=1;function i(){return 1===n?t(wi,wi):.5===n?t(Di,Ii):t(Li(n),Li(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},Ti(e)}function ji(){var t=Pi(Ai());return t.copy=function(){return Mi(t,ji()).exponent(t.exponent())},ci.apply(t,arguments),t}var Ri=new Date,Fi=new Date;function Bi(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,a){var o,s=[];if(n=r.ceil(n),a=null==a?1:Math.floor(a),!(n<i&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<i);return s},r.filter=function(n){return Bi((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return Ri.setTime(+e),Fi.setTime(+i),t(Ri),t(Fi),Math.floor(n(Ri,Fi))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var Hi=Bi((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Hi.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bi((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var $i=Hi,qi=(Hi.range,Bi((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));qi.range;function Ui(t){return Bi((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Wi=Ui(0),zi=Ui(1),Gi=Ui(2),Vi=Ui(3),Zi=Ui(4),Yi=Ui(5),Xi=Ui(6),Ki=(Wi.range,zi.range,Gi.range,Vi.range,Zi.range,Yi.range,Xi.range,Bi((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),Ji=Ki,Qi=(Ki.range,Bi((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),tr=(Qi.range,Bi((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),er=(tr.range,Bi((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),nr=(er.range,Bi((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));nr.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Bi((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):nr:null};nr.range;function ir(t){return Bi((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var rr=ir(0),ar=ir(1),or=ir(2),sr=ir(3),lr=ir(4),cr=ir(5),ur=ir(6),hr=(rr.range,ar.range,or.range,sr.range,lr.range,cr.range,ur.range,Bi((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),dr=hr,pr=(hr.range,Bi((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));pr.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bi((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var fr=pr;pr.range;function gr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function mr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function br(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var vr,yr={"-":"",_:" ",0:"0"},_r=/^\s*\d+/,wr=/^%/,xr=/[\\^$*+?|[\]().{}]/g;function Cr(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function Er(t){return t.replace(xr,"\\$&")}function Sr(t){return new RegExp("^(?:"+t.map(Er).join("|")+")","i")}function Mr(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function Ar(t,e,n){var i=_r.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Or(t,e,n){var i=_r.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function kr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Tr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Nr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Lr(t,e,n){var i=_r.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Dr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Ir(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Pr(t,e,n){var i=_r.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function jr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Rr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Fr(t,e,n){var i=_r.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Br(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Hr(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function $r(t,e,n){var i=_r.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function qr(t,e,n){var i=_r.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Ur(t,e,n){var i=_r.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Wr(t,e,n){var i=wr.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function zr(t,e,n){var i=_r.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Gr(t,e,n){var i=_r.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Vr(t,e){return Cr(t.getDate(),e,2)}function Zr(t,e){return Cr(t.getHours(),e,2)}function Yr(t,e){return Cr(t.getHours()%12||12,e,2)}function Xr(t,e){return Cr(1+Ji.count($i(t),t),e,3)}function Kr(t,e){return Cr(t.getMilliseconds(),e,3)}function Jr(t,e){return Kr(t,e)+"000"}function Qr(t,e){return Cr(t.getMonth()+1,e,2)}function ta(t,e){return Cr(t.getMinutes(),e,2)}function ea(t,e){return Cr(t.getSeconds(),e,2)}function na(t){var e=t.getDay();return 0===e?7:e}function ia(t,e){return Cr(Wi.count($i(t)-1,t),e,2)}function ra(t){var e=t.getDay();return e>=4||0===e?Zi(t):Zi.ceil(t)}function aa(t,e){return t=ra(t),Cr(Zi.count($i(t),t)+(4===$i(t).getDay()),e,2)}function oa(t){return t.getDay()}function sa(t,e){return Cr(zi.count($i(t)-1,t),e,2)}function la(t,e){return Cr(t.getFullYear()%100,e,2)}function ca(t,e){return Cr((t=ra(t)).getFullYear()%100,e,2)}function ua(t,e){return Cr(t.getFullYear()%1e4,e,4)}function ha(t,e){var n=t.getDay();return Cr((t=n>=4||0===n?Zi(t):Zi.ceil(t)).getFullYear()%1e4,e,4)}function da(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Cr(e/60|0,"0",2)+Cr(e%60,"0",2)}function pa(t,e){return Cr(t.getUTCDate(),e,2)}function fa(t,e){return Cr(t.getUTCHours(),e,2)}function ga(t,e){return Cr(t.getUTCHours()%12||12,e,2)}function ma(t,e){return Cr(1+dr.count(fr(t),t),e,3)}function ba(t,e){return Cr(t.getUTCMilliseconds(),e,3)}function va(t,e){return ba(t,e)+"000"}function ya(t,e){return Cr(t.getUTCMonth()+1,e,2)}function _a(t,e){return Cr(t.getUTCMinutes(),e,2)}function wa(t,e){return Cr(t.getUTCSeconds(),e,2)}function xa(t){var e=t.getUTCDay();return 0===e?7:e}function Ca(t,e){return Cr(rr.count(fr(t)-1,t),e,2)}function Ea(t){var e=t.getUTCDay();return e>=4||0===e?lr(t):lr.ceil(t)}function Sa(t,e){return t=Ea(t),Cr(lr.count(fr(t),t)+(4===fr(t).getUTCDay()),e,2)}function Ma(t){return t.getUTCDay()}function Aa(t,e){return Cr(ar.count(fr(t)-1,t),e,2)}function Oa(t,e){return Cr(t.getUTCFullYear()%100,e,2)}function ka(t,e){return Cr((t=Ea(t)).getUTCFullYear()%100,e,2)}function Ta(t,e){return Cr(t.getUTCFullYear()%1e4,e,4)}function Na(t,e){var n=t.getUTCDay();return Cr((t=n>=4||0===n?lr(t):lr.ceil(t)).getUTCFullYear()%1e4,e,4)}function La(){return"+0000"}function Da(){return"%"}function Ia(t){return+t}function Pa(t){return Math.floor(+t/1e3)}!function(t){vr=function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,c=Sr(r),u=Mr(r),h=Sr(a),d=Mr(a),p=Sr(o),f=Mr(o),g=Sr(s),m=Mr(s),b=Sr(l),v=Mr(l),y={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Vr,e:Vr,f:Jr,g:ca,G:ha,H:Zr,I:Yr,j:Xr,L:Kr,m:Qr,M:ta,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ia,s:Pa,S:ea,u:na,U:ia,V:aa,w:oa,W:sa,x:null,X:null,y:la,Y:ua,Z:da,"%":Da},_={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:pa,e:pa,f:va,g:ka,G:Na,H:fa,I:ga,j:ma,L:ba,m:ya,M:_a,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ia,s:Pa,S:wa,u:xa,U:Ca,V:Sa,w:Ma,W:Aa,x:null,X:null,y:Oa,Y:Ta,Z:La,"%":Da},w={a:function(t,e,n){var i=p.exec(e.slice(n));return i?(t.w=f[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=d[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=b.exec(e.slice(n));return i?(t.m=v[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=m[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,n,i){return E(t,e,n,i)},d:Rr,e:Rr,f:Ur,g:Dr,G:Lr,H:Br,I:Br,j:Fr,L:qr,m:jr,M:Hr,p:function(t,e,n){var i=c.exec(e.slice(n));return i?(t.p=u[i[0].toLowerCase()],n+i[0].length):-1},q:Pr,Q:zr,s:Gr,S:$r,u:Or,U:kr,V:Tr,w:Ar,W:Nr,x:function(t,e,i){return E(t,n,e,i)},X:function(t,e,n){return E(t,i,e,n)},y:Dr,Y:Lr,Z:Ir,"%":Wr};function x(t,e){return function(n){var i,r,a,o=[],s=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),null!=(r=yr[i=t.charAt(++s)])?i=t.charAt(++s):r="e"===i?" ":"0",(a=e[i])&&(i=a(n,r)),o.push(i),l=s+1);return o.push(t.slice(l,s)),o.join("")}}function C(t,e){return function(n){var i,r,a=br(1900,void 0,1);if(E(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(i=mr(br(a.y,0,1))).getUTCDay(),i=r>4||0===r?ar.ceil(i):ar(i),i=dr.offset(i,7*(a.V-1)),a.y=i.getUTCFullYear(),a.m=i.getUTCMonth(),a.d=i.getUTCDate()+(a.w+6)%7):(r=(i=gr(br(a.y,0,1))).getDay(),i=r>4||0===r?zi.ceil(i):zi(i),i=Ji.offset(i,7*(a.V-1)),a.y=i.getFullYear(),a.m=i.getMonth(),a.d=i.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),r="Z"in a?mr(br(a.y,0,1)).getUTCDay():gr(br(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(r+5)%7:a.w+7*a.U-(r+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,mr(a)):gr(a)}}function E(t,e,n,i){for(var r,a,o=0,s=e.length,l=n.length;o<s;){if(i>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=w[r in yr?e.charAt(o++):r])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return y.x=x(n,y),y.X=x(i,y),y.c=x(e,y),_.x=x(n,_),_.X=x(i,_),_.c=x(e,_),{format:function(t){var e=x(t+="",y);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",_);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}(t),vr.format,vr.parse,vr.utcFormat,vr.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ja=Bi((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Ra=(ja.range,Bi((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),Fa=(Ra.range,Bi((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));Fa.range;var Ba=n(190),Ha=function(t){return function(){return t}};function $a(t){this._context=t}$a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var qa=function(t){return new $a(t)};function Ua(t){return t[0]}function Wa(t){return t[1]}var za=function(){var t=Ua,e=Wa,n=Ha(!0),i=null,r=qa,a=null;function o(o){var s,l,c,u=o.length,h=!1;for(null==i&&(a=r(c=Nn())),s=0;s<=u;++s)!(s<u&&n(l=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(l,s,o),+e(l,s,o));if(c)return a=null,c+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ha(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Ha(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ha(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(a=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=a=null:a=r(i=t),o):i},o};function Ga(){this._=null}function Va(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Za(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Ya(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Xa(t){for(;t.L;)t=t.L;return t}Ga.prototype={constructor:Ga,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Xa(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Za(this,n),n=(t=n).U),n.C=!1,i.C=!0,Ya(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Ya(this,n),n=(t=n).U),n.C=!1,i.C=!0,Za(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,a=t.L,o=t.R;if(n=a?o?Xa(o):a:o,r?r.L===t?r.L=n:r.R=n:this._=n,a&&o?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=o,o.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Za(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Ya(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Za(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Ya(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Za(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Ya(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var Ka=Ga;function Ja(t,e,n,i){var r=[null,null],a=Co.push(r)-1;return r.left=t,r.right=e,n&&to(r,t,e,n),i&&to(r,e,t,i),wo[t.index].halfedges.push(a),wo[e.index].halfedges.push(a),r}function Qa(t,e,n){var i=[e,n];return i.left=t,i}function to(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function eo(t,e,n,i,r){var a,o=t[0],s=t[1],l=o[0],c=o[1],u=0,h=1,d=s[0]-l,p=s[1]-c;if(a=e-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<h&&(h=a)}else if(d>0){if(a>h)return;a>u&&(u=a)}if(a=i-l,d||!(a<0)){if(a/=d,d<0){if(a>h)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<h&&(h=a)}if(a=n-c,p||!(a>0)){if(a/=p,p<0){if(a<u)return;a<h&&(h=a)}else if(p>0){if(a>h)return;a>u&&(u=a)}if(a=r-c,p||!(a<0)){if(a/=p,p<0){if(a>h)return;a>u&&(u=a)}else if(p>0){if(a<u)return;a<h&&(h=a)}return!(u>0||h<1)||(u>0&&(t[0]=[l+u*d,c+u*p]),h<1&&(t[1]=[l+h*d,c+h*p]),!0)}}}}}function no(t,e,n,i,r){var a=t[1];if(a)return!0;var o,s,l=t[0],c=t.left,u=t.right,h=c[0],d=c[1],p=u[0],f=u[1],g=(h+p)/2,m=(d+f)/2;if(f===d){if(g<e||g>=i)return;if(h>p){if(l){if(l[1]>=r)return}else l=[g,n];a=[g,r]}else{if(l){if(l[1]<n)return}else l=[g,r];a=[g,n]}}else if(s=m-(o=(h-p)/(f-d))*g,o<-1||o>1)if(h>p){if(l){if(l[1]>=r)return}else l=[(n-s)/o,n];a=[(r-s)/o,r]}else{if(l){if(l[1]<n)return}else l=[(r-s)/o,r];a=[(n-s)/o,n]}else if(d<f){if(l){if(l[0]>=i)return}else l=[e,o*e+s];a=[i,o*i+s]}else{if(l){if(l[0]<e)return}else l=[i,o*i+s];a=[e,o*e+s]}return t[0]=l,t[1]=a,!0}function io(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function ro(t,e){return e[+(e.left!==t.site)]}function ao(t,e){return e[+(e.left===t.site)]}var oo,so=[];function lo(){Va(this),this.x=this.y=this.arc=this.site=this.cy=null}function co(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var o=r[0],s=r[1],l=i[0]-o,c=i[1]-s,u=a[0]-o,h=a[1]-s,d=2*(l*h-c*u);if(!(d>=-So)){var p=l*l+c*c,f=u*u+h*h,g=(h*p-c*f)/d,m=(l*f-u*p)/d,b=so.pop()||new lo;b.arc=t,b.site=r,b.x=g+o,b.y=(b.cy=m+s)+Math.sqrt(g*g+m*m),t.circle=b;for(var v=null,y=xo._;y;)if(b.y<y.y||b.y===y.y&&b.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}xo.insert(v,b),v||(oo=b)}}}}function uo(t){var e=t.circle;e&&(e.P||(oo=e.N),xo.remove(e),so.push(e),Va(e),t.circle=null)}var ho=[];function po(){Va(this),this.edge=this.site=this.circle=null}function fo(t){var e=ho.pop()||new po;return e.site=t,e}function go(t){uo(t),_o.remove(t),ho.push(t),Va(t)}function mo(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],a=t.P,o=t.N,s=[t];go(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<Eo&&Math.abs(i-l.circle.cy)<Eo;)a=l.P,s.unshift(l),go(l),l=a;s.unshift(l),uo(l);for(var c=o;c.circle&&Math.abs(n-c.circle.x)<Eo&&Math.abs(i-c.circle.cy)<Eo;)o=c.N,s.push(c),go(c),c=o;s.push(c),uo(c);var u,h=s.length;for(u=1;u<h;++u)c=s[u],l=s[u-1],to(c.edge,l.site,c.site,r);l=s[0],(c=s[h-1]).edge=Ja(l.site,c.site,null,r),co(l),co(c)}function bo(t){for(var e,n,i,r,a=t[0],o=t[1],s=_o._;s;)if((i=vo(s,o)-a)>Eo)s=s.L;else{if(!((r=a-yo(s,o))>Eo)){i>-Eo?(e=s.P,n=s):r>-Eo?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){wo[t.index]={site:t,halfedges:[]}}(t);var l=fo(t);if(_o.insert(e,l),e||n){if(e===n)return uo(e),n=fo(e.site),_o.insert(l,n),l.edge=n.edge=Ja(e.site,l.site),co(e),void co(n);if(n){uo(e),uo(n);var c=e.site,u=c[0],h=c[1],d=t[0]-u,p=t[1]-h,f=n.site,g=f[0]-u,m=f[1]-h,b=2*(d*m-p*g),v=d*d+p*p,y=g*g+m*m,_=[(m*v-p*y)/b+u,(d*y-g*v)/b+h];to(n.edge,c,f,_),l.edge=Ja(c,t,null,_),n.edge=Ja(t,f,null,_),co(e),co(n)}else l.edge=Ja(e.site,l.site)}}function vo(t,e){var n=t.site,i=n[0],r=n[1],a=r-e;if(!a)return i;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],l=n[1],c=l-e;if(!c)return s;var u=s-i,h=1/a-1/c,d=u/c;return h?(-d+Math.sqrt(d*d-2*h*(u*u/(-2*c)-l+c/2+r-a/2)))/h+i:(i+s)/2}function yo(t,e){var n=t.N;if(n)return vo(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var _o,wo,xo,Co,Eo=1e-6,So=1e-12;function Mo(t,e){return e[1]-t[1]||e[0]-t[0]}function Ao(t,e){var n,i,r,a=t.sort(Mo).pop();for(Co=[],wo=new Array(t.length),_o=new Ka,xo=new Ka;;)if(r=oo,a&&(!r||a[1]<r.y||a[1]===r.y&&a[0]<r.x))a[0]===n&&a[1]===i||(bo(a),n=a[0],i=a[1]),a=t.pop();else{if(!r)break;mo(r.arc)}if(function(){for(var t,e,n,i,r=0,a=wo.length;r<a;++r)if((t=wo[r])&&(i=(e=t.halfedges).length)){var o=new Array(i),s=new Array(i);for(n=0;n<i;++n)o[n]=n,s[n]=io(t,Co[e[n]]);for(o.sort((function(t,e){return s[e]-s[t]})),n=0;n<i;++n)s[n]=e[o[n]];for(n=0;n<i;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],l=+e[1][0],c=+e[1][1];!function(t,e,n,i){for(var r,a=Co.length;a--;)no(r=Co[a],t,e,n,i)&&eo(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>Eo||Math.abs(r[0][1]-r[1][1])>Eo)||delete Co[a]}(o,s,l,c),function(t,e,n,i){var r,a,o,s,l,c,u,h,d,p,f,g,m=wo.length,b=!0;for(r=0;r<m;++r)if(a=wo[r]){for(o=a.site,s=(l=a.halfedges).length;s--;)Co[l[s]]||l.splice(s,1);for(s=0,c=l.length;s<c;)f=(p=ao(a,Co[l[s]]))[0],g=p[1],h=(u=ro(a,Co[l[++s%c]]))[0],d=u[1],(Math.abs(f-h)>Eo||Math.abs(g-d)>Eo)&&(l.splice(s,0,Co.push(Qa(o,p,Math.abs(f-t)<Eo&&i-g>Eo?[t,Math.abs(h-t)<Eo?d:i]:Math.abs(g-i)<Eo&&n-f>Eo?[Math.abs(d-i)<Eo?h:n,i]:Math.abs(f-n)<Eo&&g-e>Eo?[n,Math.abs(h-n)<Eo?d:e]:Math.abs(g-e)<Eo&&f-t>Eo?[Math.abs(d-e)<Eo?h:t,e]:null))-1),++c);c&&(b=!1)}if(b){var v,y,_,w=1/0;for(r=0,b=null;r<m;++r)(a=wo[r])&&(_=(v=(o=a.site)[0]-t)*v+(y=o[1]-e)*y)<w&&(w=_,b=a);if(b){var x=[t,e],C=[t,i],E=[n,i],S=[n,e];b.halfedges.push(Co.push(Qa(o=b.site,x,C))-1,Co.push(Qa(o,C,E))-1,Co.push(Qa(o,E,S))-1,Co.push(Qa(o,S,x))-1)}}for(r=0;r<m;++r)(a=wo[r])&&(a.halfedges.length||delete wo[r])}(o,s,l,c)}this.edges=Co,this.cells=wo,_o=xo=Co=wo=null}Ao.prototype={constructor:Ao,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return ro(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(a=(r=n.halfedges).length)for(var r,a,o,s,l,c,u=n.site,h=-1,d=e[r[a-1]],p=d.left===u?d.right:d.left;++h<a;)o=p,p=(d=e[r[h]]).left===u?d.right:d.left,o&&p&&i<o.index&&i<p.index&&(l=o,c=p,((s=u)[0]-c[0])*(l[1]-s[1])-(s[0]-l[0])*(c[1]-s[1])<0)&&t.push([u.data,o.data,p.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,r,a=this,o=a._found||0,s=a.cells.length;!(r=a.cells[o]);)if(++o>=s)return null;var l=t-r.site[0],c=e-r.site[1],u=l*l+c*c;do{r=a.cells[i=o],o=null,r.halfedges.forEach((function(n){var i=a.edges[n],s=i.left;if(s!==r.site&&s||(s=i.right)){var l=t-s[0],c=e-s[1],h=l*l+c*c;h<u&&(u=h,o=s.index)}}))}while(null!==o);return a._found=i,null==n||u<=n*n?r.site:null}};var Oo=Math.SQRT2;function ko(t){return((t=Math.exp(t))+1/t)/2}var To=function(t,e){var n,i,r=t[0],a=t[1],o=t[2],s=e[0],l=e[1],c=e[2],u=s-r,h=l-a,d=u*u+h*h;if(d<1e-12)i=Math.log(c/o)/Oo,n=function(t){return[r+t*u,a+t*h,o*Math.exp(Oo*t*i)]};else{var p=Math.sqrt(d),f=(c*c-o*o+4*d)/(2*o*2*p),g=(c*c-o*o-4*d)/(2*c*2*p),m=Math.log(Math.sqrt(f*f+1)-f),b=Math.log(Math.sqrt(g*g+1)-g);i=(b-m)/Oo,n=function(t){var e,n=t*i,s=ko(m),l=o/(2*p)*(s*(e=Oo*n+m,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[r+l*u,a+l*h,o*s/ko(Oo*n+m)]}}return n.duration=1e3*i,n},No=function(t){return function(){return t}};function Lo(t,e,n){this.target=t,this.type=e,this.transform=n}function Do(t,e,n){this.k=t,this.x=e,this.y=n}Do.prototype={constructor:Do,scale:function(t){return 1===t?this:new Do(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Do(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Io=new Do(1,0,0);function Po(){j.c.stopImmediatePropagation()}Do.prototype;var jo=function(){j.c.preventDefault(),j.c.stopImmediatePropagation()};function Ro(){return!j.c.ctrlKey&&!j.c.button}function Fo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Bo(){return this.__zoom||Io}function Ho(){return-j.c.deltaY*(1===j.c.deltaMode?.05:j.c.deltaMode?1:.002)}function $o(){return navigator.maxTouchPoints||"ontouchstart"in this}function qo(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var Uo=function(){var t,e,n=Ro,i=Fo,r=qo,a=Ho,o=$o,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,u=To,h=I("start","zoom","end"),d=0;function p(t){t.property("__zoom",Bo).on("wheel.zoom",_).on("mousedown.zoom",w).on("dblclick.zoom",x).filter(o).on("touchstart.zoom",C).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new Do(e,t.x,t.y)}function g(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new Do(t.k,i,r)}function m(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n){t.on("start.zoom",(function(){v(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){v(this,arguments).end()})).tween("zoom",(function(){var t=this,r=arguments,a=v(t,r),o=i.apply(t,r),s=null==n?m(o):"function"==typeof n?n.apply(t,r):n,l=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,r):e,d=u(c.invert(s).concat(l/c.k),h.invert(s).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=l/e[2];t=new Do(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function v(t,e,n){return!n&&t.__zooming||new y(t,e)}function y(t,e){this.that=t,this.args=e,this.active=0,this.extent=i.apply(t,e),this.taps=0}function _(){if(n.apply(this,arguments)){var t=v(this,arguments),e=this.__zoom,i=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,a.apply(this,arguments)))),o=Object(Pt.a)(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=e.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(e.k===i)return;t.mouse=[o,e.invert(o)],ce(this),t.start()}jo(),t.wheel=setTimeout(c,150),t.zoom("mouse",r(g(f(e,i),t.mouse[0],t.mouse[1]),t.extent,l))}function c(){t.wheel=null,t.end()}}function w(){if(!e&&n.apply(this,arguments)){var t=v(this,arguments,!0),i=Object(P.a)(j.c.view).on("mousemove.zoom",c,!0).on("mouseup.zoom",u,!0),a=Object(Pt.a)(this),o=j.c.clientX,s=j.c.clientY;F(j.c.view),Po(),t.mouse=[a,this.__zoom.invert(a)],ce(this),t.start()}function c(){if(jo(),!t.moved){var e=j.c.clientX-o,n=j.c.clientY-s;t.moved=e*e+n*n>d}t.zoom("mouse",r(g(t.that.__zoom,t.mouse[0]=Object(Pt.a)(t.that),t.mouse[1]),t.extent,l))}function u(){i.on("mousemove.zoom mouseup.zoom",null),B(j.c.view,t.moved),jo(),t.end()}}function x(){if(n.apply(this,arguments)){var t=this.__zoom,e=Object(Pt.a)(this),a=t.invert(e),o=t.k*(j.c.shiftKey?.5:2),s=r(g(f(t,o),e,a),i.apply(this,arguments),l);jo(),c>0?Object(P.a)(this).transition().duration(c).call(b,s,e):Object(P.a)(this).call(p.transform,s)}}function C(){if(n.apply(this,arguments)){var e,i,r,a,o=j.c.touches,s=o.length,l=v(this,arguments,j.c.changedTouches.length===s);for(Po(),i=0;i<s;++i)r=o[i],a=[a=Object(It.a)(this,o,r.identifier),this.__zoom.invert(a),r.identifier],l.touch0?l.touch1||l.touch0[2]===a[2]||(l.touch1=a,l.taps=0):(l.touch0=a,e=!0,l.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(l.taps<2&&(t=setTimeout((function(){t=null}),500)),ce(this),l.start())}}function E(){if(this.__zooming){var e,n,i,a,o=v(this,arguments),s=j.c.changedTouches,c=s.length;for(jo(),t&&(t=clearTimeout(t)),o.taps=0,e=0;e<c;++e)n=s[e],i=Object(It.a)(this,s,n.identifier),o.touch0&&o.touch0[2]===n.identifier?o.touch0[0]=i:o.touch1&&o.touch1[2]===n.identifier&&(o.touch1[0]=i);if(n=o.that.__zoom,o.touch1){var u=o.touch0[0],h=o.touch0[1],d=o.touch1[0],p=o.touch1[1],m=(m=d[0]-u[0])*m+(m=d[1]-u[1])*m,b=(b=p[0]-h[0])*b+(b=p[1]-h[1])*b;n=f(n,Math.sqrt(m/b)),i=[(u[0]+d[0])/2,(u[1]+d[1])/2],a=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!o.touch0)return;i=o.touch0[0],a=o.touch0[1]}o.zoom("touch",r(g(n,i,a),o.extent,l))}}function S(){if(this.__zooming){var t,n,i=v(this,arguments),r=j.c.changedTouches,a=r.length;for(Po(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<a;++t)n=r[t],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;if(i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0)i.touch0[1]=this.__zoom.invert(i.touch0[0]);else if(i.end(),2===i.taps){var o=Object(P.a)(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return p.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",Bo),t!==i?b(t,e,n):i.interrupt().each((function(){v(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},p.scaleBy=function(t,e,n){p.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},p.scaleTo=function(t,e,n){p.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,o=null==n?m(t):"function"==typeof n?n.apply(this,arguments):n,s=a.invert(o),c="function"==typeof e?e.apply(this,arguments):e;return r(g(f(a,c),o,s),t,l)}),n)},p.translateBy=function(t,e,n){p.transform(t,(function(){return r(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),l)}))},p.translateTo=function(t,e,n,a){p.transform(t,(function(){var t=i.apply(this,arguments),o=this.__zoom,s=null==a?m(t):"function"==typeof a?a.apply(this,arguments):a;return r(Io.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),a)},y.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Object(j.a)(new Lo(p,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},p.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:No(+t),p):a},p.filter=function(t){return arguments.length?(n="function"==typeof t?t:No(!!t),p):n},p.touchable=function(t){return arguments.length?(o="function"==typeof t?t:No(!!t),p):o},p.extent=function(t){return arguments.length?(i="function"==typeof t?t:No([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),p):i},p.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],p):[s[0],s[1]]},p.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],p):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},p.constrain=function(t){return arguments.length?(r=t,p):r},p.duration=function(t){return arguments.length?(c=+t,p):c},p.interpolate=function(t){return arguments.length?(u=t,p):u},p.on=function(){var t=h.on.apply(h,arguments);return t===h?p:t},p.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,p):Math.sqrt(d)},p}},192:function(t,e,n){"use strict";n.d(e,"b",(function(){return o.a})),n.d(e,"a",(function(){return i.d})),n.d(e,"c",(function(){return s}));var i=n(194);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const r=new class{handleAttributeExpressions(t,e,n,r){const a=e[0];if("."===a){return new i.e(t,e.slice(1),n).parts}if("@"===a)return[new i.c(t,e.slice(1),r.eventContext)];if("?"===a)return[new i.b(t,e.slice(1),n)];return new i.a(t,e,n).parts}handleTextExpression(t){return new i.d(t)}};var a=n(218),o=n(227);n(204),n(228),n(230),n(219),n(229),n(197);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const s=(t,...e)=>new a.b(t,e,"html",r)},194:function(t,e,n){"use strict";n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"b",(function(){return f})),n.d(e,"e",(function(){return g})),n.d(e,"c",(function(){return v}));var i=n(227),r=n(204),a=n(228),o=n(229),s=n(218),l=n(197);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const c=t=>null===t||!("object"==typeof t||"function"==typeof t),u=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class h{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let t=0;t<n.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new d(this)}_getValue(){const t=this.strings,e=t.length-1,n=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=n[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!u(t))return t}let i="";for(let r=0;r<e;r++){i+=t[r];const e=n[r];if(void 0!==e){const t=e.value;if(c(t)||!u(t))i+="string"==typeof t?t:String(t);else for(const e of t)i+="string"==typeof e?e:String(e)}}return i+=t[e],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class d{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===a.a||c(t)&&t===this.value||(this.value=t,Object(i.b)(t)||(this.committer.dirty=!0))}commit(){for(;Object(i.b)(this.value);){const t=this.value;this.value=a.a,t(this)}this.value!==a.a&&this.committer.commit()}}class p{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(Object(l.c)()),this.endNode=t.appendChild(Object(l.c)())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=Object(l.c)()),t.__insert(this.endNode=Object(l.c)())}insertAfterPart(t){t.__insert(this.startNode=Object(l.c)()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a.a,t(this)}const t=this.__pendingValue;t!==a.a&&(c(t)?t!==this.value&&this.__commitText(t):t instanceof s.b?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):u(t)?this.__commitIterable(t):t===a.b?(this.value=a.b,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof o.a&&this.value.template===e)this.value.update(t.values);else{const n=new o.a(e,t.processor,this.options),i=n._clone();n.update(t.values),this.__commitNode(i),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,i=0;for(const r of t)n=e[i],void 0===n&&(n=new p(this.options),e.push(n),0===i?n.appendIntoPart(this):n.insertAfterPart(e[i-1])),n.setValue(r),n.commit(),i++;i<e.length&&(e.length=i,this.clear(n&&n.endNode))}clear(t=this.startNode){Object(r.b)(this.startNode.parentNode,t.nextSibling,this.endNode)}}class f{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a.a,t(this)}if(this.__pendingValue===a.a)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=a.a}}class g extends h{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new m(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class m extends d{}let b=!1;(()=>{try{const t={get capture(){return b=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class v{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a.a,t(this)}if(this.__pendingValue===a.a)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),r=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=y(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=a.a}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const y=t=>t&&(b?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)},197:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return h}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i=`{{lit-${String(Math.random()).slice(2)}}}`,r=`\x3c!--${i}--\x3e`,a=new RegExp(`${i}|${r}`),o="$lit$";class s{constructor(t,e){this.parts=[],this.element=e;const n=[],r=[],s=document.createTreeWalker(e.content,133,null,!1);let c=0,d=-1,p=0;const{strings:f,values:{length:g}}=t;for(;p<g;){const t=s.nextNode();if(null!==t){if(d++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let i=0;for(let t=0;t<n;t++)l(e[t].name,o)&&i++;for(;i-- >0;){const e=f[p],n=h.exec(e)[2],i=n.toLowerCase()+o,r=t.getAttribute(i);t.removeAttribute(i);const s=r.split(a);this.parts.push({type:"attribute",index:d,name:n,strings:s}),p+=s.length-1}}"TEMPLATE"===t.tagName&&(r.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(i)>=0){const i=t.parentNode,r=e.split(a),s=r.length-1;for(let e=0;e<s;e++){let n,a=r[e];if(""===a)n=u();else{const t=h.exec(a);null!==t&&l(t[2],o)&&(a=a.slice(0,t.index)+t[1]+t[2].slice(0,-o.length)+t[3]),n=document.createTextNode(a)}i.insertBefore(n,t),this.parts.push({type:"node",index:++d})}""===r[s]?(i.insertBefore(u(),t),n.push(t)):t.data=r[s],p+=s}}else if(8===t.nodeType)if(t.data===i){const e=t.parentNode;null!==t.previousSibling&&d!==c||(d++,e.insertBefore(u(),t)),c=d,this.parts.push({type:"node",index:d}),null===t.nextSibling?t.data="":(n.push(t),d--),p++}else{let e=-1;for(;-1!==(e=t.data.indexOf(i,e+1));)this.parts.push({type:"node",index:-1}),p++}}else s.currentNode=r.pop()}for(const t of n)t.parentNode.removeChild(t)}}const l=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},c=t=>-1!==t.index,u=()=>document.createComment(""),h=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},198:function(t,e,n){"use strict";function i(t,e){try{return e(t)}catch(t){if(t instanceof TypeError){if(r.test(t))return null;if(a.test(t))return}throw t}}var r=/^null | null$|^[^(]* null /i,a=/^undefined | undefined$|^[^(]* undefined /i;i.default=i,t.exports=i},203:function(t,e,n){"use strict";n.d(e,"c",(function(){return h.c})),n.d(e,"b",(function(){return M})),n.d(e,"a",(function(){return O}));var i=n(204),r=n(197);function a(t,e){const{element:{content:n},parts:i}=t,r=document.createTreeWalker(n,133,null,!1);let a=s(i),o=i[a],l=-1,c=0;const u=[];let h=null;for(;r.nextNode();){l++;const t=r.currentNode;for(t.previousSibling===h&&(h=null),e.has(t)&&(u.push(t),null===h&&(h=t)),null!==h&&c++;void 0!==o&&o.index===l;)o.index=null!==h?-1:o.index-c,a=s(i,a),o=i[a]}u.forEach(t=>t.parentNode.removeChild(t))}const o=t=>{let e=11===t.nodeType?0:1;const n=document.createTreeWalker(t,133,null,!1);for(;n.nextNode();)e++;return e},s=(t,e=-1)=>{for(let n=e+1;n<t.length;n++){const e=t[n];if(Object(r.d)(e))return n}return-1};var l=n(230),c=n(219),u=n(229),h=n(192);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const d=(t,e)=>`${t}--${e}`;let p=!0;void 0===window.ShadyCSS?p=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),p=!1);const f=t=>e=>{const n=d(e.type,t);let i=c.a.get(n);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},c.a.set(n,i));let a=i.stringsArray.get(e.strings);if(void 0!==a)return a;const o=e.strings.join(r.f);if(a=i.keyString.get(o),void 0===a){const n=e.getTemplateElement();p&&window.ShadyCSS.prepareTemplateDom(n,t),a=new r.a(e,n),i.keyString.set(o,a)}return i.stringsArray.set(e.strings,a),a},g=["html","svg"],m=new Set,b=(t,e,n)=>{m.add(t);const i=n?n.element:document.createElement("template"),r=e.querySelectorAll("style"),{length:l}=r;if(0===l)return void window.ShadyCSS.prepareTemplateStyles(i,t);const u=document.createElement("style");for(let t=0;t<l;t++){const e=r[t];e.parentNode.removeChild(e),u.textContent+=e.textContent}(t=>{g.forEach(e=>{const n=c.a.get(d(e,t));void 0!==n&&n.keyString.forEach(t=>{const{element:{content:e}}=t,n=new Set;Array.from(e.querySelectorAll("style")).forEach(t=>{n.add(t)}),a(t,n)})})})(t);const h=i.content;n?function(t,e,n=null){const{element:{content:i},parts:r}=t;if(null==n)return void i.appendChild(e);const a=document.createTreeWalker(i,133,null,!1);let l=s(r),c=0,u=-1;for(;a.nextNode();){u++;for(a.currentNode===n&&(c=o(e),n.parentNode.insertBefore(e,n));-1!==l&&r[l].index===u;){if(c>0){for(;-1!==l;)r[l].index+=c,l=s(r,l);return}l=s(r,l)}}}(n,u,h.firstChild):h.insertBefore(u,h.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);const p=h.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==p)e.insertBefore(p.cloneNode(!0),e.firstChild);else if(n){h.insertBefore(u,h.firstChild);const t=new Set;t.add(u),a(n,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const v={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},y=(t,e)=>e!==t&&(e==e||t==t),_={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:y};class w extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,n)=>{const i=this._attributeNameForProperty(n,e);void 0!==i&&(this._attributeToPropertyMap.set(i,n),t.push(i))}),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e=_){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const n="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdateInternal(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||_}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const n of e)this.createProperty(n,t[n])}}static _attributeNameForProperty(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,n=y){return n(t,e)}static _propertyValueFromAttribute(t,e){const n=e.type,i=e.converter||v,r="function"==typeof i?i:i.fromAttribute;return r?r(t,n):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const n=e.type,i=e.converter;return(i&&i.toAttribute||v.toAttribute)(t,n)}initialize(){this._updateState=0,this._updatePromise=new Promise(t=>this._enableUpdatingResolver=t),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>this[e]=t),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,n){e!==n&&this._attributeToProperty(t,n)}_propertyToAttribute(t,e,n=_){const i=this.constructor,r=i._attributeNameForProperty(t,n);if(void 0!==r){const t=i._propertyValueToAttribute(e,n);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(r):this.setAttribute(r,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const n=this.constructor,i=n._attributeToPropertyMap.get(t);if(void 0!==i){const t=n.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=n._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,n){let i=!0;if(void 0!==t){const r=this.constructor;n=n||r.getPropertyOptions(t),r._valueHasChanged(this[t],e,n.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==n.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,n))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}w.finalized=!0;const x=Element.prototype;x.msMatchesSelector||x.webkitMatchesSelector;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const C=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,E=Symbol();class S{constructor(t,e){if(e!==E)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(C?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const M=(t,...e)=>{const n=e.reduce((e,n,i)=>e+(t=>{if(t instanceof S)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(n)+t[i+1],t[0]);return new S(n,E)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const A={};class O extends w{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,n)=>t.reduceRight((t,n)=>Array.isArray(n)?e(n,t):(t.add(n),t),n),n=e(t,new Set),i=[];n.forEach(t=>i.unshift(t)),this._styles=i}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map(t=>{if(t instanceof CSSStyleSheet&&!C){const e=Array.prototype.slice.call(t.cssRules).reduce((t,e)=>t+e.cssText,"");return new S(String(e),E)}return t})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?C?this.renderRoot.adoptedStyleSheets=t.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(t=>t.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==A&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)}))}render(){return A}}O.finalized=!0,O.render=(t,e,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const r=n.scopeName,a=l.a.has(e),o=p&&11===e.nodeType&&!!e.host,s=o&&!m.has(r),c=s?document.createDocumentFragment():e;if(Object(l.b)(t,c,Object.assign({templateFactory:f(r)},n)),s){const t=l.a.get(c);l.a.delete(c);const n=t.value instanceof u.a?t.value.template:void 0;b(r,c,n),Object(i.b)(e,e.firstChild),e.appendChild(c),l.a.set(e,t)}!a&&o&&window.ShadyCSS.styleElement(e.host)}},204:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,r=(t,e,n=null,i=null)=>{for(;e!==n;){const n=e.nextSibling;t.insertBefore(e,i),e=n}},a=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}}},210:function(t,e){t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}},212:function(t,e,n){"use strict";var i=n(267),r=n(265),a=n(310),o=n(283),s=Object(r.a)((function(t){return Object(a.a)(Object(i.a)(t,1,o.a,!0))}));e.a=s},214:function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},n.apply(this,arguments)}t.exports=n},215:function(t,e,n){"use strict";var i=n(92),r=n(99),a=n(281),o=n(282),s=n(91),l=n(95),c=Math.min;var u=function(t,e,n){for(var u=n?o.a:a.a,h=t[0].length,d=t.length,p=d,f=Array(d),g=1/0,m=[];p--;){var b=t[p];p&&e&&(b=Object(i.a)(b,Object(s.a)(e))),g=c(b.length,g),f[p]=!n&&(e||h>=120&&b.length>=120)?new r.a(p&&b):void 0}b=t[0];var v=-1,y=f[0];t:for(;++v<h&&m.length<g;){var _=b[v],w=e?e(_):_;if(_=n||0!==_?_:0,!(y?Object(l.a)(y,w):u(m,w,n))){for(p=d;--p;){var x=f[p];if(!(x?Object(l.a)(x,w):u(t[p],w,n)))continue t}y&&y.push(w),m.push(_)}}return m},h=n(265),d=n(283);var p=function(t){return Object(d.a)(t)?t:[]},f=Object(h.a)((function(t){var e=Object(i.a)(t,p);return e.length&&e[0]===t[0]?u(e):[]}));e.a=f},218:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return l}));var i=n(204),r=n(197);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const a=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),o=` ${r.f} `;class s{constructor(t,e,n,i){this.strings=t,this.values=e,this.type=n,this.processor=i}getHTML(){const t=this.strings.length-1;let e="",n=!1;for(let i=0;i<t;i++){const t=this.strings[i],a=t.lastIndexOf("\x3c!--");n=(a>-1||n)&&-1===t.indexOf("--\x3e",a+1);const s=r.e.exec(t);e+=null===s?t+(n?o:r.g):t.substr(0,s.index)+s[1]+s[2]+r.b+s[3]+r.f}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==a&&(e=a.createHTML(e)),t.innerHTML=e,t}}class l extends s{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),e=t.content,n=e.firstChild;return e.removeChild(n),Object(i.c)(e,n.firstChild),t}}},219:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var i=n(197);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */function r(t){let e=a.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},a.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const r=t.strings.join(i.f);return n=e.keyString.get(r),void 0===n&&(n=new i.a(t,t.getTemplateElement()),e.keyString.set(r,n)),e.stringsArray.set(t.strings,n),n}const a=new Map},221:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return u}));var i={},r=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(i={mouseenter:"mouseover",mouseleave:"mouseout"}));function a(t,e,n){return t=o(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function o(t,e,n){return function(i){var a=r;r=i;try{t.call(this,this.__data__,e,n)}finally{r=a}}}function s(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function l(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,a=e.length;i<a;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function c(t,e,n){var r=i.hasOwnProperty(t.type)?a:o;return function(i,a,o){var s,l=this.__on,c=r(e,a,o);if(l)for(var u=0,h=l.length;u<h;++u)if((s=l[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(s):this.__on=[s]}}function u(t,e,n,i){var a=r;t.sourceEvent=r,r=t;try{return e.apply(n,i)}finally{r=a}}e.b=function(t,e,n){var i,r,a=s(t+""),o=a.length;if(!(arguments.length<2)){for(u=e?c:l,null==n&&(n=!1),i=0;i<o;++i)this.each(u(a[i],e,n));return this}var u=this.node().__on;if(u)for(var h,d=0,p=u.length;d<p;++d)for(i=0,h=u[d];i<o;++i)if((r=a[i]).type===h.type&&r.name===h.name)return h.value}},227:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i=new WeakMap,r=t=>(...e)=>{const n=t(...e);return i.set(n,!0),n},a=t=>"function"==typeof t&&i.has(t)},228:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i={},r={}},229:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(204),r=n(197);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class a{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=i.a?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],n=this.template.parts,a=document.createTreeWalker(t,133,null,!1);let o,s=0,l=0,c=a.nextNode();for(;s<n.length;)if(o=n[s],Object(r.d)(o)){for(;l<o.index;)l++,"TEMPLATE"===c.nodeName&&(e.push(c),a.currentNode=c.content),null===(c=a.nextNode())&&(a.currentNode=e.pop(),c=a.nextNode());if("node"===o.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(c.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,o.name,o.strings,this.options));s++}else this.__parts.push(void 0),s++;return i.a&&(document.adoptNode(t),customElements.upgrade(t)),t}}},230:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var i=n(204),r=n(194),a=n(219);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o=new WeakMap,s=(t,e,n)=>{let s=o.get(e);void 0===s&&(Object(i.b)(e,e.firstChild),o.set(e,s=new r.d(Object.assign({templateFactory:a.b},n))),s.appendInto(e)),s.setValue(t),s.commit()}},231:function(t,e,n){"use strict";var i=n(232);e.a=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.a.hasOwnProperty(e)?{space:i.a[e],local:t}:t}},232:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var i="http://www.w3.org/1999/xhtml";e.a={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},233:function(t,e,n){"use strict";function i(){}e.a=function(t){return null==t?i:function(){return this.querySelector(t)}}},234:function(t,e,n){"use strict";e.a=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}},235:function(t,e,n){"use strict";var i=n(231),r=n(232);function a(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r.b&&e.documentElement.namespaceURI===r.b?e.createElement(t):e.createElementNS(n,t)}}function o(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}e.a=function(t){var e=Object(i.a)(t);return(e.local?o:a)(e)}},236:function(t,e,n){"use strict";e.a=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}},239:function(t,e,n){"use strict";n.d(e,"c",(function(){return Z})),n.d(e,"a",(function(){return Y}));var i=n(233),r=n(252),a=n(251),o=function(t){return new Array(t.length)};function s(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}s.prototype={constructor:s,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function l(t,e,n,i,r,a){for(var o,l=0,c=e.length,u=a.length;l<u;++l)(o=e[l])?(o.__data__=a[l],i[l]=o):n[l]=new s(t,a[l]);for(;l<c;++l)(o=e[l])&&(r[l]=o)}function c(t,e,n,i,r,a,o){var l,c,u,h={},d=e.length,p=a.length,f=new Array(d);for(l=0;l<d;++l)(c=e[l])&&(f[l]=u="$"+o.call(c,c.__data__,l,e),u in h?r[l]=c:h[u]=c);for(l=0;l<p;++l)(c=h[u="$"+o.call(t,a[l],l,a)])?(i[l]=c,c.__data__=a[l],h[u]=null):n[l]=new s(t,a[l]);for(l=0;l<d;++l)(c=e[l])&&h[f[l]]===c&&(r[l]=c)}function u(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var h=n(231);function d(t){return function(){this.removeAttribute(t)}}function p(t){return function(){this.removeAttributeNS(t.space,t.local)}}function f(t,e){return function(){this.setAttribute(t,e)}}function g(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function m(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function b(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var v=n(253);function y(t){return function(){delete this[t]}}function _(t,e){return function(){this[t]=e}}function w(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function x(t){return t.trim().split(/^|\s+/)}function C(t){return t.classList||new E(t)}function E(t){this._node=t,this._names=x(t.getAttribute("class")||"")}function S(t,e){for(var n=C(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function M(t,e){for(var n=C(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function A(t){return function(){S(this,t)}}function O(t){return function(){M(this,t)}}function k(t,e){return function(){(e.apply(this,arguments)?S:M)(this,t)}}E.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function T(){this.textContent=""}function N(t){return function(){this.textContent=t}}function L(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function D(){this.innerHTML=""}function I(t){return function(){this.innerHTML=t}}function P(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function j(){this.nextSibling&&this.parentNode.appendChild(this)}function R(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}var F=n(235);function B(){return null}function H(){var t=this.parentNode;t&&t.removeChild(this)}function $(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function q(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var U=n(221),W=n(234);function z(t,e,n){var i=Object(W.a)(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function G(t,e){return function(){return z(this,t,e)}}function V(t,e){return function(){return z(this,t,e.apply(this,arguments))}}var Z=[null];function Y(t,e){this._groups=t,this._parents=e}function X(){return new Y([[document.documentElement]],Z)}Y.prototype=X.prototype={constructor:Y,select:function(t){"function"!=typeof t&&(t=Object(i.a)(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var o,s,l=e[a],c=l.length,u=r[a]=new Array(c),h=0;h<c;++h)(o=l[h])&&(s=t.call(o,o.__data__,h,l))&&("__data__"in o&&(s.__data__=o.__data__),u[h]=s);return new Y(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Object(r.a)(t));for(var e=this._groups,n=e.length,i=[],a=[],o=0;o<n;++o)for(var s,l=e[o],c=l.length,u=0;u<c;++u)(s=l[u])&&(i.push(t.call(s,s.__data__,u,l)),a.push(s));return new Y(i,a)},filter:function(t){"function"!=typeof t&&(t=Object(a.a)(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],l=s.length,c=i[r]=[],u=0;u<l;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&c.push(o);return new Y(i,this._parents)},data:function(t,e){if(!t)return m=new Array(this.size()),d=-1,this.each((function(t){m[++d]=t})),m;var n,i=e?c:l,r=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),u=new Array(o),h=new Array(o),d=0;d<o;++d){var p=r[d],f=a[d],g=f.length,m=t.call(p,p&&p.__data__,d,r),b=m.length,v=u[d]=new Array(b),y=s[d]=new Array(b);i(p,f,v,y,h[d]=new Array(g),m,e);for(var _,w,x=0,C=0;x<b;++x)if(_=v[x]){for(x>=C&&(C=x+1);!(w=y[C])&&++C<b;);_._next=w||null}}return(s=new Y(s,r))._enter=u,s._exit=h,s},enter:function(){return new Y(this._enter||this._groups.map(o),this._parents)},exit:function(){return new Y(this._exit||this._groups.map(o),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,a=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?a.remove():n(a),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var l,c=e[s],u=n[s],h=c.length,d=o[s]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<i;++s)o[s]=e[s];return new Y(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],a=r.length-1,o=r[a];--a>=0;)(i=r[a])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=u);for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var o,s=n[a],l=s.length,c=r[a]=new Array(l),h=0;h<l;++h)(o=s[h])&&(c[h]=o);c.sort(e)}return new Y(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var o=i[r];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,a=e[n],o=0,s=a.length;o<s;++o)(r=a[o])&&t.call(r,r.__data__,o,a);return this},attr:function(t,e){var n=Object(h.a)(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?p:d:"function"==typeof e?n.local?b:m:n.local?g:f)(n,e))},style:v.a,property:function(t,e){return arguments.length>1?this.each((null==e?y:"function"==typeof e?w:_)(t,e)):this.node()[t]},classed:function(t,e){var n=x(t+"");if(arguments.length<2){for(var i=C(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?k:e?A:O)(n,e))},text:function(t){return arguments.length?this.each(null==t?T:("function"==typeof t?L:N)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?D:("function"==typeof t?P:I)(t)):this.node().innerHTML},raise:function(){return this.each(j)},lower:function(){return this.each(R)},append:function(t){var e="function"==typeof t?t:Object(F.a)(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Object(F.a)(t),r=null==e?B:"function"==typeof e?e:Object(i.a)(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(H)},clone:function(t){return this.select(t?q:$)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:U.b,dispatch:function(t,e){return this.each(("function"==typeof e?V:G)(t,e))}};e.b=X},240:function(t,e,n){"use strict";var i=n(309),r=n(56),a=n(25),o=n(11),s=n(24);var l=function(t){return"string"==typeof t||!Object(o.a)(t)&&Object(s.a)(t)&&"[object String]"==Object(a.a)(t)},c=n(39),u=n(42),h=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;var m=function(t){if("number"==typeof t)return t;if(Object(u.a)(t))return NaN;if(Object(c.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(c.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(h,"");var n=p.test(t);return n||f.test(t)?g(t.slice(2),n?2:8):d.test(t)?NaN:+t};var b=function(t){return t?(t=m(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var v=function(t){var e=b(t),n=e%1;return e==e?n?e-n:e:0},y=n(92);var _=function(t,e){return Object(y.a)(e,(function(e){return t[e]}))},w=n(40);var x=function(t){return null==t?[]:_(t,Object(w.a)(t))},C=Math.max;e.a=function(t,e,n,a){t=Object(r.a)(t)?t:x(t),n=n&&!a?v(n):0;var o=t.length;return n<0&&(n=C(o+n,0)),l(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&Object(i.a)(t,e,n)>-1}},241:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u}));class i{constructor({min:t=-1/0,max:e=1/0}={}){this.segments=[],this.max=e,this.min=t,this.regionString=null}encode(t=!1){return this.segments.map(({start:e,end:n})=>{if(t)return`${e}:${n}`;return`${e===this.min?"":e}:${n===this.max?"":n}`}).join(",")}decode(t){void 0!==t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map(t=>{const[e,n,i]=t.split(":");if(void 0!==i)throw new Error("there should be at most 1 ':' per region. Region: "+t);let r=e?Number(e):this.min,a=n?Number(n):this.max;if(r>a&&([r,a]=[a,r]),r<this.min&&(r=this.min),a>this.max&&(a=this.max),Number.isNaN(r))throw new Error(`The parsed value of ${e} is NaN. Region: ${t}`);if(Number.isNaN(a))throw new Error(`The parsed value of ${n} is NaN. Region: ${t}`);return{start:r,end:a}}):this.segments=[]}}const r=(t,e)=>t?e?`${t},${e}`:t:e;const a=["left","right","top","bottom"],o=a.map(t=>"margin"+t);var s=(t,e={initialValue:{top:0,bottom:0,left:0,right:0}})=>{class n extends t{constructor(){super(),this.margin=e.initialValue}static get observedAttributes(){return[...super.observedAttributes,...o]}attributeChangedCallback(t,e,n){e!==n&&o.includes(t)&&(this[t]=n),super.attributeChangedCallback(t,e,n)}}for(const t of a)Object.defineProperty(n.prototype,"margin"+t,{get(){return this.margin[t]||0},set(e){this.margin[t]=+e}});return n};const l=class{constructor({element:t,min:e,max:n}){this.element=t,this.region=new i({min:e,max:n}),this.fixedHighlight=null}set max(t){this.region.max=t}setAttributesInElement(){this.region.decode(this.element.getAttribute("highlight")),0===this.region.segments.length&&(this.element._highlightstart=Number(this.element.getAttribute("highlightstart")),this.element._highlightend=Number(this.element.getAttribute("highlightend")),null!==this.element._highlightstart&&null!==this.element._highlightend&&"number"==typeof this.element._highlightstart&&"number"==typeof this.element._highlightend&&(this.element._highlight=`${this.element._highlightstart}:${this.element._highlightend}`,this.region.decode(r(this.fixedHighlight,this.element._highlight))))}setFloatAttribute(t,e){const n=parseFloat(e);this.element["_"+t]=Number.isNaN(n)?e:n}changedCallBack(t,e){switch(t){case"highlightstart":case"highlightend":this.setFloatAttribute(t,e),this.element._highlight=Number.isNaN(this.element._highlightstart)||Number.isNaN(this.element._highlightend)||void 0===this.element._highlightstart||void 0===this.element._highlightend||null===this.element._highlightstart||null===this.element._highlightend?"":`${Math.max(this.region.min,this.element._highlightstart)}:${Math.min(this.region.max,this.element._highlightend)}`;break;default:this.element._highlight=e}this.region.decode(r(this.fixedHighlight,this.element._highlight)),this.element.refresh()}setFixedHighlight(t){this.fixedHighlight=t,this.region.decode(r(t,this.element._highlight)),this.element.refresh()}appendHighlightTo(t){this.highlighted=t.append("g").attr("class","highlighted")}updateHighlight(){const t=this.highlighted.selectAll("rect").data(this.region.segments);t.enter().append("rect").style("opacity",.5).attr("fill","rgba(255, 235, 59, 0.8)").style("pointer-events","none").merge(t).attr("height",this.element._height).attr("x",t=>this.element.getXFromSeqPosition(t.start)).attr("width",t=>this.element.getSingleBaseWidth()*(t.end-t.start+1)),t.exit().remove()}},c=class{constructor(t){this.element=t,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null}setElementScrollable(t){this.element.setAttribute("scrollable",t)}startResetScrollableTimer(){this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout(()=>{this.setElementScrollable(!0),this.resetScrollableTimeout=null},400)}blockScroll(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}isWheelEventInsideElement(t,e){const{height:n,width:i,x:r,y:a}=this.element.getBoundingClientRect();return t>r&&e<r+i&&e>a&&e<a+n}wheel({x:t,y:e,timeStamp:n}){this.isWheelEventInsideElement(t,e)?n<this.timeStampWheelOutside+400?this.blockScroll(n):this.setElementScrollable(!0):this.blockScroll(n)}},u=s},251:function(t,e,n){"use strict";e.a=function(t){return function(){return this.matches(t)}}},252:function(t,e,n){"use strict";function i(){return[]}e.a=function(t){return null==t?i:function(){return this.querySelectorAll(t)}}},253:function(t,e,n){"use strict";n.d(e,"b",(function(){return s}));var i=n(234);function r(t){return function(){this.style.removeProperty(t)}}function a(t,e,n){return function(){this.style.setProperty(t,e,n)}}function o(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function s(t,e){return t.style.getPropertyValue(e)||Object(i.a)(t).getComputedStyle(t,null).getPropertyValue(e)}e.a=function(t,e,n){return arguments.length>1?this.each((null==e?r:"function"==typeof e?o:a)(t,e,null==n?"":n)):s(this.node(),t)}},254:function(t,e,n){"use strict";(function(t){var n=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,i){return t[0]===e&&(n=i,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];t.call(e,r[1],r[0])}},e}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var o=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,l=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,r=0;function o(){n&&(n=!1,t()),i&&l()}function s(){a(o)}function l(){var t=Date.now();if(n){if(t-r<2)return;i=!0}else n=!0,i=!1,setTimeout(s,e);r=t}return l}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;o.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),c=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},u=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||r},h=b(0,0,0,0);function d(t){return parseFloat(t)||0}function p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+d(t["border-"+n+"-width"])}),0)}function f(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return h;var i=u(t).getComputedStyle(t),r=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n],a=t["padding-"+r];e[r]=d(a)}return e}(i),a=r.left+r.right,o=r.top+r.bottom,s=d(i.width),l=d(i.height);if("border-box"===i.boxSizing&&(Math.round(s+a)!==e&&(s-=p(i,"left","right")+a),Math.round(l+o)!==n&&(l-=p(i,"top","bottom")+o)),!function(t){return t===u(t).document.documentElement}(t)){var c=Math.round(s+a)-e,f=Math.round(l+o)-n;1!==Math.abs(c)&&(s-=c),1!==Math.abs(f)&&(l-=f)}return b(r.left,r.top,s,l)}var g="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof u(t).SVGGraphicsElement}:function(t){return t instanceof u(t).SVGElement&&"function"==typeof t.getBBox};function m(t){return i?g(t)?function(t){var e=t.getBBox();return b(0,0,e.width,e.height)}(t):f(t):h}function b(t,e,n,i){return{x:t,y:e,width:n,height:i}}var v=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=b(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=m(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),y=function(t,e){var n,i,r,a,o,s,l,u=(i=(n=e).x,r=n.y,a=n.width,o=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(s.prototype),c(l,{x:i,y:r,width:a,height:o,top:r,right:i+a,bottom:o+r,left:i}),l);c(this,{target:t,contentRect:u})},_=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof u(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new v(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof u(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new y(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),w="undefined"!=typeof WeakMap?new WeakMap:new n,x=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=l.getInstance(),i=new _(e,n,this);w.set(this,i)};["observe","unobserve","disconnect"].forEach((function(t){x.prototype[t]=function(){var e;return(e=w.get(this))[t].apply(e,arguments)}}));var C=void 0!==r.ResizeObserver?r.ResizeObserver:x;e.a=C}).call(this,n(23))},255:function(t,e,n){"use strict";class i extends HTMLElement{constructor(){super(),this.protvistaElements=new Set,this.attributeValues=new Map,this.propertyValues=new Map,this.mouseOver=!1}static get observedAttributes(){return["attributes","length","displaystart","displayend","highlight"]}set length(t){this.attributeValues.set("length",t)}get length(){return this.attributeValues.get("length")}set displaystart(t){this.attributeValues.set("displaystart",t)}get displaystart(){return this.attributeValues.get("displaystart")}set displayend(t){this.attributeValues.set("displayend",t)}get displayend(){return this.attributeValues.get("displayend")}set highlight(t){this.attributeValues.set("highlight",t)}get highlight(){return this.attributeValues.get("highlight")}attributeChangedCallback(t,e,n){if(e!==n){if("attributes"===t){if(this._attributes=n.split(" "),-1!==this._attributes.indexOf("type"))throw new Error("'type' can't be used as a protvista attribute");if(-1!==this._attributes.indexOf("value"))throw new Error("'value' can't be used as a protvista attribute");this.attributeValues=new Map(this._attributes.filter(t=>!i.observedAttributes.includes(t)).map(t=>[t,null]))}else"length"===t&&(this.length=n),"displaystart"===t&&(this.displaystart=n),"displayend"===t&&(this.displayend=n),"highlight"===t&&(this.highlight=n);this.applyAttributes()}}register(t){this.protvistaElements.add(t),this.applyAttributes()}unregister(t){this.protvistaElements.delete(t)}_polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}applyAttributes(){this.protvistaElements.forEach(t=>{this.attributeValues.forEach((e,n)=>{!1===e||null==e?t.removeAttribute(n):t.setAttribute(n,"boolean"==typeof e?"":e)})})}applyProperties(t){if(t){const e=this.querySelector("#"+t);this.propertyValues.forEach((t,n)=>{e[n]=t})}else this.protvistaElements.forEach(t=>{this.propertyValues.forEach((e,n)=>{t[n]=e})})}isRegisteredAttribute(t){return[...this.attributeValues.keys()].includes(t)||i.observedAttributes.includes(t)}_changeListener(t){switch(t.detail.handler){case"property":this.propertyValues.set(t.detail.type,t.detail.value),this.applyProperties(t.detail.for);break;default:this.isRegisteredAttribute(t.detail.type)&&this.attributeValues.set(t.detail.type,t.detail.value),Object.keys(t.detail).forEach(e=>{this.isRegisteredAttribute(e)&&this.attributeValues.set(e,t.detail[e])}),this.applyAttributes()}}connectedCallback(){this.addEventListener("change",this._changeListener)}}e.a=i},258:function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},264:function(t,e,n){"use strict";var i=n(203),r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),a=new Uint8Array(16);function o(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(a)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var l=function(t){return"string"==typeof t&&s.test(t)},c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));var h,d,p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!l(n))throw TypeError("Stringified UUID is invalid");return n},f=0,g=0;var m=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||h,s=void 0!==t.clockseq?t.clockseq:d;if(null==a||null==s){var l=t.random||(t.rng||o)();null==a&&(a=h=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==s&&(s=d=16383&(l[6]<<8|l[7]))}var c=void 0!==t.msecs?t.msecs:Date.now(),u=void 0!==t.nsecs?t.nsecs:g+1,m=c-f+(u-g)/1e4;if(m<0&&void 0===t.clockseq&&(s=s+1&16383),(m<0||c>f)&&void 0===t.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=c,g=u,d=s;var b=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;r[i++]=b>>>24&255,r[i++]=b>>>16&255,r[i++]=b>>>8&255,r[i++]=255&b;var v=c/4294967296*1e4&268435455;r[i++]=v>>>8&255,r[i++]=255&v,r[i++]=v>>>24&15|16,r[i++]=v>>>16&255,r[i++]=s>>>8|128,r[i++]=255&s;for(var y=0;y<6;++y)r[i+y]=a[y];return e||p(r)},b=n(241);var v=i.b`
  :host {
    display: block;
  }
  .protvista-datatable-container {
    overflow-y: auto;
    // Note: overflow-x was set to 'hidden' but changing
    // to 'auto' doesn't seem to be an issue.
    overflow-x: auto;
  }

  :host([scrollable="true"]) .protvista-datatable-container {
    overflow-y: auto;
    will-change: scroll;
  }

  :host([scrollable="false"]) .protvista-datatable-container {
    overflow-y: hidden;
  }

  table {
    width: 100%;
    padding: 0;
    margin: 0;
    border-spacing: 0;
  }

  th {
    position: sticky;
    position: -webkit-sticky;
    position: -moz-sticky;
    position: -ms-sticky;
    position: -o-sticky;
    text-align: left;
    background-color: var(--protvista-datable__header-background, #fff);
    color: var(--protvista-datable__header-text, #393b42);
    text-overflow: ellipsis;
    top: 0;
  }

  td,
  th {
    padding: 1rem;
    border-bottom: 1px solid #c2c4c4;
  }

  tr:hover:not(.active):not(.child-row) {
    background-color: var(--protvista-datatable__hover, #f1f1f1);
  }

  td {
    cursor: pointer;
  }

  .withChildren:before {
    display: inline-block;
    font-family: "Courier New", Courier, monospace;
    width: 1rem;
    text-align: center;
    border-radius: 1rem;
    line-height: 1rem;
    font-weight: 700;
    font-size: 1rem;
    color: white;
    border: 2px solid white;
    background-color: var(--protvista-datatable__childToggle, #00639a);
  }

  .plus:before {
    content: "+";
  }

  .minus:before {
    content: "-";
  }

  td:nth-child(1) {
    border-left: 0.5rem solid transparent;
  }

  .overlapped td:nth-child(1) {
    border-left: 0.5rem solid
      var(--protvista-datatable__overlapped, rgba(255, 0, 0, 0.8));
  }

  .active {
    background-color: var(
      --protvista-datatable__active,
      rgba(255, 235, 59, 0.3)
    ) !important;
  }
  .hidden {
    opacity: 0.2;
  }
  .evidence-tag {
    cursor: pointer;
    font-size: 80%;
    white-space: nowrap;
    margin-left: 0.5rem;
    border-radius: 0.5rem;
    background-color: #f1f1f1;
    padding: 0.25rem 0.5rem;
    color: #3a343a;
  }
  .evidence-tag__label {
    padding-left: 0.25rem;
    text-transform: capitalize;
  }
  .svg-colour-reviewed {
    fill: #c39b00;
  }
  .svg-colour-unreviewed {
    fill: #c0c0c0;
  }

  .protvista-datatable__child-item {
    display: flex;
  }

  .protvista-datatable__child-item__title {
    font-weight: 700;
    flex-basis: 10vw;
    flex-grow: 0;
    margin-right: 1rem;
  }

  .protvista-datatable__child-item__content {
  }

  .odd {
    background-color: var(--protvista-datatable__odd, #e4e8eb);
  }

  .even {
    background-color: var(--protvista-datatable__even, #fff);
  }
`;class y extends i.a{constructor(){super(),this.height=25,this.visibleChildren=[],this.noScrollToRow=!1,this.noDeselect=!1,this.eventHandler=this.eventHandler.bind(this),this.scrollFilter=new b.a(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){super.connectedCallback(),this.addEventListener("load",t=>{Array.from(this.children).includes(t.target)&&(this.data=y.processData(t.detail.payload.features))}),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this.noDeselect||document.addEventListener("click",this.eventHandler),this.classList.add("feature"),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){super.disconnectedCallback(),this.manager&&this.manager.unregister(this),document.removeEventListener("click",this.eventHandler),document.removeEventListener("wheel",this.wheelListener)}set data(t){const e=this._data;this._data=y.processData(t),this.requestUpdate("data",e)}get data(){return this._data}eventHandler(t){t.target.closest("protvista-datatable")||t.target.closest(".feature")||(this.selectedid=null)}static get properties(){return{data:{type:Object},highlight:{converter:t=>t&&"null"!==t?t.split(":").map(t=>Number(t)):null},height:{type:Number},columns:{type:Object},displayStart:{type:Number},displayEnd:{type:Number},visibleChildren:{type:Array},selectedid:{type:String},rowClickEvent:{type:Function},noScrollToRow:{type:Boolean},noDeselect:{type:Boolean}}}static get styles(){return v}static processData(t){return t.map(t=>({...t,start:t.start?t.start:t.begin})).sort((t,e)=>t.start-e.start).map(t=>({...t,protvistaFeatureId:t.protvistaFeatureId||m()}))}static isWithinRange(t,e,n,i){return!n&&e===Number(i)||!i&&t===Number(n)||t<=n&&e>=i}static isOutside(t,e,n,i){return t>i||e<n}handleClick(t,e){if(!t.target.parentNode)return;const{start:n,end:i}=e,r="function"==typeof this.rowClickEvent&&this.rowClickEvent(e)||{};this.selectedid=t.target.parentNode.dataset.id,n&&i&&(r.highlight=`${n}:${i}`),this.dispatchEvent(new CustomEvent("change",{detail:r,bubbles:!0,cancelable:!0}))}getStyleClass(t,e,n){let i="";return this.selectedid&&this.selectedid===t&&(i+=" active"),this.displayStart&&this.displayEnd&&y.isOutside(this.displayStart,this.displayEnd,e,n)&&(i+=" hidden"),this.highlight&&y.isWithinRange(this.highlight[0],this.highlight[1],e,n)&&(i+=" overlapped"),i}hasChildData(t,e){return t.some(t=>this.columns[t].resolver(e))}toggleVisibleChild(t){this.visibleChildren.includes(t)?this.visibleChildren=this.visibleChildren.filter(e=>e!==t):this.visibleChildren=[...this.visibleChildren,t]}scrollIntoView(){if(!this.selectedid)return;this.shadowRoot.querySelector(`[data-id="${this.selectedid}"]`).scrollIntoView({behavior:"smooth",block:"center"})}getChildRow(t,e){return i.c`
      <tr class="child-row">
        <td
          colspan="${Object.values(this.columns).filter(t=>!t.child).length+1}"
        >
          ${t.map(t=>this.columns[t].resolver(e)?i.c`
                  <div class="protvista-datatable__child-item">
                    <div class="protvista-datatable__child-item__title">
                      ${this.columns[t].label}
                    </div>
                    <div class="protvista-datatable__child-item__content">
                      ${this.columns[t].resolver(e)}
                    </div>
                  </div>
                `:i.c``)}
        </td>
      </tr>
    `}render(){if(!this.data||!this.columns)return i.c``;const t=Object.keys(this.columns).filter(t=>this.columns[t].child),e=Object.values(this.columns).filter(t=>!t.child&&!1!==t.display);return i.c`
      <div
        class="protvista-datatable-container"
        style="height:${this.height}rem"
      >
        <table>
          <thead>
            <tr>
              ${e.map(t=>i.c` <th>${t.label}</th> `)}
            </tr>
          </thead>
          <tbody>
            ${this.data.map((n,r)=>{const a=this.hasChildData(t,n);return i.c`
                <tr
                  data-id="${n.protvistaFeatureId}"
                  class="${this.getStyleClass(n.protvistaFeatureId,n.start,n.end)} ${r%2==1?"even":"odd"}"
                  @click="${t=>this.handleClick(t,n)}"
                >
                  ${e.map((t,e)=>a&&0===e?i.c`
                          <td
                            title="View more"
                            @click="${()=>this.toggleVisibleChild(n.protvistaFeatureId)}"
                            class="${this.visibleChildren.includes(n.protvistaFeatureId)?"withChildren minus":"withChildren plus"}"
                          >
                            ${t.resolver(n)}
                          </td>
                        `:i.c`
                          <td>
                            ${t.resolver(n)}
                          </td>
                        `)}
                </tr>
                ${a&&this.visibleChildren.includes(n.protvistaFeatureId)?this.getChildRow(t,n):""}
              `})}
          </tbody>
        </table>
      </div>
    `}updated(){this.noScrollToRow||this.scrollIntoView()}}e.a=y},265:function(t,e,n){"use strict";var i=n(60);var r=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},a=Math.max;var o=function(t,e,n){return e=a(void 0===e?t.length-1:e,0),function(){for(var i=arguments,o=-1,s=a(i.length-e,0),l=Array(s);++o<s;)l[o]=i[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=i[o];return c[e]=n(l),r(t,this,c)}},s=n(104),l=n(86),c=l.a?function(t,e){return Object(l.a)(t,"toString",{configurable:!0,enumerable:!1,value:Object(s.a)(e),writable:!0})}:i.a,u=Date.now;var h=function(t){var e=0,n=0;return function(){var i=u(),r=16-(i-n);if(n=i,r>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(c);e.a=function(t,e){return h(o(t,e,i.a),t+"")}},267:function(t,e,n){"use strict";var i=n(97),r=n(21),a=n(67),o=n(11),s=r.a?r.a.isConcatSpreadable:void 0;var l=function(t){return Object(o.a)(t)||Object(a.a)(t)||!!(s&&t&&t[s])};e.a=function t(e,n,r,a,o){var s=-1,c=e.length;for(r||(r=l),o||(o=[]);++s<c;){var u=e[s];n>0&&r(u)?n>1?t(u,n-1,r,a,o):Object(i.a)(o,u):a||(o[o.length]=u)}return o}},277:function(t,e,n){"use strict";var i=n(278),r=n(236);e.a=function(t,e,n){arguments.length<3&&(n=e,e=Object(i.a)().changedTouches);for(var a,o=0,s=e?e.length:0;o<s;++o)if((a=e[o]).identifier===n)return Object(r.a)(t,a);return null}},278:function(t,e,n){"use strict";var i=n(221);e.a=function(){for(var t,e=i.c;t=e.sourceEvent;)e=t;return e}},279:function(t,e,n){"use strict";var i=n(239);e.a=function(t){return"string"==typeof t?new i.a([[document.querySelector(t)]],[document.documentElement]):new i.a([[t]],i.c)}},280:function(t,e,n){"use strict";var i=n(278),r=n(236);e.a=function(t){var e=Object(i.a)();return e.changedTouches&&(e=e.changedTouches[0]),Object(r.a)(t,e)}},281:function(t,e,n){"use strict";var i=n(309);e.a=function(t,e){return!!(null==t?0:t.length)&&Object(i.a)(t,e,0)>-1}},282:function(t,e,n){"use strict";e.a=function(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}},283:function(t,e,n){"use strict";var i=n(56),r=n(24);e.a=function(t){return Object(r.a)(t)&&Object(i.a)(t)}},284:function(t,e,n){"use strict";var i=n(191),r=n(241);class a extends HTMLElement{constructor(){super(),this._x=null,this._padding=0,this.height=40,this.dontDispatch=!1}_refreshWidth(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth-this.margin.left-this.margin.right,this.width>0&&(this._padding=10)}connectedCallback(){this._refreshWidth(),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=parseFloat(this.getAttribute("length")),this._displaystart=parseFloat(this.getAttribute("displaystart"))||1,this._displayend=parseFloat(this.getAttribute("displayend"))||this._length,this._highlightStart=parseFloat(this.getAttribute("highlightStart")),this._highlightEnd=parseFloat(this.getAttribute("highlightEnd")),this._rulerstart=parseFloat(this.getAttribute("rulerStart"))||1,this._onResize=this._onResize.bind(this),this._createNavRuler()}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro&&this._ro.unobserve(this),window.removeEventListener("resize",this._onResize)}static get observedAttributes(){return["length","displaystart","displayend","highlightStart","highlightEnd","width","rulerstart"]}attributeChangedCallback(t,e,n){e!==n&&(this["_"+t]=parseFloat(n),this._updateNavRuler())}get width(){return this._width}set width(t){this._width=t}_createNavRuler(){this._x=Object(i.i)().range([this._padding,this.width-this._padding]),this._x.domain([this._rulerstart,this._rulerstart+this._length-1]),this._container=Object(i.l)(this).append("div").attr("class","container"),this._svg=this._container.append("svg").attr("id","").attr("width",this.width).attr("height",this.height),this._xAxis=Object(i.a)(this._x),this._displaystartLabel=this._svg.append("text").attr("class","start-label").attr("x",0).attr("y",this.height-this._padding),this._displayendLabel=this._svg.append("text").attr("class","end-label").attr("x",this.width).attr("y",this.height-this._padding).attr("text-anchor","end"),this._axis=this._svg.append("g").attr("class","x axis").call(this._xAxis),this._viewport=Object(i.d)().extent([[this._padding,0],[this.width-this._padding,.51*this.height]]).on("brush",()=>{i.e.selection&&(this._displaystart=Object(i.f)("d")(this._x.invert(i.e.selection[0])),this._displayend=Object(i.f)("d")(this._x.invert(i.e.selection[1])),this.dontDispatch||this.dispatchEvent(new CustomEvent("change",{detail:{displayend:this._displayend,displaystart:this._displaystart,extra:{transform:i.e.transform}},bubbles:!0,cancelable:!0})),this._updateLabels(),this._updatePolygon())}),this._brushG=this._svg.append("g").attr("class","brush").call(this._viewport),this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.polygon=this._svg.append("polygon").attr("class","zoom-polygon").attr("fill","#777").attr("fill-opacity","0.3"),this._updateNavRuler(),"ResizeObserver"in window&&(this._ro=new ResizeObserver(this._onResize),this._ro.observe(this)),window.addEventListener("resize",this._onResize)}_onResize(){this._refreshWidth(),this._x=this._x.range([this._padding,this.width-this._padding]),this._svg.attr("width",this.width),this._viewport.extent([[this._padding,0],[this.width-this._padding,.51*this.height]]),this._brushG.call(this._viewport),this._updateNavRuler()}_updateNavRuler(){this._x&&(this._container.style("padding-left",this.margin.left+"px").style("padding-right",this.margin.right+"px").style("padding-top",this.margin.top+"px").style("padding-bottom",this.margin.bottom+"px"),this._x.domain([this._rulerstart,this._rulerstart+this._length-1]),this._axis.call(this._xAxis),this._updatePolygon(),this._updateLabels(),this._brushG&&(this.dontDispatch=!0,this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.dontDispatch=!1))}_updateLabels(){this._displaystartLabel&&this._displaystartLabel.text(this._displaystart),this._displayendLabel&&this._displayendLabel.attr("x",this.width).text(this._displayend)}_updatePolygon(){this.polygon&&this.polygon.attr("points",`${this._x(this._displaystart)},${this.height/2}\n        ${this._x(this._displayend)},${this.height/2}\n        ${this.width},${this.height}\n        0,${this.height}`)}}e.a=Object(r.c)(a)},290:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},291:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},292:function(t,e,n){var i=n(364);function r(e,n,a){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=r=Reflect.get:t.exports=r=function(t,e,n){var r=i(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(n):a.value}},r(e,n,a||e)}t.exports=r},293:function(t,e,n){var i=n(365);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},294:function(t,e,n){var i=n(64),r=n(295);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}},295:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},301:function(t,e,n){"use strict";var i=n(239);e.a=function(t){return"string"==typeof t?new i.a([document.querySelectorAll(t)],[document.documentElement]):new i.a([null==t?[]:t],i.c)}},306:function(t,e,n){"use strict";n.d(e,"c",(function(){return Ii})),n.d(e,"a",(function(){return Pi}));var i=n(33),r=n.n(i),a=n(210),o=n.n(a),s=n(28),l=n.n(s),c=n(38),u=n.n(c),h=n(49),d=n.n(h),p=n(290),f=n.n(p),g=n(291),m=n.n(g),b=n(292),v=n.n(b),y=n(293),_=n.n(y),w=n(294),x=n.n(w),C=n(258),E=n.n(C),S=n(203),M=t=>{throw new Error(`Parameter '${t}' is required`)},A=(t=M("time"))=>new Promise(e=>setTimeout(e,t));let O="node";"undefined"!=typeof importScripts?O="worker":"undefined"!=typeof window&&(O="browser");var k=O;let T=()=>A(0);"browser"===k&&"requestAnimationFrame"in window&&(T=()=>new Promise(t=>window.requestAnimationFrame(t)));var N=T;let L;if("browser"===k&&"requestIdleCallback"in window)L=t=>new Promise(e=>window.requestIdleCallback(e,{timeout:t}));else{const t=Object.freeze({didTimeout:!0,timeRemaining:()=>1/0});if(L=e=>A((e||0)/2).then(()=>t),"browser"===k&&"requestAnimationFrame"in window){const e=L;L=()=>e().then(N).then(()=>t)}}const D=A,I=N;var P=n(191);class j extends HTMLElement{constructor(){super(),this._x=null,this._padding=0,this.dontDispatch=!1}_refreshWidth(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth,this.width>0&&(this._padding=10)}connectedCallback(){this._refreshWidth(),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=parseFloat(this.getAttribute("length")),this._displaystart=parseFloat(this.getAttribute("displaystart"))||1,this._displayend=parseFloat(this.getAttribute("displayend"))||this._length,this._highlightStart=parseFloat(this.getAttribute("highlightStart")),this._highlightEnd=parseFloat(this.getAttribute("highlightEnd")),this._rulerstart=parseFloat(this.getAttribute("rulerStart"))||1,this._onResize=this._onResize.bind(this),this._createNavRuler()}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro&&this._ro.unobserve(this),window.removeEventListener("resize",this._onResize)}static get observedAttributes(){return["length","displaystart","displayend","highlightStart","highlightEnd","width","rulerstart"]}attributeChangedCallback(t,e,n){e!==n&&(this["_"+t]=parseFloat(n),this._updateNavRuler())}get width(){return this._width}set width(t){this._width=t}_createNavRuler(){this._x=Object(P.i)().range([this._padding,this.width-this._padding]),this._x.domain([this._rulerstart,this._rulerstart+this._length]),this._svg=Object(P.l)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",40),this._xAxis=Object(P.a)(this._x),this._displaystartLabel=this._svg.append("text").attr("class","start-label").attr("x",0).attr("y",40-this._padding),this._displayendLabel=this._svg.append("text").attr("class","end-label").attr("x",this.width).attr("y",40-this._padding).attr("text-anchor","end"),this._axis=this._svg.append("g").attr("class","x axis").call(this._xAxis),this._viewport=Object(P.d)().extent([[this._padding,0],[this.width-this._padding,20.4]]).on("brush",()=>{P.e.selection&&(this._displaystart=Object(P.f)("d")(this._x.invert(P.e.selection[0])),this._displayend=Object(P.f)("d")(this._x.invert(P.e.selection[1])),this.dontDispatch||this.dispatchEvent(new CustomEvent("change",{detail:{displayend:this._displayend,displaystart:this._displaystart,extra:{transform:P.e.transform}},bubbles:!0,cancelable:!0})),this._updateLabels(),this._updatePolygon())}),this._brushG=this._svg.append("g").attr("class","brush").call(this._viewport),this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.polygon=this._svg.append("polygon").attr("class","zoom-polygon").attr("fill","#777").attr("fill-opacity","0.3"),this._updateNavRuler(),"ResizeObserver"in window&&(this._ro=new ResizeObserver(this._onResize),this._ro.observe(this)),window.addEventListener("resize",this._onResize)}_onResize(){this._refreshWidth(),this._x=this._x.range([this._padding,this.width-this._padding]),this._svg.attr("width",this.width),this._viewport.extent([[this._padding,0],[this.width-this._padding,20.4]]),this._brushG.call(this._viewport),this._updateNavRuler()}_updateNavRuler(){this._x&&(this._x.domain([this._rulerstart,this._rulerstart+this._length]),this._axis.call(this._xAxis),this._updatePolygon(),this._updateLabels(),this._brushG&&(this.dontDispatch=!0,this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.dontDispatch=!1))}_updateLabels(){this._displaystartLabel&&this._displaystartLabel.text(this._displaystart),this._displayendLabel&&this._displayendLabel.attr("x",this.width).text(this._displayend)}_updatePolygon(){this.polygon&&this.polygon.attr("points",`${this._x(this._displaystart)},20\n        ${this._x(this._displayend)},20\n        ${this.width},40\n        0,40`)}}var R=j;const F=(t,e=0)=>{const n=(t||"").match(/(\d+\.?\d*)px/);return n?+n[1]:e};class B extends S.a{static get properties(){return{title:{type:String,reflect:!0},x:{type:Number,reflect:!0},y:{type:Number,reflect:!0},visible:{type:Boolean,reflect:!0},container:{type:String,reflect:!0}}}constructor(){super(),this.title="",this.x=0,this.y=0,this.visible=!1,this.container="html",this._changeHandler=()=>this.requestUpdate(),this._observer=new MutationObserver(this._changeHandler)}connectedCallback(){super.connectedCallback(),this._observer.observe(this,{subtree:!0,characterData:!0,childList:!0}),window.addEventListener("resize",this._changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this._observer.disconnect(),window.removeEventListener("resize",this._changeHandler)}static get styles(){return S.b`
      :host {
        --z-index: 50000;
        --title-color: black;
        --text-color: white;
        --body-color: #616161;
        --triangle-width: ${16}px;
        --triangle-height: ${10}px;
        --triangle-margin: ${10}px;
        --vertical-distance: ${5}px;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        margin: 0;
      }

      h1 {
        background-color: var(--title-color);
        line-height: 2em;
        padding: 0 1ch;
      }

      .tooltip {
        font-family: Roboto, Arial, sans-serif;
        font-size: 0.9rem;
        top: 0;
        left: 0;
        display: block;
        position: absolute;
        min-width: 220px;
        max-width: 50vw;

        /* user overridable through custom properties */
        z-index: var(--z-index);
        color: var(--text-color);

        /* will change those */
        opacity: 0;
        pointer-events: none;
        transform: translate(0, 0);
      }

      .tooltip.visible {
        opacity: 0.9;
        pointer-events: auto;
      }

      .tooltip::before {
        content: "";
        position: absolute;
        pointer-events: none;
        border-style: solid;
        border-color: transparent;
        border-width: 0 calc(var(--triangle-width) / 2);
      }

      .tooltip.arrow-left::before {
        left: var(--triangle-margin);
      }

      .tooltip.arrow-right::before {
        right: var(--triangle-margin);
      }

      .tooltip.arrow-up::before {
        top: calc(-1 * var(--triangle-height));
        border-bottom-color: var(--title-color);
        border-bottom-width: var(--triangle-height);
      }

      .tooltip.arrow-down::before {
        bottom: calc(-1 * var(--triangle-height));
        border-top-color: var(--body-color);
        border-top-width: var(--triangle-height);
      }

      :host a,
      :host a:link,
      :host a:active,
      :host a:hover {
        color: #fff;
      }

      .tooltip-body {
        padding: 1em;
        background: var(--body-color);
        font-weight: normal;
        overflow-y: auto;
        max-height: 40vh;
      }

      ::slotted(h4) {
        font-size: 1.2rem !important;
        margin: 0 0 0.5rem 0 !important;
        font-weight: 600 !important;
        color: #fff !important;
      }

      ::slotted(h5) {
        font-size: 1rem !important;
        margin: 0 !important;
        font-weight: 500 !important;
        color: #fff !important;
      }

      ::slotted(h6) {
        font-size: 1rem !important;
        margin: 0 !important;
        font-weight: 300 !important;
        color: #fff !important;
      }

      ::slotted(p) {
        margin: 0.25rem 0 1rem 0 !important;
      }

      ::slotted(ul) {
        list-style: none !important;
        margin: 0.25rem 0 1rem 0 !important;
        padding: 0 !important;
      }
    `}_getPosition(){if(!this.shadowRoot.firstElementChild)return{};const t=document.querySelector(this.container||"html").getBoundingClientRect(),e=this.shadowRoot.firstElementChild.getBoundingClientRect(),n=getComputedStyle(this),i=F(n.getPropertyValue("--triangle-width"),16),r=F(n.getPropertyValue("--triangle-height"),10),a=F(n.getPropertyValue("--triangle-margin"),10),o=F(n.getPropertyValue("--vertical-distance"),5);let s=this.x-i/2-a,l="left";s+e.width<=t.right||(l="right",s=this.x-e.width+i/2+a);let c=this.y+r+o,u="up";return c+e.height<=t.height||(u="down",c=this.y-e.height-r-o),{x:s,y:c,horizontal:l,vertical:u}}firstUpdated(){this.requestUpdate()}render(){let t=this.title&&this.visible;const e=t?this._getPosition():{};t=e.x&&t;const n=t&&`transform: translate(${e.x}px, ${e.y}px);`;return S.c`
        <section
          class="tooltip arrow-${e.horizontal||"left"} arrow-${e.vertical||"up"} ${t?"visible":""}"
          style="${n}"
        >
          <h1>${this.title}</h1>
          <div class="tooltip-body"><slot></slot></div>
        </sectionclass="tooltip>
      `}}var H=B,$=n(240),q=n(182),U=n(212),W=n(215);class z{constructor({min:t=-1/0,max:e=1/0}={}){this.segments=[],this.max=e,this.min=t,this.regionString=null}encode(t=!1){return this.segments.map(({start:e,end:n})=>{if(t)return`${e}:${n}`;return`${e===this.min?"":e}:${n===this.max?"":n}`}).join(",")}decode(t){void 0!==t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map(t=>{const[e,n,i]=t.split(":");if(void 0!==i)throw new Error("there should be at most 1 ':' per region. Region: "+t);let r=e?Number(e):this.min,a=n?Number(n):this.max;if(r>a&&([r,a]=[a,r]),r<this.min&&(r=this.min),a>this.max&&(a=this.max),Number.isNaN(r))throw new Error(`The parsed value of ${e} is NaN. Region: ${t}`);if(Number.isNaN(a))throw new Error(`The parsed value of ${n} is NaN. Region: ${t}`);return{start:r,end:a}}):this.segments=[]}}const G=(t,e)=>t?e?`${t},${e}`:t:e;const V=class{constructor({element:t,min:e,max:n}){this.element=t,this.region=new z({min:e,max:n}),this.fixedHighlight=null}set max(t){this.region.max=t}setAttributesInElement(){this.region.decode(this.element.getAttribute("highlight")),0===this.region.segments.length&&(this.element._highlightstart=Number(this.element.getAttribute("highlightstart")),this.element._highlightend=Number(this.element.getAttribute("highlightend")),null!==this.element._highlightstart&&null!==this.element._highlightend&&"number"==typeof this.element._highlightstart&&"number"==typeof this.element._highlightend&&(this.element._highlight=`${this.element._highlightstart}:${this.element._highlightend}`,this.region.decode(G(this.fixedHighlight,this.element._highlight))))}setFloatAttribute(t,e){const n=parseFloat(e);this.element["_"+t]=Number.isNaN(n)?e:n}changedCallBack(t,e){switch(t){case"highlightstart":case"highlightend":this.setFloatAttribute(t,e),this.element._highlight=Number.isNaN(this.element._highlightstart)||Number.isNaN(this.element._highlightend)||void 0===this.element._highlightstart||void 0===this.element._highlightend||null===this.element._highlightstart||null===this.element._highlightend?"":`${Math.max(this.region.min,this.element._highlightstart)}:${Math.min(this.region.max,this.element._highlightend)}`;break;default:this.element._highlight=e}this.region.decode(G(this.fixedHighlight,this.element._highlight)),this.element.refresh()}setFixedHighlight(t){this.fixedHighlight=t,this.region.decode(G(t,this.element._highlight)),this.element.refresh()}appendHighlightTo(t){this.highlighted=t.append("g").attr("class","highlighted")}updateHighlight(){const t=this.highlighted.selectAll("rect").data(this.region.segments);t.enter().append("rect").style("opacity",.5).attr("fill","rgba(255, 235, 59, 0.8)").style("pointer-events","none").merge(t).attr("height",this.element._height).attr("x",t=>this.element.getXFromSeqPosition(t.start)).attr("width",t=>this.element.getSingleBaseWidth()*(t.end-t.start+1)),t.exit().remove()}},Z=class{constructor(t){this.element=t,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null}setElementScrollable(t){this.element.setAttribute("scrollable",t)}startResetScrollableTimer(){this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout(()=>{this.setElementScrollable(!0),this.resetScrollableTimeout=null},400)}blockScroll(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}isWheelEventInsideElement(t,e){const{height:n,width:i,x:r,y:a}=this.element.getBoundingClientRect();return t>r&&e<r+i&&e>a&&e<a+n}wheel({x:t,y:e,timeStamp:n}){this.isWheelEventInsideElement(t,e)?n<this.timeStampWheelOutside+400?this.blockScroll(n):this.setElementScrollable(!0):this.blockScroll(n)}};var Y=n(254);class X extends HTMLElement{constructor(){super(),X._polyfillElementClosest(),this._updateScaleDomain=this._updateScaleDomain.bind(this),this._initZoom=this._initZoom.bind(this),this.zoomed=this.zoomed.bind(this),this._applyZoomTranslation=this.applyZoomTranslation.bind(this),this._resetEventHandler=this._resetEventHandler.bind(this);let t=!1;this.applyZoomTranslation=()=>{t||(t=!0,requestAnimationFrame(()=>{t=!1,this._applyZoomTranslation()}))},this._onResize=this._onResize.bind(this),this._listenForResize=this._listenForResize.bind(this),this.trackHighlighter=new V({element:this,min:1}),this.scrollFilter=new Z(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth,this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=this.getAttribute("length")?parseFloat(this.getAttribute("length")):0,this._displaystart=this.getAttribute("displaystart")?parseFloat(this.getAttribute("displaystart")):1,this._displayend=this.getAttribute("displayend")?parseFloat(this.getAttribute("displayend")):this.length,this._height=this.getAttribute("height")?Number(this.getAttribute("height")):44,this._highlightEvent=this.getAttribute("highlight-event")?this.getAttribute("highlight-event"):"onclick",this.trackHighlighter.setAttributesInElement(this),this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this._initZoom(),this._listenForResize(),this.addEventListener("error",t=>{console.error(t)}),this.addEventListener("click",this._resetEventHandler),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro?this._ro.unobserve(this):window.removeEventListener("resize",this._onResize),this.removeEventListener("click",this._resetEventHandler),document.removeEventListener("wheel",this.wheelListener)}get width(){return this._width}set width(t){this._width=t}set height(t){this._height=t}get height(){return this._height}set length(t){this._length=t,this.trackHighlighter.max=t}get length(){return this._length}get xScale(){return this._xScale}set xScale(t){this._xScale=t}get zoom(){return this._zoom}set svg(t){this._svg=t,t.call(this._zoom),this.applyZoomTranslation()}get svg(){return this._svg}get margin(){return{top:10,right:10,bottom:10,left:10}}set fixedHighlight(t){this.trackHighlighter.setFixedHighlight(t)}getWidthWithMargins(){return this.width?this.width-this.margin.left-this.margin.right:0}_updateScaleDomain(){this.xScale=Object(P.i)().domain([1,this._length+1]).range([0,this.getWidthWithMargins()])}_initZoom(){this._zoom=Object(P.m)().scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]).extent([[0,0],[this.getWidthWithMargins(),0]]).filter(()=>{if(!(P.e instanceof WheelEvent))return!0;if(this.hasAttribute("scroll-filter")){const t=this.getAttribute("scrollable");if(t)return"true"===t}return!this.hasAttribute("use-ctrl-to-zoom")||P.e.ctrlKey}).on("zoom",this.zoomed)}static get observedAttributes(){return["displaystart","displayend","length","highlight"]}setFloatAttribute(t,e){const n=parseFloat(e);this["_"+t]=Number.isNaN(n)?e:n}attributeChangedCallback(t,e,n){if("null"===n&&(n=null),e!==n){if(t.startsWith("highlight"))return void this.trackHighlighter.changedCallBack(t,n);this.setFloatAttribute(t,n),"length"===t&&(this._updateScaleDomain(),this._originXScale=this.xScale.copy()),this.applyZoomTranslation()}}zoomed(){if(this.xScale=P.e.transform.rescaleX(this._originXScale),this.dontDispatch)return;const[t,e]=this.xScale.domain();this.dispatchEvent(new CustomEvent("change",{detail:{displaystart:Math.max(1,t),displayend:Math.min(this.length,Math.max(e-1,t+1))},bubbles:!0,cancelable:!0}))}applyZoomTranslation(){if(!this.svg||!this._originXScale)return;const t=Math.max(1,this.length/(1+this._displayend-this._displaystart)),e=-this._originXScale(this._displaystart);this.dontDispatch=!0,this.svg.call(this.zoom.transform,P.n.scale(t).translate(e,0)),this.dontDispatch=!1,this.refresh()}_onResize(){this.width=this.offsetWidth,this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this.svg&&this.svg.attr("width",this.width),this._zoom.scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]),this.applyZoomTranslation()}_listenForResize(){this._ro=new Y.a(this._onResize),this._ro.observe(this)}_resetEventHandler(t){t.target.closest(".feature")||this.dispatchEvent(this.createEvent("reset",null,!0))}getXFromSeqPosition(t){return this.margin.left+this.xScale(t)}getSingleBaseWidth(){return this.xScale(2)-this.xScale(1)}static _getClickCoords(){return P.e?[P.e.pageX,P.e.pageY]:null}static _polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}createEvent(t,e=null,n=!1,i=!1,r,a,o){e&&(e=e.feature?e.feature:e);const s={eventtype:t,coords:X._getClickCoords(),feature:e,target:o};return n&&(e&&e.fragments?s.highlight=e.fragments.map(t=>`${t.start}:${t.end}`).join(","):P.e&&P.e.shiftKey&&this._highlight?s.highlight=`${this._highlight},${r}:${a}`:s.highlight=r&&a?`${r}:${a}`:null),i&&(s.selectedid=e&&e.protvistaFeatureId),new CustomEvent("change",{detail:s,bubbles:!0,cancelable:!0})}bindEvents(t,e){t.on("mouseover",(t,n,i)=>{e.dispatchEvent(e.createEvent("mouseover",t,"onmouseover"===e._highlightEvent,!1,t.start,t.end,i[n]))}).on("mouseout",()=>{e.dispatchEvent(e.createEvent("mouseout",null,"onmouseover"===e._highlightEvent))}).on("click",(t,n,i)=>{e.dispatchEvent(e.createEvent("click",t,"onclick"===e._highlightEvent,!0,t.start,t.end,i[n]))})}}var K=X;class J{getFeatureShape(t,e,n,i){return i=i||"rectangle",this._ftLength=n,this._ftHeight=e,this._ftWidth=t*n,"function"!=typeof this["_"+i]&&(i="rectangle"),this["_"+i]()}static isContinuous(t){return"bridge"!==(t=t.toLowerCase())}_rectangle(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+"Z"}_roundRectangle(){return"M6,0h"+(this._ftWidth-12)+",0a6,6 0 0 1 6,6v"+(this._ftHeight-12)+"a6,6 0 0 1 "+"-6,6h"+(12-this._ftWidth)+"a6,6 0 0 1 "+"-6,"+"-6v"+(12-this._ftHeight)+"a6,6 0 0 1 6,"+"-6Z"}_line(){return`M0,${this._ftHeight/2} L${this._ftWidth},${this._ftHeight/2}`}_bridge(){return 1!==this._ftLength?"M0,"+this._ftHeight+"L0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L"+this._ftWidth+",2L0,2Z":"M0,"+this._ftHeight+"L0,"+this._ftHeight/2+"L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth/2+",0L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight+"Z"}_getMiddleLine(t){return"M0,"+t+"L"+this._ftWidth+","+t+"Z"}_diamond(){const t=this._ftWidth/2,e="M"+t+",0L"+(t+5)+",5L"+t+",10L"+(t-5)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth):e+"Z"}_chevron(){const t=this._ftWidth/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+",10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==this._ftLength?e+"L"+t+",5"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_catFace(){const t=this._ftWidth/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+",10L"+(2+t)+",10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==this._ftLength?e+"M"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_triangle(){const t=this._ftWidth/2,e="M"+t+",0L"+(5+t)+",10L"+(-5+t)+",10";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_wave(){const t=this._ftWidth/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getPolygon(t){let e="M ";const n=this._ftWidth/2;for(let i=0;i<t;i++)e+=5*Math.cos(2*Math.PI*i/t)+n+","+(5*Math.sin(2*Math.PI*i/t)+5)+" ";return 1!==this._ftLength?e+" "+(5*Math.cos(0)+n)+","+(5*Math.sin(0)+5)+" "+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_hexagon(){return this._getPolygon(6)}_pentagon(){return this._getPolygon(5)}_circle(){const t=this._ftWidth/2,e=Math.sqrt(10/Math.PI),n="M"+t+",0A"+e+","+e+" 0 1,1 "+t+",10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==this._ftLength?n+this._getMiddleLine(5,this._ftWidth)+"Z":n+"Z"}_arrow(){const t=this._ftWidth/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+this._ftHeight+"L"+t+","+this._ftHeight+"L"+(4+t)+",4";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_doubleBar(){const t=this._ftWidth/2,e="M"+t+",0L"+(-5+t)+",10L"+t+",10L"+(5+t)+",0";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getBrokenEnd(){const t=this._ftHeight/4;return"L"+(this._ftWidth-t)+","+t+"L"+this._ftWidth+","+2*t+"L"+(this._ftWidth-t)+","+3*t+"L"+this._ftWidth+","+this._ftHeight}_getBrokenStart(){const t=this._ftHeight/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t}_discontinuosStart(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuos(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuosEnd(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+"Z"}_helix(){const t=2.5;let e=2.5;const n=Math.round(this._ftWidth/5);let i="";for(let r=0;r<n;r++){i+="M"+(-2.5+e)+","+this._ftHeight+" C"+(e+t)+",7.5 "+(2.5+e)+","+"2.5 "+e+", 0 C"+(e-t)+","+"2.5 "+e+",7.5 "+(2.5+e)+","+this._ftHeight,e+=5}return i}_strand(){let t=0;this._ftWidth>5&&(t=this._ftWidth-5);const e=this._ftHeight/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+("M"+t+",0L"+this._ftWidth+","+2*e+"L"+t+","+this._ftHeight+"Z")}}class Q{constructor({layoutHeight:t,padding:e=1,minHeight:n=17}){this._padding=e,this._minHeight=n,this._layoutHeight=t}init(t){this._features=t}getFeatureYPos(){const t=this.getFeatureHeight();return this._layoutHeight/2-t/2}getFeatureHeight(){return Math.min(this._layoutHeight,this._minHeight)-this._padding}}const tt=(t,e)=>e.some(e=>{return n=t,i=e,!(Number(i.start)>Number(n.end)||Number(i.end)<Number(n.start));var n,i});class et extends Q{constructor(t){super(t),this.featuresMap=new Map,this._rowHeight=0,this._rows=[],this._minHeight=15}init(t){t.forEach(t=>{const e=this._rows.findIndex(e=>!tt(t,e));e>=0?(this._rows[e].push(t),this.featuresMap.set(t,e)):(this._rows.push([t]),this.featuresMap.set(t,this._rows.length-1))}),this._rowHeight=Math.min(this._layoutHeight/this._rows.length,this._minHeight)}getOffset(){return this._rows.length*this._rowHeight<this._layoutHeight?this._layoutHeight/2-this._rows.length*this._rowHeight/2:0}getFeatureYPos(t){const e=this.featuresMap.get(t);return this.getOffset()+this._rowHeight*e+2*this._padding}getFeatureHeight(){return this._rowHeight-2*this._padding}}const nt={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},it=t=>{if(nt[t.toUpperCase()])return nt[t.toUpperCase()].shape;const e=Object.values(nt).find(e=>e.name.toUpperCase()===t.toUpperCase());return e?e.shape:"rectangle"},rt=t=>{if(nt[t.toUpperCase()])return nt[t.toUpperCase()].color;const e=Object.values(nt).find(e=>e.name.toUpperCase()===t.toUpperCase());return e||console.log(t),e?e.color:"black"};class at extends K{getLayout(){return"non-overlapping"===String(this.getAttribute("layout")).toLowerCase()?new et({layoutHeight:this._height}):new Q({layoutHeight:this._height})}connectedCallback(){super.connectedCallback(),this._color=this.getAttribute("color"),this._shape=this.getAttribute("shape"),this._featureShape=new J,this._layoutObj=this.getLayout(),this._data&&this._createTrack(),this.addEventListener("load",t=>{Object($.a)(this.children,t.target)&&(this.data=t.detail.payload)})}static normalizeLocations(t){return t.map(t=>{const{locations:e,start:n,end:i}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:n,end:i}]}]})})}processData(t){this._originalData=at.normalizeLocations(t)}set data(t){this.processData(t),this._applyFilters(),this._layoutObj=this.getLayout(),this._createTrack()}set filters(t){this._filters=t,this._applyFilters(),this._createTrack()}static get observedAttributes(){return K.observedAttributes.concat(["highlight","color","shape","filters"])}_getFeatureColor(t){return t.color?t.color:t.feature&&t.feature.color?t.feature.color:this._color?this._color:t.type?rt(t.type):t.feature&&t.feature.type?rt(t.feature.type):"black"}_getFeatureFillColor(t){return t.fill?t.fill:t.feature&&t.feature.fill?t.feature.fill:this._getFeatureColor(t)}_getShape(t){return t.shape?t.shape:t.feature&&t.feature.shape?t.feature.shape:this._shape?this._shape:t.type?it(t.type):t.feature&&t.feature.type?it(t.feature.type):"rectangle"}_createTrack(){this._layoutObj.init(this._data),Object(P.l)(this).selectAll("div").remove(),this.svg=Object(P.l)(this).append("div").style("line-height",0).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this.seq_g=this.svg.append("g").attr("class","sequence-features"),this._createFeatures()}_createFeatures(){this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data),this.locations=this.featuresG.enter().append("g").attr("class","feature-group").attr("id",t=>"g_"+t.accession).selectAll("g.location-group").data(t=>t.locations.map(e=>Object.assign({},e,{feature:t}))).enter().append("g").attr("class","location-group");const t=this.locations.selectAll("g.fragment-group").data(t=>t.fragments.map(e=>Object.assign({},e,{feature:t.feature}))).enter().append("g").attr("class","fragment-group");t.append("path").attr("class",t=>this._getShape(t)+" feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill",t=>this._getFeatureFillColor(t)).attr("stroke",t=>this._getFeatureColor(t)).style("fill-opacity",({feature:t})=>t.opacity?t.opacity:.9).style("stroke-opacity",({feature:t})=>t.opacity?t.opacity:.9),t.append("rect").attr("class","outer-rectangle feature").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill","transparent").attr("stroke","transparent").call(this.bindEvents,this)}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(q.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return Object(U.a)(...e)}),n=Object(W.a)(...e);this._data=n}refresh(){if(this.xScale&&this.seq_g){const t=this.seq_g.selectAll("g.fragment-group").data(this._data.reduce((t,e)=>t.concat(e.locations.reduce((t,n)=>t.concat(n.fragments.map(t=>Object.assign({},t,{feature:e}))),[])),[]));t.selectAll("path.feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),t.selectAll("rect.outer-rectangle").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}var ot=at;class st{getFeatureShape(t,e,n,i){return i=i||"rectangle",this._ftLength=n,this._ftHeight=e,this._ftWidth=t*n,"function"!=typeof this["_"+i]&&(i="rectangle"),this["_"+i]()}static isContinuous(t){return"bridge"!==(t=t.toLowerCase())}_rectangle(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+"Z"}_roundRectangle(){return"M6,0h"+(this._ftWidth-12)+",0a6,6 0 0 1 6,6v"+(this._ftHeight-12)+"a6,6 0 0 1 "+"-6,6h"+(12-this._ftWidth)+"a6,6 0 0 1 "+"-6,"+"-6v"+(12-this._ftHeight)+"a6,6 0 0 1 6,"+"-6Z"}_line(){return`M0,${this._ftHeight/2} L${this._ftWidth},${this._ftHeight/2}`}_bridge(){return 1!==this._ftLength?"M0,"+this._ftHeight+"L0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L"+this._ftWidth+",2L0,2Z":"M0,"+this._ftHeight+"L0,"+this._ftHeight/2+"L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth/2+",0L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight+"Z"}_getMiddleLine(t){return"M0,"+t+"L"+this._ftWidth+","+t+"Z"}_diamond(){const t=this._ftWidth/2,e="M"+t+",0L"+(t+5)+",5L"+t+",10L"+(t-5)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth):e+"Z"}_chevron(){const t=this._ftWidth/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+",10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==this._ftLength?e+"L"+t+",5"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_catFace(){const t=this._ftWidth/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+",10L"+(2+t)+",10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==this._ftLength?e+"M"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_triangle(){const t=this._ftWidth/2,e="M"+t+",0L"+(5+t)+",10L"+(-5+t)+",10";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_wave(){const t=this._ftWidth/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getPolygon(t){let e="M ";const n=this._ftWidth/2;for(let i=0;i<t;i++)e+=5*Math.cos(2*Math.PI*i/t)+n+","+(5*Math.sin(2*Math.PI*i/t)+5)+" ";return 1!==this._ftLength?e+" "+(5*Math.cos(0)+n)+","+(5*Math.sin(0)+5)+" "+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_hexagon(){return this._getPolygon(6)}_pentagon(){return this._getPolygon(5)}_circle(){const t=this._ftWidth/2,e=Math.sqrt(10/Math.PI),n="M"+t+",0A"+e+","+e+" 0 1,1 "+t+",10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==this._ftLength?n+this._getMiddleLine(5,this._ftWidth)+"Z":n+"Z"}_arrow(){const t=this._ftWidth/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+this._ftHeight+"L"+t+","+this._ftHeight+"L"+(4+t)+",4";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_doubleBar(){const t=this._ftWidth/2,e="M"+t+",0L"+(-5+t)+",10L"+t+",10L"+(5+t)+",0";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getBrokenEnd(){const t=this._ftHeight/4;return"L"+(this._ftWidth-t)+","+t+"L"+this._ftWidth+","+2*t+"L"+(this._ftWidth-t)+","+3*t+"L"+this._ftWidth+","+this._ftHeight}_getBrokenStart(){const t=this._ftHeight/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t}_discontinuosStart(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuos(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuosEnd(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+"Z"}_helix(){const t=2.5;let e=2.5;const n=Math.round(this._ftWidth/5);let i="";for(let r=0;r<n;r++){i+="M"+(-2.5+e)+","+this._ftHeight+" C"+(e+t)+",7.5 "+(2.5+e)+","+"2.5 "+e+", 0 C"+(e-t)+","+"2.5 "+e+",7.5 "+(2.5+e)+","+this._ftHeight,e+=5}return i}_strand(){let t=0;this._ftWidth>5&&(t=this._ftWidth-5);const e=this._ftHeight/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+("M"+t+",0L"+this._ftWidth+","+2*e+"L"+t+","+this._ftHeight+"Z")}}class lt{constructor({layoutHeight:t,padding:e=1,minHeight:n=17}){this._padding=e,this._minHeight=n,this._layoutHeight=t}init(t){this._features=t}getFeatureYPos(){const t=this.getFeatureHeight();return this._layoutHeight/2-t/2}getFeatureHeight(){return Math.min(this._layoutHeight,this._minHeight)-this._padding}}const ct=(t,e)=>e.some(e=>{return n=t,i=e,!(Number(i.start)>Number(n.end)||Number(i.end)<Number(n.start));var n,i});class ut extends lt{constructor(t){super(t),this.featuresMap=new Map,this._rowHeight=0,this._rows=[],this._minHeight=15}init(t){t.forEach(t=>{const e=this._rows.findIndex(e=>!ct(t,e));e>=0?(this._rows[e].push(t),this.featuresMap.set(t,e)):(this._rows.push([t]),this.featuresMap.set(t,this._rows.length-1))}),this._rowHeight=Math.min(this._layoutHeight/this._rows.length,this._minHeight)}getOffset(){return this._rows.length*this._rowHeight<this._layoutHeight?this._layoutHeight/2-this._rows.length*this._rowHeight/2:0}getFeatureYPos(t){const e=this.featuresMap.get(t);return this.getOffset()+this._rowHeight*e+2*this._padding}getFeatureHeight(){return this._rowHeight-2*this._padding}}const ht={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},dt=t=>{if(ht[t.toUpperCase()])return ht[t.toUpperCase()].shape;const e=Object.values(ht).find(e=>e.name.toUpperCase()===t.toUpperCase());return e?e.shape:"rectangle"},pt=t=>{if(ht[t.toUpperCase()])return ht[t.toUpperCase()].color;const e=Object.values(ht).find(e=>e.name.toUpperCase()===t.toUpperCase());return e||console.log(t),e?e.color:"black"};class ft extends K{getLayout(){return"non-overlapping"===String(this.getAttribute("layout")).toLowerCase()?new ut({layoutHeight:this._height}):new lt({layoutHeight:this._height})}connectedCallback(){super.connectedCallback(),this._color=this.getAttribute("color"),this._shape=this.getAttribute("shape"),this._featureShape=new st,this._layoutObj=this.getLayout(),this._data&&this._createTrack(),this.addEventListener("load",t=>{Object($.a)(this.children,t.target)&&(this.data=t.detail.payload)})}static normalizeLocations(t){return t.map(t=>{const{locations:e,start:n,end:i}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:n,end:i}]}]})})}processData(t){this._originalData=ft.normalizeLocations(t)}set data(t){this.processData(t),this._applyFilters(),this._layoutObj=this.getLayout(),this._createTrack()}set filters(t){this._filters=t,this._applyFilters(),this._createTrack()}static get observedAttributes(){return K.observedAttributes.concat(["highlight","color","shape","filters"])}_getFeatureColor(t){return t.color?t.color:t.feature&&t.feature.color?t.feature.color:this._color?this._color:t.type?pt(t.type):t.feature&&t.feature.type?pt(t.feature.type):"black"}_getFeatureFillColor(t){return t.fill?t.fill:t.feature&&t.feature.fill?t.feature.fill:this._getFeatureColor(t)}_getShape(t){return t.shape?t.shape:t.feature&&t.feature.shape?t.feature.shape:this._shape?this._shape:t.type?dt(t.type):t.feature&&t.feature.type?dt(t.feature.type):"rectangle"}_createTrack(){this._layoutObj.init(this._data),Object(P.l)(this).selectAll("div").remove(),this.svg=Object(P.l)(this).append("div").style("line-height",0).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this.seq_g=this.svg.append("g").attr("class","sequence-features"),this._createFeatures()}_createFeatures(){this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data),this.locations=this.featuresG.enter().append("g").attr("class","feature-group").attr("id",t=>"g_"+t.accession).selectAll("g.location-group").data(t=>t.locations.map(e=>Object.assign({},e,{feature:t}))).enter().append("g").attr("class","location-group");const t=this.locations.selectAll("g.fragment-group").data(t=>t.fragments.map(e=>Object.assign({},e,{feature:t.feature}))).enter().append("g").attr("class","fragment-group");t.append("path").attr("class",t=>this._getShape(t)+" feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill",t=>this._getFeatureFillColor(t)).attr("stroke",t=>this._getFeatureColor(t)).style("fill-opacity",({feature:t})=>t.opacity?t.opacity:.9).style("stroke-opacity",({feature:t})=>t.opacity?t.opacity:.9),t.append("rect").attr("class","outer-rectangle feature").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill","transparent").attr("stroke","transparent").call(this.bindEvents,this)}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(q.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return Object(U.a)(...e)}),n=Object(W.a)(...e);this._data=n}refresh(){if(this.xScale&&this.seq_g){const t=this.seq_g.selectAll("g.fragment-group").data(this._data.reduce((t,e)=>t.concat(e.locations.reduce((t,n)=>t.concat(n.fragments.map(t=>Object.assign({},t,{feature:e}))),[])),[]));t.selectAll("path.feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),t.selectAll("rect.outer-rectangle").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}var gt=ft;class mt extends lt{init(t,e){let n=0;if(this.height={},this.yPos={},this.maxYPos=0,!t)return;this.innerPadding=3;const i={};for(let e=0;e<t.length;e++){const r=t[e];this.height[r.accession]=this.expanded?14:16,this.yPos[r.accession]=this._padding,n=this.height[r.accession]+2*this._padding,this.maxYPos=Math.max(this.maxYPos,n),r.accession in i||(i[r.accession]={}),r.residues&&(n=this._initResidues(r.residues,r.accession,r.locations,this.expanded?n:this.yPos[r.accession],e,i,this.expanded))}if(e)for(let t=0;t<e.length;t++){const r=e[t];r.accession in this.height||(this.height[r.accession]=10,this.yPos[r.accession]=(this.expanded?this.maxYPos:this.innerPadding)+this._padding,n+=2*this._padding+(this.expanded?this.height[r.accession]:0),this.maxYPos=Math.max(this.maxYPos,n)),r.accession in i||(i[r.accession]={}),r.residues&&(n=this._initResidues(r.residues,r.accession,r.locations,r.expanded?n:this.yPos[r.accession],t,i,r.expanded))}this.maxYPos+=this._padding}_initResidues(t,e,n,i,r,a={},o=!0){for(let s=0;s<t.length;s++){const l=t[s];mt._filterOutResidueFragmentsOutOfLocation(l,n),l.accession in a[e]||(a[e][l.accession]={});for(let t=0;t<l.locations.length;t++){const n=l.locations[t].description;n in a[e][l.accession]||(a[e][l.accession][n]={height:o?10:this.height[e]-2*this.innerPadding,yPos:o?this.maxYPos+this._padding:i+this.innerPadding},i=o?this.maxYPos+2*this._padding+10:i),this.height[`${l.accession}_${r}_${s}_${t}`]=a[e][l.accession][n].height,this.yPos[`${l.accession}_${r}_${s}_${t}`]=a[e][l.accession][n].yPos,this.maxYPos=Math.max(this.maxYPos,i)}}return o?i:this.maxYPos+2*this._padding}static _filterOutResidueFragmentsOutOfLocation(t,e){t.locations.forEach(t=>t.fragments=t.fragments.filter(t=>e.some(e=>e.fragments.some(e=>t.start>=e.start&&t.end<=e.end)))),t.locations=t.locations.filter(t=>t.fragments.length)}static _getAccFromFeature(t){let e="";return"string"==typeof t?e=t:t.accession&&(e=t.accession),e}getFeatureYPos(t){const e=mt._getAccFromFeature(t);return e in this.yPos?this.yPos[e]:0}getFeatureHeight(t){const e=mt._getAccFromFeature(t);return e in this.height?this.height[e]:0}}const bt=(t,e)=>{let n={value:1,...t};const i=[];for(const t of e)n?n.end<t.start?(i.push(n),n=null,i.push(t)):n.start<t.start&&n.end>=t.end?(i.push({start:n.start,end:t.start-1,value:n.value}),i.push({start:t.start,end:t.end,value:t.value+n.value}),n=t.end===n.end?null:{start:t.end+1,end:n.end,value:n.value}):t.start<n.start&&t.end>n.end?(i.push({start:t.start,end:n.start-1,value:t.value}),i.push({start:n.start,end:n.end,value:t.value+n.value}),i.push({start:n.end+1,end:t.end,value:t.value}),n=null):t.end>=n.start&&t.end<=n.end?(t.start<n.start&&i.push({start:t.start,end:n.start-1,value:t.value}),i.push({start:n.start,end:t.end,value:t.value+n.value}),n=t.end<n.end?{start:t.end+1,end:n.end,value:n.value}:null):n.end>=t.start&&n.end<t.end?(i.push({start:n.start,end:t.start-1,value:n.value}),i.push({start:t.start,end:n.end,value:t.value+n.value}),i.push({start:n.end+1,end:t.end,value:t.value}),n=null):i.push(t):i.push(t);return n&&i.push(n),i},vt=2;class yt extends gt{_createTrack(){this._layoutObj.expanded=this._expanded,super._createTrack(),this.children_g=null}connectedCallback(){super.connectedCallback(),this._expanded=this.hasAttribute("expanded"),this._haveCreatedFeatures=!1}attributeChangedCallback(t,e,n){if("expanded"===t&&e!==n&&this._contributors)for(const t of this._contributors)t.expanded=!e;super.attributeChangedCallback(t,e,n)}set contributors(t){this._contributors=yt.normalizeLocations(t),this._coverage=((t,e=100,n=!0)=>{let i=[];return n&&(i=bt({start:1,end:e,value:0},i)),t.forEach(t=>t.locations.forEach(t=>t.fragments.forEach(t=>{i=bt(t,i)}))),i})(this._contributors,this._length),this._data&&this._createTrack()}getLayout(){return new mt({layoutHeight:this._height,expanded:this._expanded,padding:2})}static get observedAttributes(){return gt.observedAttributes.concat(["expanded","color"])}set color(t){this._color!==t&&(this._color=t,this.refresh())}static _createResidueGroup(t){return t.selectAll("g.residues-group").data(t=>t.residues?t.residues.map((e,n)=>({...e,feature:t,i:n})):[]).enter().append("g").attr("class","residues-group").selectAll("g.residues-locations").data(t=>t.locations.map((e,n)=>({...e,accession:t.accession,feature:t.feature,location:e,i:t.i,j:n}))).enter().append("g").attr("class","residues-locations")}_createResiduePaths(t){return t.selectAll("g.residue").data(t=>t.fragments.map(e=>({...e,accession:t.accession,feature:{...t.feature,currentResidue:{...e,description:t.location.description}},location:t.location,k:t.feature.k,i:t.i,j:t.j}))).enter().append("path").attr("class","feature rectangle residue").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(`${t.accession}_${t.k}_${t.i}_${t.j}`),t.end?t.end-t.start+1:1,"rectangle")).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${vt+this._layoutObj.getFeatureYPos(`${t.accession}_${t.k}_${t.i}_${t.j}`)})`).attr("fill",t=>this._getFeatureColor(t)).attr("stroke","transparent").call(this.bindEvents,this)}_refreshResiduePaths(t,e){const n=new Set(t.data().map(t=>`${t.feature.accession}-${t.location.description}`)).size;t.attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(`${t.accession}_${t.k}_${t.i}_${t.j}`),t.end?t.end-t.start+1:1,"rectangle")).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${vt+this._layoutObj.getFeatureYPos(`${t.accession}_${t.k}_${t.i}_${t.j}`)})`).style("pointer-events",t=>e||t.feature&&t.feature.expanded?"auto":"none").style("stroke",()=>e?null:"none").style("opacity",()=>e?null:.8/n).attr("fill",t=>e||t.feature&&t.feature.expanded?this._getFeatureColor(t):"white")}static get margin(){return{top:0,right:10,bottom:0,left:10}}_createFeatures(){if(this._layoutObj.init(this._data,this._contributors),this._data.forEach((t,e)=>t.k=e),this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data).enter().append("g").attr("class","feature-group").attr("id",t=>"g_"+t.accession),this.locations=this.featuresG.selectAll("g.location-group").data(t=>t.locations.map(e=>({...e,feature:t}))).enter().append("g").attr("class","location-group"),this.coverLines=this.locations.selectAll("line.cover").data(t=>[t.fragments.reduce((e,n)=>({start:Math.min(e.start,n.start),end:Math.max(e.end,n.end),feature:t.feature}),{start:1/0,end:-1/0})]).enter().append("line").attr("class","cover"),this.features=this.locations.selectAll("path.feature").data(t=>t.fragments.map(e=>({...e,feature:t.feature,fragments:t.fragments}))).enter().append("path").attr("class",t=>this._getShape(t)+" feature").on("click.expanded",()=>{this._expanded?this.removeAttribute("expanded"):this.setAttribute("expanded","expanded")}).call(this.bindEvents,this),this.residues_g=yt._createResidueGroup(this.featuresG),this.residues_loc=this._createResiduePaths(this.residues_g),this._contributors){this._contributors.forEach((t,e)=>t.k=e),this.children_g||(this.children_g=this.svg.append("g").attr("class","children-features")),this.childrenGroup=this.children_g.append("g").attr("class","children-group"),this.childGroup=this.childrenGroup.selectAll("g.child-group").data(this._contributors).enter().append("g").attr("class","child-group");const t=this.childGroup.selectAll("g.child-location-group").data(t=>(t.expanded=this._expanded,t.locations.map(e=>({...e,feature:t})))).enter().append("g").attr("class",(t,e)=>"child-location-group clg-"+e);this.coverLinesChildren=t.selectAll("line.cover").data(t=>[t.fragments.reduce((e,n)=>({start:Math.min(e.start,n.start),end:Math.max(e.end,n.end),feature:t.feature}),{start:1/0,end:-1/0})]).enter().append("line").attr("class","cover"),this.featureChildren=t.selectAll("path.child-fragment").data(t=>t.fragments.map(e=>({...e,feature:t.feature,fragments:t.fragments}))).enter().append("path").attr("class",t=>this._getShape(t)+" child-fragment feature").call(this.bindEvents,this).on("click.expanded",t=>{t.feature.expanded=!t.feature.expanded,this.refresh()}),this.child_residues_g=yt._createResidueGroup(this.childGroup),this.child_residues_loc=this._createResiduePaths(this.child_residues_g),this._coverage&&this._coverage.length&&this._createCoverage()}this.svg.attr("height",this._layoutObj.maxYPos),this._haveCreatedFeatures=!0}_createCoverage(){this._accession=this._data&&this._data[0]&&this._data[0].accession||"_",this.coverage_mask=this.svg.append("defs").append("mask").attr("id","mask-"+this._accession),this.coverageMaskFragment=this.coverage_mask.selectAll("rect").data(this._coverage).enter().append("rect").attr("y",0).attr("height",this._height)}_refreshCoverage(){this.featuresG.attr("mask",this._expanded?null:`url(#mask-${this._accession})`),this.coverageMaskFragment.attr("x",t=>this.getXFromSeqPosition(t.start)).attr("width",t=>this.getSingleBaseWidth()*(t.end-t.start+1)).attr("fill","white").attr("opacity",t=>(t.value/this._contributors.length+.3)/1.3)}_refreshFeatures(t,e=!0){const n=new Set(t.data().map(t=>t.feature.accession)).size;t.attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t.feature),t.end?t.end-t.start+1:1,e?this._getShape(t.shape?t:t.feature):"rectangle")).attr("fill",t=>e?this._getFeatureColor(t.feature):"white").attr("opacity",e?1:.8/n).style("stroke",t=>e?this._getFeatureColor(t.feature):"none").attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${vt+this._layoutObj.getFeatureYPos(t.feature)})`).style("pointer-events",e?"auto":"none")}_refreshCoverLine(t,e=!0){t.attr("x1",t=>this.getXFromSeqPosition(t.start)).attr("x2",t=>this.getXFromSeqPosition(t.end+1)).attr("y1",t=>vt+this._layoutObj.getFeatureYPos(t.feature)+this._layoutObj.getFeatureHeight(t.feature)/2).attr("y2",t=>vt+this._layoutObj.getFeatureYPos(t.feature)+this._layoutObj.getFeatureHeight(t.feature)/2).attr("stroke",t=>this._getFeatureColor(t.feature)).attr("visibility",e?"visible":"hidden")}refresh(){this._haveCreatedFeatures&&(this._layoutObj.expanded=this._expanded,this._layoutObj.init(this._data,this._contributors),this.height=this._layoutObj.maxYPos,this._refreshCoverLine(this.coverLines),this._refreshFeatures(this.features),this._refreshResiduePaths(this.residues_loc,this._expanded),this._contributors&&(this.childrenGroup.attr("visibility",this._expanded?"visible":"hidden"),this._refreshCoverLine(this.coverLinesChildren,this._expanded),this._refreshFeatures(this.featureChildren,this._expanded),this.child_residues_g.attr("visibility",()=>this._expanded?"visible":"hidden"),this._refreshResiduePaths(this.child_residues_loc),this._coverage&&this._coverage.length&&this._refreshCoverage()),this._updateHighlight(),this.svg.attr("height",this._layoutObj.maxYPos))}}var _t=yt;var wt=class extends K{connectedCallback(){super.connectedCallback(),this.sequence=this.getAttribute("sequence"),this.sequence&&this._createSequence(),this.addEventListener("load",t=>{this.data=t.detail.payload})}static get observedAttributes(){return K.observedAttributes.concat("highlightstart","highlightend")}get data(){return this.sequence}set data(t){"string"==typeof t?this.sequence=t:"sequence"in t&&(this.sequence=t.sequence),this.sequence&&!super.svg?this._createSequence():this.refresh()}_getCharSize(){if(!this.seq_g)return;const t=this.seq_g.select("text.base").node();if(t)this.chWidth=.8*t.getBBox().width,this.chHeight=1.6*t.getBBox().height;else{const t=this.seq_g.append("text").attr("class","base").text("T");this.chWidth=.8*t.node().getBBox().width,this.chHeight=1.6*t.node().getBBox().height,t.remove()}}_createSequence(){super.svg=Object(P.l)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",this._height),this.seq_bg=super.svg.append("g").attr("class","background"),this.axis=super.svg.append("g").attr("class","x axis"),this.seq_g=super.svg.append("g").attr("class","sequence").attr("transform",`translate(0,${.75*this._height})`),this.trackHighlighter.appendHighlightTo(this.svg),this.refresh()}refresh(){if(this._getCharSize(),this.axis){const t=this.getSingleBaseWidth(),e=t-this.chWidth,n=t/2,i=Math.round(Math.max(0,this._displaystart-2)),r=Math.round(Math.min(this.sequence.length,this._displayend+1)),a=e<0?[]:this.sequence.slice(i,r).split("").map((t,e)=>({start:1+i+e,end:1+i+e,aa:t}));this.height>this.chHeight&&(this.xAxis=Object(P.a)(this.xScale).tickFormat(t=>Number.isInteger(t)?t:"").ticks(3,"s"),this.axis.call(this.xAxis)),this.axis.attr("transform",`translate(${this.margin.left+n},0)`),this.axis.select(".domain").remove(),this.axis.selectAll(".tick line").remove(),this.bases=this.seq_g.selectAll("text.base").data(a,t=>t.start),this.bases.enter().append("text").attr("class","base").attr("text-anchor","middle").attr("x",t=>this.getXFromSeqPosition(t.start)+n).text(t=>t.aa).style("pointer-events","none").style("font-family","monospace"),this.bases.exit().remove(),this.bases.attr("x",t=>this.getXFromSeqPosition(t.start)+n),this.background=this.seq_bg.selectAll("rect.base_bg").data(a,t=>t.start),this.background.enter().append("rect").attr("class","base_bg feature").attr("height",this._height).merge(this.background).attr("width",t).attr("fill",t=>Math.round(t.start)%2?"#ccc":"#eee").attr("x",t=>this.getXFromSeqPosition(t.start)).call(this.bindEvents,this),this.background.exit().remove(),this.seq_g.style("opacity",Math.min(1,e)),this.background.style("opacity",Math.min(1,e)),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}};var xt=function(t){const{variants:e,sequence:n}=t;if(!n||!e)return null;const i=n.split("").map((t,e)=>({type:"VARIANT",normal:t,pos:e+1,variants:[]}));return e.forEach(t=>{i[t.start-1]&&i[t.start-1].variants.push(t)}),i};var Ct=class{constructor(){this._frequency=Object(P.k)().exponent(.001).domain([0,1]).range([5,10]),this.drawVariationPlot=this.drawVariationPlot.bind(this)}drawVariationPlot(t,e){const n=e.getSingleBaseWidth()/2;t.each((t,i,r)=>{const a=Object(P.l)(r[i]),o=t.filter(t=>0!==t.variants.length),s=a.selectAll("g").data(o,t=>t.pos);s.exit().remove();const l=s.enter().append("g").merge(s).selectAll("circle").data(t=>t.variants);l.exit().remove(),l.enter().append("circle").merge(l).attr("class","feature").attr("title",t=>t.start).attr("r",t=>t.size?t.size:5).attr("cx",t=>e.getXFromSeqPosition(t.start)+n).attr("cy",t=>e._yScale(t.variant.charAt(0))).attr("name",t=>{const e="*"===t.alternativeSequence?"STOP":t.alternativeSequence;return t.internalId=`var_${t.wildType}${t.start}${e}`,t.internalId}).attr("fill",t=>e._colorConfig?e._colorConfig(t):t.color).call(e.bindEvents,e)})}};const Et=["G","A","V","L","I","S","T","C","M","D","N","E","Q","R","K","H","F","Y","W","P","d","*"],St=(t,e)=>{if(!t||t.length<=0)return null;const n=t[0];return n.forEach((n,i)=>{const r=t.map(t=>t[i].variants);n.variants=e(...r)}),n};class Mt extends ot{connectedCallback(){super.connectedCallback();const t=document.createElement("style");t.innerHTML=Mt.css,this.appendChild(t),this._height=Number(this.getAttribute("height"))?Number(this.getAttribute("height")):430,this._width=this._width?this._width:0,this._yScale=Object(P.i)(),this._yScale=Object(P.j)().domain(Et).range([0,this._height-this.margin.top-this.margin.bottom])}processData(t){this._originalData=xt(t)}static get css(){return"\n    <style>\n    protvista-variation {\n      display: flex;\n      width: 100%;\n    }\n    \n    protvista-variation svg {\n      background-color: #fff;\n    }\n    \n    protvista-variation circle {\n      opacity: 0.6;\n    }\n    protvista-variation circle:hover {\n      opacity: 0.9;\n    }\n    protvista-variation .tick line,\n    protvista-variation .axis path {\n      opacity: 0.1;\n    }\n    \n    .protvista-highlight {\n      fill: #ffe999;\n    }\n    \n    protvista-variation .variation-y-right line,\n    protvista-variation .axis path {\n      fill: none;\n      stroke: none;\n    }\n    \n    </style>\n    "}_createFeatures(){this._variationPlot=new Ct;const t=super.svg.select("g.sequence-features"),e=t.attr("transform",`translate(0, ${this.margin.top})`).append("g").attr("clip-path","url(#plotAreaClip)");this._clipPath=t.append("clipPath").attr("id","plotAreaClip").append("rect").attr("width",this.getWidthWithMargins()).attr("height",this._height).attr("transform",`translate(0, -${this.margin.top})`),this._series=e.datum(this._data),this._axisLeft=t.append("g"),this._axisRight=t.append("g"),this.updateScale()}set filters(t){super.filters=t,this.updateData(this._data),this.refresh()}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(q.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return St(e,U.a)});this._data=St(e,W.a)}set colorConfig(t){this._colorConfig=t}get colorConfig(){return this._colorConfig}refresh(){this._series&&(this._clipPath.attr("width",this.getWidthWithMargins()),this.updateScale(),this._series.call(this._variationPlot.drawVariationPlot,this),this._updateHighlight())}updateScale(){this._yAxisLScale=Object(P.b)().scale(this._yScale).tickSize(-this.getWidthWithMargins()),this._yAxisRScale=Object(P.c)().scale(this._yScale),this._axisLeft.attr("class","variation-y-left axis").attr("transform",`translate(${this.margin.left},0)`).call(this._yAxisLScale),this._axisRight.attr("transform",`translate(${this.getWidthWithMargins()-this.margin.right+2}, 0)`).attr("class","variation-y-right axis").call(this._yAxisRScale)}updateData(t){this._series&&this._series.datum(t)}}var At=Mt;class Ot{getFeatureShape(t,e,n,i){return i=i||"rectangle",this._ftLength=n,this._ftHeight=e,this._ftWidth=t*n,"function"!=typeof this["_"+i]&&(i="rectangle"),this["_"+i]()}static isContinuous(t){return"bridge"!==(t=t.toLowerCase())}_rectangle(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+"Z"}_roundRectangle(){return"M6,0h"+(this._ftWidth-12)+",0a6,6 0 0 1 6,6v"+(this._ftHeight-12)+"a6,6 0 0 1 "+"-6,6h"+(12-this._ftWidth)+"a6,6 0 0 1 "+"-6,"+"-6v"+(12-this._ftHeight)+"a6,6 0 0 1 6,"+"-6Z"}_line(){return`M0,${this._ftHeight/2} L${this._ftWidth},${this._ftHeight/2}`}_bridge(){return 1!==this._ftLength?"M0,"+this._ftHeight+"L0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L"+this._ftWidth+",2L0,2Z":"M0,"+this._ftHeight+"L0,"+this._ftHeight/2+"L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth/2+",0L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight+"Z"}_getMiddleLine(t){return"M0,"+t+"L"+this._ftWidth+","+t+"Z"}_diamond(){const t=this._ftWidth/2,e="M"+t+",0L"+(t+5)+",5L"+t+",10L"+(t-5)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth):e+"Z"}_chevron(){const t=this._ftWidth/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+",10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==this._ftLength?e+"L"+t+",5"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_catFace(){const t=this._ftWidth/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+",10L"+(2+t)+",10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==this._ftLength?e+"M"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_triangle(){const t=this._ftWidth/2,e="M"+t+",0L"+(5+t)+",10L"+(-5+t)+",10";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_wave(){const t=this._ftWidth/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getPolygon(t){let e="M ";const n=this._ftWidth/2;for(let i=0;i<t;i++)e+=5*Math.cos(2*Math.PI*i/t)+n+","+(5*Math.sin(2*Math.PI*i/t)+5)+" ";return 1!==this._ftLength?e+" "+(5*Math.cos(0)+n)+","+(5*Math.sin(0)+5)+" "+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_hexagon(){return this._getPolygon(6)}_pentagon(){return this._getPolygon(5)}_circle(){const t=this._ftWidth/2,e=Math.sqrt(10/Math.PI),n="M"+t+",0A"+e+","+e+" 0 1,1 "+t+",10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==this._ftLength?n+this._getMiddleLine(5,this._ftWidth)+"Z":n+"Z"}_arrow(){const t=this._ftWidth/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+this._ftHeight+"L"+t+","+this._ftHeight+"L"+(4+t)+",4";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_doubleBar(){const t=this._ftWidth/2,e="M"+t+",0L"+(-5+t)+",10L"+t+",10L"+(5+t)+",0";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getBrokenEnd(){const t=this._ftHeight/4;return"L"+(this._ftWidth-t)+","+t+"L"+this._ftWidth+","+2*t+"L"+(this._ftWidth-t)+","+3*t+"L"+this._ftWidth+","+this._ftHeight}_getBrokenStart(){const t=this._ftHeight/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t}_discontinuosStart(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuos(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuosEnd(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+"Z"}_helix(){const t=2.5;let e=2.5;const n=Math.round(this._ftWidth/5);let i="";for(let r=0;r<n;r++){i+="M"+(-2.5+e)+","+this._ftHeight+" C"+(e+t)+",7.5 "+(2.5+e)+","+"2.5 "+e+", 0 C"+(e-t)+","+"2.5 "+e+",7.5 "+(2.5+e)+","+this._ftHeight,e+=5}return i}_strand(){let t=0;this._ftWidth>5&&(t=this._ftWidth-5);const e=this._ftHeight/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+("M"+t+",0L"+this._ftWidth+","+2*e+"L"+t+","+this._ftHeight+"Z")}}class kt{constructor({layoutHeight:t,padding:e=1,minHeight:n=17}){this._padding=e,this._minHeight=n,this._layoutHeight=t}init(t){this._features=t}getFeatureYPos(){const t=this.getFeatureHeight();return this._layoutHeight/2-t/2}getFeatureHeight(){return Math.min(this._layoutHeight,this._minHeight)-this._padding}}const Tt=(t,e)=>e.some(e=>{return n=t,i=e,!(Number(i.start)>Number(n.end)||Number(i.end)<Number(n.start));var n,i});class Nt extends kt{constructor(t){super(t),this.featuresMap=new Map,this._rowHeight=0,this._rows=[],this._minHeight=15}init(t){t.forEach(t=>{const e=this._rows.findIndex(e=>!Tt(t,e));e>=0?(this._rows[e].push(t),this.featuresMap.set(t,e)):(this._rows.push([t]),this.featuresMap.set(t,this._rows.length-1))}),this._rowHeight=Math.min(this._layoutHeight/this._rows.length,this._minHeight)}getOffset(){return this._rows.length*this._rowHeight<this._layoutHeight?this._layoutHeight/2-this._rows.length*this._rowHeight/2:0}getFeatureYPos(t){const e=this.featuresMap.get(t);return this.getOffset()+this._rowHeight*e+2*this._padding}getFeatureHeight(){return this._rowHeight-2*this._padding}}const Lt={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},Dt=t=>{if(Lt[t.toUpperCase()])return Lt[t.toUpperCase()].shape;const e=Object.values(Lt).find(e=>e.name.toUpperCase()===t.toUpperCase());return e?e.shape:"rectangle"},It=t=>{if(Lt[t.toUpperCase()])return Lt[t.toUpperCase()].color;const e=Object.values(Lt).find(e=>e.name.toUpperCase()===t.toUpperCase());return e||console.log(t),e?e.color:"black"};class Pt extends K{getLayout(){return"non-overlapping"===String(this.getAttribute("layout")).toLowerCase()?new Nt({layoutHeight:this._height}):new kt({layoutHeight:this._height})}connectedCallback(){super.connectedCallback(),this._color=this.getAttribute("color"),this._shape=this.getAttribute("shape"),this._featureShape=new Ot,this._layoutObj=this.getLayout(),this._data&&this._createTrack(),this.addEventListener("load",t=>{Object($.a)(this.children,t.target)&&(this.data=t.detail.payload)})}static normalizeLocations(t){return t.map(t=>{const{locations:e,start:n,end:i}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:n,end:i}]}]})})}processData(t){this._originalData=Pt.normalizeLocations(t)}set data(t){this.processData(t),this._applyFilters(),this._layoutObj=this.getLayout(),this._createTrack()}set filters(t){this._filters=t,this._applyFilters(),this._createTrack()}static get observedAttributes(){return K.observedAttributes.concat(["highlight","color","shape","filters"])}_getFeatureColor(t){return t.color?t.color:t.feature&&t.feature.color?t.feature.color:this._color?this._color:t.type?It(t.type):t.feature&&t.feature.type?It(t.feature.type):"black"}_getFeatureFillColor(t){return t.fill?t.fill:t.feature&&t.feature.fill?t.feature.fill:this._getFeatureColor(t)}_getShape(t){return t.shape?t.shape:t.feature&&t.feature.shape?t.feature.shape:this._shape?this._shape:t.type?Dt(t.type):t.feature&&t.feature.type?Dt(t.feature.type):"rectangle"}_createTrack(){this._layoutObj.init(this._data),Object(P.l)(this).selectAll("div").remove(),this.svg=Object(P.l)(this).append("div").style("line-height",0).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this.seq_g=this.svg.append("g").attr("class","sequence-features"),this._createFeatures()}_createFeatures(){this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data),this.locations=this.featuresG.enter().append("g").attr("class","feature-group").attr("id",t=>"g_"+t.accession).selectAll("g.location-group").data(t=>t.locations.map(e=>Object.assign({},e,{feature:t}))).enter().append("g").attr("class","location-group");const t=this.locations.selectAll("g.fragment-group").data(t=>t.fragments.map(e=>Object.assign({},e,{feature:t.feature}))).enter().append("g").attr("class","fragment-group");t.append("path").attr("class",t=>this._getShape(t)+" feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill",t=>this._getFeatureFillColor(t)).attr("stroke",t=>this._getFeatureColor(t)).style("fill-opacity",({feature:t})=>t.opacity?t.opacity:.9).style("stroke-opacity",({feature:t})=>t.opacity?t.opacity:.9),t.append("rect").attr("class","outer-rectangle feature").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill","transparent").attr("stroke","transparent").call(this.bindEvents,this)}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(q.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return Object(U.a)(...e)}),n=Object(W.a)(...e);this._data=n}refresh(){if(this.xScale&&this.seq_g){const t=this.seq_g.selectAll("g.fragment-group").data(this._data.reduce((t,e)=>t.concat(e.locations.reduce((t,n)=>t.concat(n.fragments.map(t=>Object.assign({},t,{feature:e}))),[])),[]));t.selectAll("path.feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),t.selectAll("rect.outer-rectangle").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}var jt=Pt;var Rt=class extends jt{constructor(){super(),this._line=Object(P.g)().x((t,e)=>this.getXFromSeqPosition(e+1)-this.getSingleBaseWidth()/2).y(t=>this._yScale(t))}init(){this._totalsArray={total:null,diseaseTotal:null}}connectedCallback(){super.connectedCallback(),this._data=void 0,this._height=Number(this.getAttribute("height"))||40,this._yScale=Object(P.i)(),this.init()}set data(t){if(this.init(),t.sequence&&!(t.variants.length<=0)){this._totalsArray.total=new Uint8ClampedArray(t.sequence.length),this._totalsArray.diseaseTotal=new Uint8ClampedArray(t.sequence.length);for(const{start:e,association:n}of t.variants){const i=+e;if(i<1||i>t.sequence.length)continue;if(this._totalsArray.total[i]++,!n)continue;n.find(t=>!0===t.disease)&&this._totalsArray.diseaseTotal[i]++}this._createTrack()}}_createTrack(){Object(P.l)(this).selectAll("svg").remove(),this.svg=Object(P.l)(this).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this._initYScale(),this.refresh()}_initYScale(){this._yScale.domain([0,Math.max(Object(P.h)(this._totalsArray.total),Object(P.h)(this._totalsArray.diseaseTotal))]).range([this._height,0])}refresh(){this.svg&&(this.svg.selectAll("path").remove(),this.svg.append("path").attr("d",this._line(this._totalsArray.diseaseTotal)).attr("fill","none").attr("stroke","red").attr("transform","translate(0,0)"),this.svg.append("path").attr("d",this._line(this._totalsArray.total)).attr("fill","none").attr("stroke","darkgrey").attr("transform","translate(0,0)"),this._updateHighlight())}};class Ft extends S.a{static get properties(){return{filters:{type:Array},selectedFilters:{type:Set},for:{type:String}}}constructor(){super(),this.filters=[],this.selectedFilters=new Set}connectedCallback(){super.connectedCallback(),this.addEventListener("filterChange",this._onFilterChange),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this))}disconnectedCallback(){super.disconnectedCallback(),this.manager&&this.manager.unregister(this),this.removeEventListener("filterChange",this._onFilterChange)}static get styles(){return S.b`
      :host {
        font-size: 0.8rem;
      }

      :host[disabled] {
        opacity: 0.5;
      }

      .protvista_checkbox {
        position: relative;
        cursor: pointer;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        margin-top: 10px;
        line-height: 24px;
        outline: none;
      }

      .protvista_checkbox_input {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
      }

      .checkmark {
        opacity: 0.4;
        height: 25px;
        width: 25px;
        background-color: #eee;
        border-radius: 4px;
        box-sizing: border-box;
        border: 1px solid #bdc3c7;
      }

      .protvista_checkbox_input:checked ~ .checkmark {
        opacity: 1;
      }

      .protvista_checkbox_label {
        margin-left: 0.2rem;
        line-height: 1rem;
      }
    `}render(){const t=Object(q.a)(this.filters,t=>t.type.text);return S.c`
      ${Object.keys(t).map(e=>S.c`
            <h4>${e}</h4>
            <div>
              ${t[e].map(t=>S.c`
                    ${this.getCheckBox(t)}
                  `)}
            </div>
          `)}
    `}getCheckBox(t){const{name:e,options:n}=t,{labels:i}=n;null==n.colors.length&&(n.colors=[n.colors]);const r=n.colors.length>1;return S.c`
      <label
        class="protvista_checkbox ${r?"compound":""}"
        tabindex="0"
      >
        <input
          type="checkbox"
          class="protvista_checkbox_input"
          ?checked="true"
          .value="${e}"
          @change="${()=>this.toggleFilter(e)}"
        />
        <span
          class="checkmark"
          style=${`background: ${r?`\n            linear-gradient(${n.colors[0]},\n            ${n.colors[1]})\n          `:n.colors[0]};`}
        ></span>
        <span class="protvista_checkbox_label">
          ${i.join("/")}
        </span>
      </label>
    `}toggleFilter(t){this.selectedFilters.has(t)?this.selectedFilters.delete(t):this.selectedFilters.add(t),this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0,detail:{type:"filters",handler:"property",for:this.for,value:this.filters.filter(t=>this.selectedFilters.has(t.name)).map(t=>({category:t.type.name,filterFn:t.filterData}))}}))}}var Bt=Ft;class Ht extends HTMLElement{constructor(){super(),this.protvistaElements=new Set,this.attributeValues=new Map,this.propertyValues=new Map,this.mouseOver=!1}static get observedAttributes(){return["attributes","length","displaystart","displayend","highlight"]}set length(t){this.attributeValues.set("length",t)}get length(){return this.attributeValues.get("length")}set displaystart(t){this.attributeValues.set("displaystart",t)}get displaystart(){return this.attributeValues.get("displaystart")}set displayend(t){this.attributeValues.set("displayend",t)}get displayend(){return this.attributeValues.get("displayend")}set highlight(t){this.attributeValues.set("highlight",t)}get highlight(){return this.attributeValues.get("highlight")}attributeChangedCallback(t,e,n){if(e!==n){if("attributes"===t){if(this._attributes=n.split(" "),-1!==this._attributes.indexOf("type"))throw new Error("'type' can't be used as a protvista attribute");if(-1!==this._attributes.indexOf("value"))throw new Error("'value' can't be used as a protvista attribute");this.attributeValues=new Map(this._attributes.filter(t=>!Ht.observedAttributes.includes(t)).map(t=>[t,null]))}else"length"===t&&(this.length=n),"displaystart"===t&&(this.displaystart=n),"displayend"===t&&(this.displayend=n),"highlight"===t&&(this.highlight=n);this.applyAttributes()}}register(t){this.protvistaElements.add(t),this.applyAttributes()}unregister(t){this.protvistaElements.delete(t)}_polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}applyAttributes(){this.protvistaElements.forEach(t=>{this.attributeValues.forEach((e,n)=>{!1===e||null==e?t.removeAttribute(n):t.setAttribute(n,"boolean"==typeof e?"":e)})})}applyProperties(t){if(t){const e=this.querySelector("#"+t);this.propertyValues.forEach((t,n)=>{e[n]=t})}else this.protvistaElements.forEach(t=>{this.propertyValues.forEach((e,n)=>{t[n]=e})})}isRegisteredAttribute(t){return[...this.attributeValues.keys()].includes(t)||Ht.observedAttributes.includes(t)}_changeListener(t){switch(t.detail.handler){case"property":this.propertyValues.set(t.detail.type,t.detail.value),this.applyProperties(t.detail.for);break;default:this.isRegisteredAttribute(t.detail.type)&&this.attributeValues.set(t.detail.type,t.detail.value),Object.keys(t.detail).forEach(e=>{this.isRegisteredAttribute(e)&&this.attributeValues.set(e,t.detail[e])}),this.applyAttributes()}}connectedCallback(){this.addEventListener("change",this._changeListener)}}var $t=Ht,qt=(n(105),function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))});const Ut=new Map,Wt=(t,e=new Headers({accept:"application/json"}))=>{const n=Ut.get(t);if(n)return n;const i=qt(void 0,void 0,void 0,(function*(){const n=yield window.fetch(t,{headers:e});if(!n.ok)throw new Error(`Request Failed: Status = ${n.status}; URI = ${t}; Time = ${new Date}`);return 204===n.status?{payload:null,headers:n.headers}:{payload:yield n.json(),headers:n.headers}}));return Ut.set(t,i),i.catch(()=>Ut.delete(t)),i};HTMLElement;var zt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Gt=new Uint8Array(16);function Vt(){if(!zt)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zt(Gt)}var Zt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Yt=function(t){return"string"==typeof t&&Zt.test(t)},Xt=[],Kt=0;Kt<256;++Kt)Xt.push((Kt+256).toString(16).substr(1));var Jt,Qt,te=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Xt[t[e+0]]+Xt[t[e+1]]+Xt[t[e+2]]+Xt[t[e+3]]+"-"+Xt[t[e+4]]+Xt[t[e+5]]+"-"+Xt[t[e+6]]+Xt[t[e+7]]+"-"+Xt[t[e+8]]+Xt[t[e+9]]+"-"+Xt[t[e+10]]+Xt[t[e+11]]+Xt[t[e+12]]+Xt[t[e+13]]+Xt[t[e+14]]+Xt[t[e+15]]).toLowerCase();if(!Yt(n))throw TypeError("Stringified UUID is invalid");return n},ee=0,ne=0;var ie=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||Jt,o=void 0!==t.clockseq?t.clockseq:Qt;if(null==a||null==o){var s=t.random||(t.rng||Vt)();null==a&&(a=Jt=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=Qt=16383&(s[6]<<8|s[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:ne+1,u=l-ee+(c-ne)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||l>ee)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ee=l,ne=c,Qt=o;var h=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;var d=l/4294967296*1e4&268435455;r[i++]=d>>>8&255,r[i++]=255&d,r[i++]=d>>>24&15|16,r[i++]=d>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var p=0;p<6;++p)r[i+p]=a[p];return e||te(r)};var re=[{name:"ECO:0000269",description:"Manual assertion based on experiment",shortDescription:"Publication",acronym:"EXP",isManual:!0},{name:"ECO:0000303",description:"Manual assertion based on opinion",shortDescription:"Publication",acronym:"NAS",isManual:!0},{name:"ECO:0000305",description:"Manual assertion inferred by curator",shortDescription:"Curated",acronym:"IC",isManual:!0},{name:"ECO:0000250",description:"Manual assertion inferred from sequence similarity",shortDescription:"By similarity",acronym:"ISS",isManual:!0},{name:"ECO:0000255",description:"Manual assertion according to rules",shortDescription:"Sequence Analysis",acronym:"ISM",isManual:!0},{name:"ECO:0000244",description:"Manual assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXM",isManual:!0},{name:"ECO:0000312",description:"Manual assertion inferred from database entries",shortDescription:"Imported",acronym:"MI",isManual:!0},{name:"ECO:0000256",description:"Automatic assertion according to rules",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000259",description:"Automatic assertion inferred from signature match",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000213",description:"Automatic assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXA"},{name:"ECO:0000313",description:"Automatic assertion inferred from database entries",shortDescription:"Imported",acronym:"AI"}];const ae=t=>t.map(t=>{const e={};return t.begin&&(e.start=t.begin),{...t,...e}}),oe=t=>{const e=(n=t.evidences)?`\n      <ul>${n.map(t=>{const e=re.find(e=>e.name===t.code);return e?`<li title='${e.description}' style="padding: .25rem 0">${e.shortDescription}:&nbsp;${t.source?(n=t.source,n.name.toLowerCase()==="PubMed".toLowerCase()?`${n.id}&nbsp;(<a href='${n.url}' style="color:#FFF" target='_blank'>${n.name}</a>&nbsp;<a href='${n.alternativeUrl}' style="color:#FFF" target='_blank'>EuropePMC</a>)`:`&nbsp;<a href='${n.url}' style="color:#FFF" target='_blank'>${n.id}</a>&nbsp;(${n.name})`):""}</li>`:"";var n}).join("")}</ul>\n    `:"";var n,i;return`\n      ${t.description?`<h5>Description</h5><p>${t.description}</p>`:""}\n      ${t.matchScore?`<h5>Match score</h5><p>${t.matchScore}%</p>`:""}\n      ${t.ftId?`<h5>Feature ID</h5><p>${t.ftId}</p>`:""}\n      ${t.alternativeSequence?`<h5>Alternative sequence</h5><p>${t.alternativeSequence}</p>`:""}\n      ${e?"<h5>Evidence</h5>"+e:""}\n      ${t.xrefs?"<h5>Cross-references</h5>"+(i=t.xrefs,`<ul>${i.map(t=>`<li style="padding: .25rem 0">${t.name} ${t.url?`<a href="${t.url}" style="color:#FFF" target="_blank">${t.id}</a>`:`${t.name} ${t.id}`}</li>`).join("")}</ul>`):""}\n        `},se=t=>{let e=[];const{features:n}=t;return n&&n.length>0&&(e=n.map(t=>({...t,tooltipContent:oe(t),protvistaFeatureId:ie()})),e=ae(e)),e};HTMLElement;var le="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),ce=new Uint8Array(16);function ue(){if(!le)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return le(ce)}var he=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var de=function(t){return"string"==typeof t&&he.test(t)},pe=[],fe=0;fe<256;++fe)pe.push((fe+256).toString(16).substr(1));var ge,me,be=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(pe[t[e+0]]+pe[t[e+1]]+pe[t[e+2]]+pe[t[e+3]]+"-"+pe[t[e+4]]+pe[t[e+5]]+"-"+pe[t[e+6]]+pe[t[e+7]]+"-"+pe[t[e+8]]+pe[t[e+9]]+"-"+pe[t[e+10]]+pe[t[e+11]]+pe[t[e+12]]+pe[t[e+13]]+pe[t[e+14]]+pe[t[e+15]]).toLowerCase();if(!de(n))throw TypeError("Stringified UUID is invalid");return n},ve=0,ye=0;var _e=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||ge,o=void 0!==t.clockseq?t.clockseq:me;if(null==a||null==o){var s=t.random||(t.rng||ue)();null==a&&(a=ge=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=me=16383&(s[6]<<8|s[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:ye+1,u=l-ve+(c-ye)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||l>ve)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ve=l,ye=c,me=o;var h=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;var d=l/4294967296*1e4&268435455;r[i++]=d>>>8&255,r[i++]=255&d,r[i++]=d>>>24&15|16,r[i++]=d>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var p=0;p<6;++p)r[i+p]=a[p];return e||be(r)};const we=t=>{let e=[];return t&&0!==t.length&&(e=t.features.map(t=>Object.assign(t,{category:"PROTEOMICS",type:t.unique?"unique":"non_unique",tooltipContent:oe(t),protvistaFeatureId:_e()})),e=ae(e)),e};var xe="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Ce=new Uint8Array(16);function Ee(){if(!xe)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xe(Ce)}var Se=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Me=function(t){return"string"==typeof t&&Se.test(t)},Ae=[],Oe=0;Oe<256;++Oe)Ae.push((Oe+256).toString(16).substr(1));var ke,Te,Ne=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Ae[t[e+0]]+Ae[t[e+1]]+Ae[t[e+2]]+Ae[t[e+3]]+"-"+Ae[t[e+4]]+Ae[t[e+5]]+"-"+Ae[t[e+6]]+Ae[t[e+7]]+"-"+Ae[t[e+8]]+Ae[t[e+9]]+"-"+Ae[t[e+10]]+Ae[t[e+11]]+Ae[t[e+12]]+Ae[t[e+13]]+Ae[t[e+14]]+Ae[t[e+15]]).toLowerCase();if(!Me(n))throw TypeError("Stringified UUID is invalid");return n},Le=0,De=0;var Ie=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||ke,o=void 0!==t.clockseq?t.clockseq:Te;if(null==a||null==o){var s=t.random||(t.rng||Ee)();null==a&&(a=ke=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=Te=16383&(s[6]<<8|s[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:De+1,u=l-Le+(c-De)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||l>Le)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Le=l,De=c,Te=o;var h=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;var d=l/4294967296*1e4&268435455;r[i++]=d>>>8&255,r[i++]=255&d,r[i++]=d>>>24&15|16,r[i++]=d>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var p=0;p<6;++p)r[i+p]=a[p];return e||Ne(r)};const Pe=t=>{let e=[];if(t&&0!==t.length){e=(t=>{if(!t||t.length<=0)return[];const e=t.sort((t,e)=>t.start-e.start),n=[];return e.forEach(t=>{const e=n[n.length-1];!e||e.end<t.start?n.push(t):e.end<t.end?(e.end=t.end,e.structures.push(t.structures[0])):e.structures.push(t.structures[0])}),n})((t=>t.dbReferences.filter(t=>"PDB"===t.type).map(t=>{const e=t.properties.chains?(t=>{const e=t.indexOf("="),n=t.indexOf("-");return-1===e||-1===n?{start:0,end:0}:{start:+t.slice(e+1,n),end:+t.slice(n+1)}})(t.properties.chains):{start:0,end:0};return{type:"PDBE_COVER",category:"STRUCTURE_COVERAGE",structures:[{description:(n=t.properties,Object.keys(n).reduce((t,e)=>{return`${t}${i=e,i.charAt(0).toUpperCase()+i.slice(1)}: ${n[e]}. `;var i},"")),start:e.start,end:e.end,source:{id:t.id,url:"http://www.ebi.ac.uk/pdbe-srv/view/entry/"+t.id}}],start:e.start,end:e.end};var n}))(t)),e.forEach(t=>{t.tooltipContent=(t=>{const e=`<ul>\n            ${t.structures.map(t=>`<li style="margin: 0.25rem 0"><a style="color:#FFF" href='${t.source.url}' target='_blank'>\n            ${t.source.id}\n        </a> (${t.start}-${t.end})</li>`).join("")}\n        </ul>`;return""+(e?"<h5>Structures</h5>"+e:"")})(t),t.protvistaFeatureId=Ie()})}return e};var je,Re=new Uint8Array(16);function Fe(){if(!je&&!(je="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return je(Re)}var Be=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var He=function(t){return"string"==typeof t&&Be.test(t)},$e=[],qe=0;qe<256;++qe)$e.push((qe+256).toString(16).substr(1));var Ue,We,ze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=($e[t[e+0]]+$e[t[e+1]]+$e[t[e+2]]+$e[t[e+3]]+"-"+$e[t[e+4]]+$e[t[e+5]]+"-"+$e[t[e+6]]+$e[t[e+7]]+"-"+$e[t[e+8]]+$e[t[e+9]]+"-"+$e[t[e+10]]+$e[t[e+11]]+$e[t[e+12]]+$e[t[e+13]]+$e[t[e+14]]+$e[t[e+15]]).toLowerCase();if(!He(n))throw TypeError("Stringified UUID is invalid");return n},Ge=0,Ve=0;var Ze=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||Ue,o=void 0!==t.clockseq?t.clockseq:We;if(null==a||null==o){var s=t.random||(t.rng||Fe)();null==a&&(a=Ue=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=We=16383&(s[6]<<8|s[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:Ve+1,u=l-Ge+(c-Ve)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||l>Ge)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ge=l,Ve=c,We=o;var h=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;var d=l/4294967296*1e4&268435455;r[i++]=d>>>8&255,r[i++]=255&d,r[i++]=d>>>24&15|16,r[i++]=d>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var p=0;p<6;++p)r[i+p]=a[p];return e||ze(r)};var Ye=[{name:"ECO:0000269",description:"Manual assertion based on experiment",shortDescription:"Publication",acronym:"EXP",isManual:!0},{name:"ECO:0000303",description:"Manual assertion based on opinion",shortDescription:"Publication",acronym:"NAS",isManual:!0},{name:"ECO:0000305",description:"Manual assertion inferred by curator",shortDescription:"Curated",acronym:"IC",isManual:!0},{name:"ECO:0000250",description:"Manual assertion inferred from sequence similarity",shortDescription:"By similarity",acronym:"ISS",isManual:!0},{name:"ECO:0000255",description:"Manual assertion according to rules",shortDescription:"Sequence Analysis",acronym:"ISM",isManual:!0},{name:"ECO:0000244",description:"Manual assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXM",isManual:!0},{name:"ECO:0000312",description:"Manual assertion inferred from database entries",shortDescription:"Imported",acronym:"MI",isManual:!0},{name:"ECO:0000256",description:"Automatic assertion according to rules",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000259",description:"Automatic assertion inferred from signature match",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000213",description:"Automatic assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXA"},{name:"ECO:0000313",description:"Automatic assertion inferred from database entries",shortDescription:"Imported",acronym:"AI"}];const Xe=t=>t?`\n      <ul>${t.map(t=>{const e=Ye.find(e=>e.name===t.code);return e?`<li title='${e.description}' style="padding: .25rem 0">${e.shortDescription}:&nbsp;${t.source?(n=t.source,n.name.toLowerCase()==="PubMed".toLowerCase()?`${n.id}&nbsp;(<a href='${n.url}' style="color:#FFF" target='_blank'>${n.name}</a>&nbsp;<a href='${n.alternativeUrl}' style="color:#FFF" target='_blank'>EuropePMC</a>)`:`&nbsp;<a href='${n.url}' style="color:#FFF" target='_blank'>${n.id}</a>&nbsp;(${n.name})`):""}</li>`:"";var n}).join("")}</ul>\n    `:"",Ke=t=>`<ul>${t.map(t=>`<li style="padding: .25rem 0">${t.name} ${t.url?`<a href="${t.url}" style="color:#FFF" target="_blank">${t.id}</a>`:`${t.name} ${t.id}`}</li>`).join("")}</ul>`;HTMLElement;var Je=t=>{return`\n                <h5>Variant</h5><p>${t.wildType} > ${t.alternativeSequence}</p>\n                ${t.populationFrequencies?(i=t.populationFrequencies,"<hr/><h5>Population frequencies</h5>"+i.map(t=>`<p>${t.frequency} - ${t.populationName} (${t.source})</p>`).join("")):""}\n                ${t.consequenceType?`<h5>Consequence</h5><p>${t.consequenceType}</p>`:""}\n                ${t.somaticStatus?`<h5>Somatic</h5><p>${0===t.somaticStatus?"No":"Yes"}</p>`:""}\n                ${t.genomicLocation?`<h5>Location</h5><p>${t.genomicLocation}</p>`:""}\n                ${t.ftId?`<h5>Feature ID</h5><p>${t.ftId}</p>`:""}\n                ${t.descriptions?(n=t.descriptions,`<hr/><h5>Description</h5>${n.map(t=>`<p>${t.value}</p>`).join("")}\n  `):""}\n                ${t.association?(e=t.association,null==e?void 0:e.map(t=>`\n              <h4>Disease association</h4><p>${t.name}</p>\n              ${t.description?`<>${t.description}</p>`:""}\n              ${t.dbReferences?"<h5>Cross-references</h5>"+Ke(t.dbReferences):""}\n              ${Xe(t.evidences)}\n          `).join("")):""}\n                ${t.predictions?(t=>{const e=Object(q.a)(t,"predAlgorithmNameType");return Object.keys(e).map(t=>{const n=Object(q.a)(e[t],"predictionValType");return{algorithm:t,values:Object.keys(n).map(t=>({name:t,count:n[t].length}))}}).map(t=>`<h6>${t.algorithm}</h6><ul class="no-bullet">${t.values.map(t=>`<li>${t.name}</li>`).join("")}</ul>`).join("")})(t.predictions):""}\n                ${(t=>{if(t.locations.some(t=>"EnsemblViruses"===t.source)){const e=t.xrefs.find(t=>"ENA"===t.name);return e.id?`<h5>Ensembl COVID-19</h5>\n          <p>\n          <a href="https://covid-19.ensembl.org/Sars_cov_2/Variation/Explore?v=${e.id}" target="_blank" rel="noopener noreferrer">${e.id}</a>\n        </p>`:""}return""})(t)}\n                \n        `;var e,n,i};const Qe=(t,e)=>{const n=t?t.map(t=>t.name):[];return"uniprot"!==e&&"mixed"!==e||n.push("uniprot"),n},tn=t=>{const{sequence:e,features:n}=t,i=n.map(t=>Object.assign(Object.assign({},t),{accession:t.genomicLocation,variant:t.alternativeSequence?t.alternativeSequence:"-",start:t.begin,xrefNames:Qe(t.xrefs,t.sourceType),hasPredictions:t.predictions&&t.predictions.length>0,tooltipContent:Je(t),protvistaFeatureId:Ze()}));return i?{sequence:e,variants:i}:null};const en=t=>{try{return t.results.map(({metadata:t,proteins:e})=>({...t,locations:e[0].entry_protein_locations,start:Math.min(...e[0].entry_protein_locations.map(t=>Math.min(...t.fragments.map(t=>t.start)))),end:Math.max(...e[0].entry_protein_locations.map(t=>Math.max(...t.fragments.map(t=>t.end)))),tooltipContent:`\n        <h5>Accession</h5>\n        <a\n          target="_blank"\n          rel="noopener"\n          href="https://www.ebi.ac.uk/interpro/entry/InterPro/${t.accession}/"\n        >\n        ${t.accession}\n        </a>\n        <h5>Name</h5>\n        <p>${t.name}</p>\n      `,length:e[0].protein_length}))}catch(t){throw new Error("Failed transforming the data")}};HTMLElement;var nn=n(366),rn=n(295),an=n.n(rn),on="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==on&&on,sn="URLSearchParams"in on,ln="Symbol"in on&&"iterator"in Symbol,cn="FileReader"in on&&"Blob"in on&&function(){try{return new Blob,!0}catch(t){return!1}}(),un="FormData"in on,hn="ArrayBuffer"in on;if(hn)var dn=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],pn=ArrayBuffer.isView||function(t){return t&&dn.indexOf(Object.prototype.toString.call(t))>-1};function fn(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function gn(t){return"string"!=typeof t&&(t=String(t)),t}function mn(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return ln&&(e[Symbol.iterator]=function(){return e}),e}function bn(t){this.map={},t instanceof bn?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function vn(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function yn(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function _n(t){var e=new FileReader,n=yn(e);return e.readAsArrayBuffer(t),n}function wn(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function xn(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:cn&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:un&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:sn&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():hn&&cn&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=wn(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):hn&&(ArrayBuffer.prototype.isPrototypeOf(t)||pn(t))?this._bodyArrayBuffer=wn(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):sn&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},cn&&(this.blob=function(){var t=vn(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=vn(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(_n)}),this.text=function(){var t,e,n,i=vn(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=yn(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},un&&(this.formData=function(){return this.text().then(Sn)}),this.json=function(){return this.text().then(JSON.parse)},this}bn.prototype.append=function(t,e){t=fn(t),e=gn(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},bn.prototype.delete=function(t){delete this.map[fn(t)]},bn.prototype.get=function(t){return t=fn(t),this.has(t)?this.map[t]:null},bn.prototype.has=function(t){return this.map.hasOwnProperty(fn(t))},bn.prototype.set=function(t,e){this.map[fn(t)]=gn(e)},bn.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},bn.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),mn(t)},bn.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),mn(t)},bn.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),mn(t)},ln&&(bn.prototype[Symbol.iterator]=bn.prototype.entries);var Cn=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function En(t,e){if(!(this instanceof En))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,r=(e=e||{}).body;if(t instanceof En){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new bn(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new bn(e.headers)),this.method=(n=e.method||this.method||"GET",i=n.toUpperCase(),Cn.indexOf(i)>-1?i:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var a=/([?&])_=[^&]*/;if(a.test(this.url))this.url=this.url.replace(a,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function Sn(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}})),e}function Mn(t,e){if(!(this instanceof Mn))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new bn(e.headers),this.url=e.url||"",this._initBody(t)}En.prototype.clone=function(){return new En(this,{body:this._bodyInit})},xn.call(En.prototype),xn.call(Mn.prototype),Mn.prototype.clone=function(){return new Mn(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new bn(this.headers),url:this.url})},Mn.error=function(){var t=new Mn(null,{status:0,statusText:""});return t.type="error",t};var An=[301,302,303,307,308];Mn.redirect=function(t,e){if(-1===An.indexOf(e))throw new RangeError("Invalid status code");return new Mn(null,{status:e,headers:{location:t}})};var On=on.DOMException;try{new On}catch(t){(On=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),On.prototype.constructor=On}function kn(t,e){return new Promise((function(n,i){var r=new En(t,e);if(r.signal&&r.signal.aborted)return i(new On("Aborted","AbortError"));var a=new XMLHttpRequest;function o(){a.abort()}a.onload=function(){var t,e,i={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new bn,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}})),e)};i.url="responseURL"in a?a.responseURL:i.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;setTimeout((function(){n(new Mn(r,i))}),0)},a.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.onabort=function(){setTimeout((function(){i(new On("Aborted","AbortError"))}),0)},a.open(r.method,function(t){try{return""===t&&on.location.href?on.location.href:t}catch(e){return t}}(r.url),!0),"include"===r.credentials?a.withCredentials=!0:"omit"===r.credentials&&(a.withCredentials=!1),"responseType"in a&&(cn?a.responseType="blob":hn&&r.headers.get("Content-Type")&&-1!==r.headers.get("Content-Type").indexOf("application/octet-stream")&&(a.responseType="arraybuffer")),!e||"object"!=typeof e.headers||e.headers instanceof bn?r.headers.forEach((function(t,e){a.setRequestHeader(e,t)})):Object.getOwnPropertyNames(e.headers).forEach((function(t){a.setRequestHeader(t,gn(e.headers[t]))})),r.signal&&(r.signal.addEventListener("abort",o),a.onreadystatechange=function(){4===a.readyState&&r.signal.removeEventListener("abort",o)}),a.send(void 0===r._bodyInit?null:r._bodyInit)}))}kn.polyfill=!0,on.fetch||(on.fetch=kn,on.Headers=bn,on.Request=En,on.Response=Mn);var Tn=n(296),Nn=n.n(Tn);class Ln extends HTMLElement{constructor(){super(),this._mappings=[],this.loadMolecule=this.loadMolecule.bind(this),this._planHighlight=this._planHighlight.bind(this),this.propagateHighlight=this.propagateHighlight.bind(this)}get css(){return`\n    :root {\n      --blue: 0, 112, 155;\n    }\n  \n    protvista-structure h4 {\n      display: inline;\n      margin-right: 1em;\n    }\n      \n    .litemol-container {\n      position: relative;\n      height: ${this._height};\n    }\n\n    .lm-viewport-controls {\n      display: ${this.hideViewportControls?"none":"block"};\n    }\n    `}get accession(){return this._accession}set accession(t){return this.setAttribute("accession",t),this._accession}get pdbId(){return this._pdbID}set pdbId(t){this.setAttribute("pdbid",t),this._pdbID=t}get height(){return this.getAttribute("height")}get hideViewportControls(){return this.getAttribute("hide-viewport-controls")}connectedCallback(){this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._pdbId=this.getAttribute("pdb-id"),this._accession=this.getAttribute("accession"),this._height=this.getAttribute("height")||"480px",this._highlight=this.getAttribute("highlight")&&Ln._formatHighlight(this.getAttribute("highlight"));const t=document.createElement("style");t.innerHTML=this.css,this.appendChild(t);const e=document.createElement("div");e.className="litemol-container",e.id="litemol-instance",this.messageContainer=document.createElement("span"),this.appendChild(this.messageContainer),this.appendChild(e),this.loadLiteMol()}disconnectedCallback(){this.manager&&this.manager.unregister(this)}static get observedAttributes(){return["highlight","pdb-id","height"]}static _formatHighlight(t){if(!t)return[];return t.split(",").map(t=>{const[e,n]=t.split(":");return{start:Number(e),end:Number(n)}})}attributeChangedCallback(t,e,n){if(e!==n){const e=parseFloat(n);switch(this["_"+t]="number"==typeof e?n:e,t){case"pdb-id":this._pdbId=n,this.selectMolecule(this._pdbId);break;case"accession":this._accession=n;break;case"highlight":this._highlight=Ln._formatHighlight(this.getAttribute("highlight"));break;case"height":this._height=n}this._planHighlight(!0)}}_planHighlight(){this._plannedRender||(this._plannedRender=!0,requestAnimationFrame(()=>{this._plannedRender=!1,this._selectedMolecule&&this.highlightChain()}))}async loadPDBEntry(t){try{const e=await fetch("https://www.ebi.ac.uk/pdbe/api/mappings/uniprot/"+t);return await e.json()}catch(t){throw this.addMessage("Couldn't load PDB entry"),new Error(t)}}async selectMolecule(t){const e=await this.loadPDBEntry(t),n=this.processMapping(e);await this.loadMolecule(t),this._selectedMolecule={id:t,mappings:n},this._planHighlight()}loadLiteMol(){const{Plugin:t}=Nn.a;this.Command=Nn.a.Bootstrap.Command,this.Query=Nn.a.Core.Structure.Query,this.Bootstrap=Nn.a.Bootstrap,this.Core=Nn.a.Core,this.Tree=this.Bootstrap.Tree,this.CoreVis=Nn.a.Visualization,this.Transformer=this.Bootstrap.Entity.Transformer,this.Visualization=this.Bootstrap.Visualization,this.Event=this.Bootstrap.Event,this.Context=t.Components.Context,this._liteMol=t.create({target:this.querySelector("#litemol-instance"),viewportBackground:"#fff",layoutState:{hideControls:!0},allowAnalytics:!1}),this.Event.Molecule.ModelSelect.getStream(this._liteMol.context).subscribe(t=>this.propagateHighlight(t))}loadMolecule(t){this._liteMol.clear();const e=this._liteMol.createTransform();return e.add(this._liteMol.root,this.Transformer.Data.Download,{url:`https://www.ebi.ac.uk/pdbe/coordinates/${t.toLowerCase()}/full?encoding=BCIF`,type:"Binary",_id:t}).then(this.Transformer.Data.ParseBinaryCif,{id:t},{isBinding:!0,ref:"cifDict"}).then(this.Transformer.Molecule.CreateFromMmCif,{blockIndex:0},{isBinding:!0}).then(this.Transformer.Molecule.CreateModel,{modelIndex:0},{isBinding:!1,ref:"model"}).then(this.Transformer.Molecule.CreateMacromoleculeVisual,{polymer:!0,polymerRef:"polymer-visual",het:!0,water:!0}),this._liteMol.applyTransform(e)}getTheme(){const t=new Map;return t.set("Uniform",this.CoreVis.Color.fromRgb(207,178,178)),t.set("Selection",this.CoreVis.Color.fromRgb(255,0,0)),t.set("Highlight",this.CoreVis.Theme.Default.HighlightColor),this.Visualization.Molecule.uniformThemeProvider(void 0,{colors:t})}addMessage(t){this.removeMessage(),this._liteMol.command(this.Bootstrap.Command.Toast.Show,{key:"UPMessage",message:t,timeoutMs:3e4})}removeMessage(){this._liteMol.command(this.Bootstrap.Command.Toast.Hide,{key:"UPMessage"})}processMapping(t){return Object.values(t)[0].UniProt[this._accession]?Object.values(t)[0].UniProt[this._accession].mappings:null}translatePositions(t,e,n="UP_PDB"){if("string"==typeof this.highlight||Number.isNaN(t)||Number.isNaN(e))return null;for(const i of this._selectedMolecule.mappings)if(i.unp_end-i.unp_start==i.end.residue_number-i.start.residue_number){if("UP_PDB"===n&&t>=i.unp_start&&e<=i.unp_end||"PDB_UP"===n&&t>=i.start.residue_number&&e<=i.end.residue_number){const r=i.unp_start-i.start.residue_number;return{entity:i.entity_id,chain:i.chain_id,start:"UP_PDB"===n?t-r:t+r,end:"UP_PDB"===n?e-r:e+r}}}else this.addMessage("Mismatch between protein sequence and structure residues");return null}propagateHighlight(t){if(!t.data||!t.data.residues)return;const e=t.data.residues.map(t=>this.translatePositions(t.seqNumber,t.seqNumber,"PDB_UP")).map(t=>`${t.start}:${t.end}`),n=new CustomEvent("change",{detail:{highlight:e.join(",")},bubbles:!0,cancelable:!0});this.dispatchEvent(n)}highlightChain(){if(!this._highlight)return;this.Command.Visual.ResetTheme.dispatch(this._liteMol.context,void 0),this.Command.Tree.RemoveNode.dispatch(this._liteMol.context,"sequence-selection");const t=this._liteMol.context.select("polymer-visual")[0];if(!t)return;const e=this._highlight.map(({start:t,end:e})=>this.translatePositions(t,e)).filter(t=>t);if(!e||0===e.length)return;const n=e.map(t=>this.Query.sequence(t.entity.toString(),t.chain,{seqNumber:t.start},{seqNumber:t.end})),i=this.getTheme(),r=this._liteMol.createTransform();n.forEach(e=>r.add(t,this.Transformer.Molecule.CreateSelectionFromQuery,{query:e},{ref:"sequence-selection"})),this._liteMol.applyTransform(r).then(()=>{this.Command.Visual.UpdateBasicTheme.dispatch(this._liteMol.context,{visual:t,theme:i})}),this.removeMessage()}}var Dn=Ln,In="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Pn=new Uint8Array(16);function jn(){if(!In)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return In(Pn)}var Rn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Fn=function(t){return"string"==typeof t&&Rn.test(t)},Bn=[],Hn=0;Hn<256;++Hn)Bn.push((Hn+256).toString(16).substr(1));var $n,qn,Un=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Bn[t[e+0]]+Bn[t[e+1]]+Bn[t[e+2]]+Bn[t[e+3]]+"-"+Bn[t[e+4]]+Bn[t[e+5]]+"-"+Bn[t[e+6]]+Bn[t[e+7]]+"-"+Bn[t[e+8]]+Bn[t[e+9]]+"-"+Bn[t[e+10]]+Bn[t[e+11]]+Bn[t[e+12]]+Bn[t[e+13]]+Bn[t[e+14]]+Bn[t[e+15]]).toLowerCase();if(!Fn(n))throw TypeError("Stringified UUID is invalid");return n},Wn=0,zn=0;var Gn=function(t,e,n){var i=e&&n||0,r=e||new Array(16),a=(t=t||{}).node||$n,o=void 0!==t.clockseq?t.clockseq:qn;if(null==a||null==o){var s=t.random||(t.rng||jn)();null==a&&(a=$n=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=qn=16383&(s[6]<<8|s[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:zn+1,u=l-Wn+(c-zn)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||l>Wn)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Wn=l,zn=c,qn=o;var h=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;var d=l/4294967296*1e4&268435455;r[i++]=d>>>8&255,r[i++]=255&d,r[i++]=d>>>24&15|16,r[i++]=d>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var p=0;p<6;++p)r[i+p]=a[p];return e||Un(r)};const Vn=class{constructor(t){this.element=t,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null}setElementScrollable(t){this.element.setAttribute("scrollable",t)}startResetScrollableTimer(){this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout(()=>{this.setElementScrollable(!0),this.resetScrollableTimeout=null},400)}blockScroll(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}isWheelEventInsideElement(t,e){const{height:n,width:i,x:r,y:a}=this.element.getBoundingClientRect();return t>r&&e<r+i&&e>a&&e<a+n}wheel({x:t,y:e,timeStamp:n}){this.isWheelEventInsideElement(t,e)?n<this.timeStampWheelOutside+400?this.blockScroll(n):this.setElementScrollable(!0):this.blockScroll(n)}};var Zn=S.b`
  :host {
    display: block;
  }
  .protvista-datatable-container {
    overflow-y: auto;
    // Note: overflow-x was set to 'hidden' but changing
    // to 'auto' doesn't seem to be an issue.
    overflow-x: auto;
  }

  :host([scrollable="true"]) .protvista-datatable-container {
    overflow-y: auto;
    will-change: scroll;
  }

  :host([scrollable="false"]) .protvista-datatable-container {
    overflow-y: hidden;
  }

  table {
    width: 100%;
    padding: 0;
    margin: 0;
    border-spacing: 0;
  }

  th {
    position: sticky;
    position: -webkit-sticky;
    position: -moz-sticky;
    position: -ms-sticky;
    position: -o-sticky;
    text-align: left;
    background-color: var(--protvista-datable__header-background, #fff);
    color: var(--protvista-datable__header-text, #393b42);
    text-overflow: ellipsis;
    top: 0;
  }

  td,
  th {
    padding: 1rem;
    border-bottom: 1px solid #c2c4c4;
  }

  tr:hover:not(.active):not(.child-row) {
    background-color: var(--protvista-datatable__hover, #f1f1f1);
  }

  td {
    cursor: pointer;
  }

  .withChildren:before {
    display: inline-block;
    font-family: "Courier New", Courier, monospace;
    width: 1rem;
    text-align: center;
    border-radius: 1rem;
    line-height: 1rem;
    font-weight: 700;
    font-size: 1rem;
    color: white;
    border: 2px solid white;
    background-color: var(--protvista-datatable__childToggle, #00639a);
  }

  .plus:before {
    content: "+";
  }

  .minus:before {
    content: "-";
  }

  td:nth-child(1) {
    border-left: 0.5rem solid transparent;
  }

  .overlapped td:nth-child(1) {
    border-left: 0.5rem solid
      var(--protvista-datatable__overlapped, rgba(255, 0, 0, 0.8));
  }

  .active {
    background-color: var(
      --protvista-datatable__active,
      rgba(255, 235, 59, 0.3)
    ) !important;
  }
  .hidden {
    opacity: 0.2;
  }
  .evidence-tag {
    cursor: pointer;
    font-size: 80%;
    white-space: nowrap;
    margin-left: 0.5rem;
    border-radius: 0.5rem;
    background-color: #f1f1f1;
    padding: 0.25rem 0.5rem;
    color: #3a343a;
  }
  .evidence-tag__label {
    padding-left: 0.25rem;
    text-transform: capitalize;
  }
  .svg-colour-reviewed {
    fill: #c39b00;
  }
  .svg-colour-unreviewed {
    fill: #c0c0c0;
  }

  .protvista-datatable__child-item {
    display: flex;
  }

  .protvista-datatable__child-item__title {
    font-weight: 700;
    flex-basis: 10vw;
    flex-grow: 0;
    margin-right: 1rem;
  }

  .protvista-datatable__child-item__content {
  }

  .odd {
    background-color: var(--protvista-datatable__odd, #e4e8eb);
  }

  .even {
    background-color: var(--protvista-datatable__even, #fff);
  }
`;class Yn extends S.a{constructor(){super(),this.height=25,this.visibleChildren=[],this.noScrollToRow=!1,this.noDeselect=!1,this.eventHandler=this.eventHandler.bind(this),this.scrollFilter=new Vn(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){super.connectedCallback(),this.addEventListener("load",t=>{Array.from(this.children).includes(t.target)&&(this.data=Yn.processData(t.detail.payload.features))}),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this.noDeselect||document.addEventListener("click",this.eventHandler),this.classList.add("feature"),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){super.disconnectedCallback(),this.manager&&this.manager.unregister(this),document.removeEventListener("click",this.eventHandler),document.removeEventListener("wheel",this.wheelListener)}set data(t){const e=this._data;this._data=Yn.processData(t),this.requestUpdate("data",e)}get data(){return this._data}eventHandler(t){t.target.closest("protvista-datatable")||t.target.closest(".feature")||(this.selectedid=null)}static get properties(){return{data:{type:Object},highlight:{converter:t=>t&&"null"!==t?t.split(":").map(t=>Number(t)):null},height:{type:Number},columns:{type:Object},displayStart:{type:Number},displayEnd:{type:Number},visibleChildren:{type:Array},selectedid:{type:String},rowClickEvent:{type:Function},noScrollToRow:{type:Boolean},noDeselect:{type:Boolean}}}static get styles(){return Zn}static processData(t){return t.map(t=>({...t,start:t.start?t.start:t.begin})).sort((t,e)=>t.start-e.start).map(t=>({...t,protvistaFeatureId:t.protvistaFeatureId||Gn()}))}static isWithinRange(t,e,n,i){return!n&&e===Number(i)||!i&&t===Number(n)||t<=n&&e>=i}static isOutside(t,e,n,i){return t>i||e<n}handleClick(t,e){if(!t.target.parentNode)return;const{start:n,end:i}=e,r="function"==typeof this.rowClickEvent&&this.rowClickEvent(e)||{};this.selectedid=t.target.parentNode.dataset.id,n&&i&&(r.highlight=`${n}:${i}`),this.dispatchEvent(new CustomEvent("change",{detail:r,bubbles:!0,cancelable:!0}))}getStyleClass(t,e,n){let i="";return this.selectedid&&this.selectedid===t&&(i+=" active"),this.displayStart&&this.displayEnd&&Yn.isOutside(this.displayStart,this.displayEnd,e,n)&&(i+=" hidden"),this.highlight&&Yn.isWithinRange(this.highlight[0],this.highlight[1],e,n)&&(i+=" overlapped"),i}hasChildData(t,e){return t.some(t=>this.columns[t].resolver(e))}toggleVisibleChild(t){this.visibleChildren.includes(t)?this.visibleChildren=this.visibleChildren.filter(e=>e!==t):this.visibleChildren=[...this.visibleChildren,t]}scrollIntoView(){if(!this.selectedid)return;this.shadowRoot.querySelector(`[data-id="${this.selectedid}"]`).scrollIntoView({behavior:"smooth",block:"center"})}getChildRow(t,e){return S.c`
      <tr class="child-row">
        <td
          colspan="${Object.values(this.columns).filter(t=>!t.child).length+1}"
        >
          ${t.map(t=>this.columns[t].resolver(e)?S.c`
                  <div class="protvista-datatable__child-item">
                    <div class="protvista-datatable__child-item__title">
                      ${this.columns[t].label}
                    </div>
                    <div class="protvista-datatable__child-item__content">
                      ${this.columns[t].resolver(e)}
                    </div>
                  </div>
                `:S.c``)}
        </td>
      </tr>
    `}render(){if(!this.data||!this.columns)return S.c``;const t=Object.keys(this.columns).filter(t=>this.columns[t].child),e=Object.values(this.columns).filter(t=>!t.child&&!1!==t.display);return S.c`
      <div
        class="protvista-datatable-container"
        style="height:${this.height}rem"
      >
        <table>
          <thead>
            <tr>
              ${e.map(t=>S.c` <th>${t.label}</th> `)}
            </tr>
          </thead>
          <tbody>
            ${this.data.map((n,i)=>{const r=this.hasChildData(t,n);return S.c`
                <tr
                  data-id="${n.protvistaFeatureId}"
                  class="${this.getStyleClass(n.protvistaFeatureId,n.start,n.end)} ${i%2==1?"even":"odd"}"
                  @click="${t=>this.handleClick(t,n)}"
                >
                  ${e.map((t,e)=>r&&0===e?S.c`
                          <td
                            title="View more"
                            @click="${()=>this.toggleVisibleChild(n.protvistaFeatureId)}"
                            class="${this.visibleChildren.includes(n.protvistaFeatureId)?"withChildren minus":"withChildren plus"}"
                          >
                            ${t.resolver(n)}
                          </td>
                        `:S.c`
                          <td>
                            ${t.resolver(n)}
                          </td>
                        `)}
                </tr>
                ${r&&this.visibleChildren.includes(n.protvistaFeatureId)?this.getChildRow(t,n):""}
              `})}
          </tbody>
        </table>
      </div>
    `}updated(){this.noScrollToRow||this.scrollIntoView()}}var Xn=Yn,Kn=function(t,e){customElements.get(t)||customElements.define(t,e)};function Jn(){var t=o()([""]);return Jn=function(){return t},t}function Qn(){var t=o()(["<protvista-structure\n              pdb-id=","\n              accession=","\n            ></protvista-structure>"]);return Qn=function(){return t},t}function ti(){var t=o()(["\n      <div>\n        ","\n        <protvista-datatable noScrollToRow noDeselect></protvista-datatable>\n      </div>\n    "]);return ti=function(){return t},t}function ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E()(t);if(e){var r=E()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}function ni(){var t=o()([" "," Â· "," "]);return ni=function(){return t},t}function ii(){var t=o()([' <a href="',"",'">',"</a> "]);return ii=function(){return t},t}function ri(){var t=o()(["\n        ","\n      "]);return ri=function(){return t},t}var ai=[{name:"PDB",link:"https://www.ebi.ac.uk/pdbe-srv/view/entry/"},{name:"RCSB-PDB",link:"https://www.rcsb.org/structure/"},{name:"PDBj",link:"https://pdbj.org/mine/summary/"},{name:"PDBsum",link:"https://www.ebi.ac.uk/pdbsum/"}],oi=function(t){return t.dbReferences.filter((function(t){return"PDB"===t.type})).sort((function(t,e){return t.id.localeCompare(e.id)})).map((function(t){var e=t.id,n=t.properties;if(!n)return null;var i,r,a=n.chains,o=n.resolution,s=n.method;if(a){var l=a.split("=");if(2===l.length){var c=u()(l,2);i=c[0],r=c[1]}}return{id:e,method:s,resolution:o&&"-"!==o?o:null,chain:i,positions:r,protvistaFeatureId:e}}))},si=function(t){_()(i,t);var e,n=ei(i);function i(){var t;return f()(this,i),t=n.call(this),Kn("protvista-structure",Dn),Kn("protvista-datatable",Xn),t.onTableRowClick=t.onTableRowClick.bind(an()(t)),t}return m()(i,[{key:"connectedCallback",value:(e=d()(l.a.mark((function t(){var e,n,r,a,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v()(E()(i.prototype),"connectedCallback",this).call(this),this.accession){t.next=3;break}return t.abrupt("return");case 3:return e="https://www.ebi.ac.uk/proteins/api/proteins/".concat(this.accession),t.next=6,Wt(e);case 6:if(n=t.sent,r=n.payload){t.next=10;break}return t.abrupt("return");case 10:if((a=oi(r))&&a.length){t.next=13;break}return t.abrupt("return");case 13:this.data=a,o=this.querySelector("protvista-datatable"),this.pdbId=this.data[0].id,o.columns={type:{label:"PDB Entry",resolver:function(t){return t.id}},method:{label:"Method",resolver:function(t){return t.method}},resolution:{label:"Resolution",resolver:function(t){var e=t.resolution;return e&&e.replace("A","â«")}},chain:{label:"Chain",resolver:function(t){return t.chain}},positions:{label:"Positions",resolver:function(t){return t.positions}},links:{label:"Links",resolver:function(t){var e=t.id;return Object(S.c)(ri(),ai.map((function(t){return Object(S.c)(ii(),t.link,e,t.name)})).reduce((function(t,e){return Object(S.c)(ni(),t,e)})))}}},o.data=this.data,o.rowClickEvent=this.onTableRowClick,o.selectedid=this.pdbId;case 20:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"onTableRowClick",value:function(t){var e=t.id;this.pdbId=e}},{key:"createRenderRoot",value:function(){return this}},{key:"render",value:function(){return Object(S.c)(ti(),this.pdbId?Object(S.c)(Qn(),this.pdbId,this.accession):Object(S.c)(Jn()))}}],[{key:"properties",get:function(){return{accession:{type:String},pdbId:{type:String},data:{type:Object}}}}]),i}(S.a),li=n(3),ci=n.n(li);function ui(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function hi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ui(Object(n),!0).forEach((function(e){ci()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var di="#990000",pi="#99cc00",fi="#4c8acd",gi="#009e73",mi=[/uncertain/i,/conflicting/i,/unclassified/i,/risk factor/i],bi=function(t,e){return t.map((function(t){var n=t.variants.filter((function(t){return e(t)}));return hi(hi({},t),{},{variants:r()(n)})}))},vi=[{name:"disease",type:{name:"consequence",text:"Filter Consequence"},options:{labels:["Likely disease"],colors:[di]},filterData:function(t){return bi(t,(function(t){var e;return null===(e=t.association)||void 0===e?void 0:e.some((function(t){return t.disease}))}))}},{name:"predicted",type:{name:"consequence",text:"Filter Consequence"},options:{labels:["Predicted consequence"],colors:[fi]},filterData:function(t){return bi(t,(function(t){return t.hasPredictions}))}},{name:"nonDisease",type:{name:"consequence",text:"Filter Consequence"},options:{labels:["Likely benign"],colors:[pi]},filterData:function(t){return bi(t,(function(t){var e;return null===(e=t.association)||void 0===e?void 0:e.some((function(t){return!1===t.disease}))}))}},{name:"uncertain",type:{name:"consequence",text:"Filter Consequence"},options:{labels:["Uncertain"],colors:[gi]},filterData:function(t){return bi(t,(function(t){return void 0===t.clinicalSignificances&&!t.hasPredictions||(e=t.clinicalSignificances,mi.some((function(t){return t.test(e)})));var e}))}},{name:"UniProt",type:{name:"provenance",text:"Filter Provenance"},options:{labels:["UniProt reviewed"],colors:["#9f9f9f"]},filterData:function(t){return bi(t,(function(t){return t.xrefNames&&(t.xrefNames.includes("uniprot")||t.xrefNames.includes("UniProt"))}))}},{name:"ClinVar",type:{name:"provenance",text:"Filter Provenance"},options:{labels:["ClinVar reviewed"],colors:["#9f9f9f"]},filterData:function(t){return bi(t,(function(t){return t.xrefNames&&(t.xrefNames.includes("ClinVar")||t.xrefNames.includes("clinvar"))}))}},{name:"LSS",type:{name:"provenance",text:"Filter Provenance"},options:{labels:["Large scale studies"],colors:["#9f9f9f"]},filterData:function(t){return bi(t,(function(t){return"large_scale_study"===t.sourceType||"mixed"===t.sourceType}))}}];function yi(){var t=o()(['\n      <style>\n        protvista-tooltip a {\n          text-decoration: underline;\n          color: #fff;\n        }\n        .track-content {\n          width: 80vw;\n        }\n\n        .nav-container,\n        .category,\n        .category__track {\n          display: flex;\n          margin-bottom: 0.1rem;\n        }\n\n        .category-label,\n        .track-label,\n        .action-buttons,\n        .credits {\n          width: 20vw;\n          padding: 0.5em;\n        }\n\n        .action-buttons {\n          display: flex;\n          justify-content: flex-end;\n          align-items: flex-end;\n        }\n\n        .category-label {\n          background-color: #b2f5ff;\n          cursor: pointer;\n        }\n\n        .category-label::before {\n          content: " ";\n          display: inline-block;\n          width: 0;\n          height: 0;\n          border-top: 5px solid transparent;\n          border-bottom: 5px solid transparent;\n          border-left: 5px solid #333;\n          margin-right: 5px;\n          -webkit-transition: all 0.1s;\n          /* Safari */\n          -o-transition: all 0.1s;\n          transition: all 0.1s;\n        }\n\n        .category-label.open::before {\n          content: " ";\n          display: inline-block;\n          width: 0;\n          height: 0;\n          border-left: 5px solid transparent;\n          border-right: 5px solid transparent;\n          border-top: 5px solid #333;\n          margin-right: 5px;\n        }\n\n        .track-label {\n          background-color: #d9faff;\n        }\n\n        protvista-track {\n          border-top: 1px solid #d9faff;\n        }\n\n        .feature {\n          cursor: pointer;\n        }\n      </style>\n    ']);return yi=function(){return t},t}function _i(){var t=o()(['\n          <protvista-variation-graph\n            length="','"\n            displaystart="','"\n            displayend="','"\n            id="track-','"\n          >\n          </protvista-variation-graph>\n        ']);return _i=function(){return t},t}function wi(){var t=o()(['\n          <protvista-variation\n            length="','"\n            displaystart="','"\n            displayend="','"\n            id="track-','"\n          >\n          </protvista-variation>\n        ']);return wi=function(){return t},t}function xi(){var t=o()(['\n          <protvista-interpro-track\n            length="','"\n            color="','"\n            shape="','"\n            displaystart="','"\n            displayend="','"\n            id="track-','"\n          >\n          </protvista-interpro-track>\n        ']);return xi=function(){return t},t}function Ci(){var t=o()(['\n          <protvista-track\n            length="','"\n            layout="','"\n            color="','"\n            shape="','"\n            displaystart="','"\n            displayend="','"\n            id="track-','"\n          >\n          </protvista-track>\n        ']);return Ci=function(){return t},t}function Ei(){var t=o()(['\n      <protvista-filter\n        style="minWidth: 20%"\n        for="track-','"\n      ></protvista-filter>\n    ']);return Ei=function(){return t},t}function Si(){var t=o()(['\n              <protvista-uniprot-structure\n                accession="','"\n              ></protvista-uniprot-structure>\n            ']);return Si=function(){return t},t}function Mi(){var t=o()(['\n                        <div\n                          class="category__track"\n                          id="track_','"\n                        >\n                          <div class="track-label" title="','">\n                            ','\n                          </div>\n                          <div\n                            class="track-content"\n                            data-id="track_','"\n                          >\n                            ',"\n                          </div>\n                        </div>\n                      "]);return Mi=function(){return t},t}function Ai(){var t=o()(['\n                        <div class="category__track" id="track_','">\n                          <div class="track-label" title="','">\n                            ','\n                          </div>\n                          <div\n                            class="track-content"\n                            data-id="track_','"\n                          >\n                            ',"\n                          </div>\n                        </div>\n                      "]);return Ai=function(){return t},t}function Oi(){var t=o()(['\n              <div class="category" id="category_','">\n                <div\n                  class="category-label"\n                  data-category-toggle="','"\n                  @click="','"\n                >\n                  ','\n                </div>\n\n                <div\n                  data-id="category_','"\n                  class="aggregate-track-content track-content"\n                  .style="','"\n                >\n                  ',"\n                </div>\n              </div>\n\n              \x3c!-- Expanded Categories --\x3e\n              ","\n              ","\n            "]);return Oi=function(){return t},t}function ki(){var t=o()(["\n      ",'\n      <protvista-manager\n        attributes="length displaystart displayend highlight activefilters filters"\n        additionalsubscribers="protvista-structure"\n      >\n        <div class="nav-container">\n          <div class="action-buttons">\n            <download-panel\n              accession="','"\n              config="','"\n            />\n          </div>\n          <div class="track-content">\n            <protvista-navigation\n              length="','"\n            ></protvista-navigation>\n            <protvista-sequence\n              length="','"\n              sequence="','"\n              displaystart=','\n              displayend="','"\n            ></protvista-sequence>\n          </div>\n        </div>\n        ','\n        <div class="nav-container">\n          <div class="credits"></div>\n          <div class="track-content">\n            <protvista-sequence\n              length="','"\n              sequence="','"\n              displaystart=','\n              displayend="','"\n            ></protvista-sequence>\n          </div>\n        </div>\n        ',"\n        <protvista-tooltip />\n      </protvista-manager>\n    "]);return ki=function(){return t},t}function Ti(){var t=o()([""]);return Ti=function(){return t},t}function Ni(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Li(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E()(t);if(e){var r=E()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}var Ii=vi,Pi=function(t){var e=[{variants:[t]}];return vi.find((function(t){return"disease"===t.name})).filterData(e)[0].variants.length>0?di:vi.find((function(t){return"nonDisease"===t.name})).filterData(e)[0].variants.length>0?pi:vi.find((function(t){return"uncertain"===t.name})).filterData(e)[0].variants.length>0?gi:vi.find((function(t){return"predicted"===t.name})).filterData(e)[0].variants.length>0?fi:gi},ji={"protvista-feature-adapter":se,"protvista-interpro-adapter":en,"protvista-proteomics-adapter":we,"protvista-structure-adapter":Pe,"protvista-variation-adapter":tn},Ri=function(t){_()(o,t);var e,n,i,a=Di(o);function o(){var t;return f()(this,o),(t=a.call(this)).openCategories=[],t.notooltip=!1,t.nostructure=!1,t.hasData=!1,t.data={},t.displayCoordinates=null,t}return m()(o,[{key:"registerWebComponents",value:function(){Kn("protvista-navigation",R),Kn("protvista-tooltip",H),Kn("protvista-track",ot),Kn("protvista-interpro-track",_t),Kn("protvista-sequence",wt),Kn("protvista-variation",At),Kn("protvista-variation-graph",Rt),Kn("protvista-filter",Bt),Kn("protvista-manager",$t),Kn("protvista-uniprot-structure",si)}},{key:"_loadData",value:function(){var t=this,e=this.config.categories.map((function(e){var n=e.name,i=e.url,r=e.adapter,a=e.tracks,o=i.indexOf("{}")>=0?i.replace("{}",t.accession):"".concat(i).concat(t.accession);return D(/interpro/.test(o)?100:0).then((function(){return Wt(o)})).then((function(e){var i=e.payload;if(i){var o=r?ji[r](i):i;if(t.data[n]="protvista-feature-adapter"===r?o.filter((function(t){var e=t.category;return!e||e===n})):o,a){var s,l=Ni(a);try{var c=function(){var e=s.value;t.data["".concat(n,"-").concat(e.name)]=Array.isArray(o)&&e.filter?o.filter((function(t){return t.type===e.filter})):o};for(l.s();!(s=l.n()).done;)c()}catch(t){l.e(t)}finally{l.f()}}else if(Array.isArray(o)){var u,h=Ni(o);try{for(h.s();!(u=h.n()).done;){var d=u.value;t.data["".concat(n,"-").concat(d.accession)]=[d]}}catch(t){h.e(t)}finally{h.f()}}t.requestUpdate()}}))}));return Promise.all(e)}},{key:"_loadDataInComponents",value:(i=d()(l.a.mark((function t(){var e=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I();case 2:Object.entries(this.data).forEach((function(t){var n=u()(t,2),i=n[0],r=n[1],a=document.getElementById("track-".concat(i));a&&a.data!==r&&(a.data=r);var o=e.config.categories.filter((function(t){return t.name===i}));if(o.length&&o[0].tracks){var s,l=Ni(o[0].tracks);try{for(l.s();!(s=l.n()).done;){var c=s.value,h=document.getElementById("track-".concat(i,"-").concat(c.name));h&&(h.data=e.data["".concat(i,"-").concat(c.name)])}}catch(t){l.e(t)}finally{l.f()}}}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"updated",value:function(t){v()(E()(o.prototype),"updated",this).call(this,t);var e=this.querySelector("protvista-filter");e&&e.filters!==Ii&&(e.filters=Ii);var n=this.querySelector("protvista-variation");if(n&&n.colorConfig!==Pi&&(n.colorConfig=Pi),t.has("suspend")){if(this.suspend)return;this._init()}this._loadDataInComponents()}},{key:"_init",value:function(){var t=this;this.config||(this.config=nn),this.accession&&(this.loadEntry(this.accession).then((function(e){t.sequence=e.sequence.sequence,t.displayCoordinates={start:1,end:t.sequence.length}})),this._loadData())}},{key:"connectedCallback",value:function(){var t=this;v()(E()(o.prototype),"connectedCallback",this).call(this),this.registerWebComponents(),this.suspend||this._init(),this.addEventListener("change",(function(e){e.detail.displaystart&&(t.displayCoordinates.start=e.detail.displaystart),e.detail.displayend&&(t.displayCoordinates.end=e.detail.displayend),t.notooltip||(e.detail.eventtype?"click"===e.detail.eventtype&&t.updateTooltip(e,!0):t._resetTooltip())})),this.notooltip||(this.addEventListener("click",(function(e){e.target.closest(".feature")||e.target.closest("protvista-tooltip")||(t.querySelector("protvista-tooltip").visible=!1)})),document.addEventListener("click",this._resetTooltip)),this.addEventListener("load",(function(e){t.hasData||(t.dispatchEvent(new CustomEvent("protvista-event",{detail:{hasData:!0},bubbles:!0})),t.hasData=!0)}))}},{key:"disconnectedCallback",value:function(){this.notooltip||document.removeEventListener("click",this._resetTooltip)}},{key:"_resetTooltip",value:function(t){if(this&&(!t||!t.target.closest("protvista-uniprot"))){var e=this.querySelector("protvista-tooltip");e&&(e.visible=!1)}}},{key:"loadEntry",value:(n=d()(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://www.ebi.ac.uk/proteins/api/proteins/".concat(e));case 3:return t.next=5,t.sent.json();case 5:return t.abrupt("return",t.sent);case 8:t.prev=8,t.t0=t.catch(0),console.error("Couldn't load UniProt entry",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t){return n.apply(this,arguments)})},{key:"createRenderRoot",value:function(){return this}},{key:"render",value:function(){var t=this;return this.sequence&&this.config&&!this.suspend?Object(S.c)(ki(),this.cssStyle,this.accession,JSON.stringify(this.config.download),this.sequence.length,this.sequence.length,this.sequence,this.displayCoordinates.start,this.displayCoordinates.end,this.config.categories.map((function(e){return t.data[e.name]&&Object(S.c)(Oi(),e.name,e.name,t.handleCategoryClick,e.label,e.name,t.openCategories.includes(e.name)?"opacity:0":"opacity:1",t.data[e.name]&&t.getTrack(e.trackType,"non-overlapping",e.color,e.shape,e.name),e.tracks&&e.tracks.map((function(n){if(t.openCategories.includes(e.name)){var i=t.data["".concat(e.name,"-").concat(n.name)];return i&&(Array.isArray(i)&&i.length||Object.keys(i).length)?Object(S.c)(Ai(),n.name,n.tooltip,n.filterComponent?t.getFilterComponent("".concat(e.name,"-").concat(n.name)):n.label,n.name,t.getTrack(n.trackType,"non-overlapping",n.color||e.color,n.shape||e.shape,"".concat(e.name,"-").concat(n.name))):""}})),e.tracks?"":t.data[e.name].map((function(n){if(t.openCategories.includes(e.name))return n&&n.accession?Object(S.c)(Mi(),n.accession,n.accession,n.accession,n.accession,t.getTrack(e.trackType,"non-overlapping",e.color,e.shape,"".concat(e.name,"-").concat(n.accession))):""})))})),this.sequence.length,this.sequence,this.displayCoordinates.start,this.displayCoordinates.end,this.nostructure?"":Object(S.c)(Si(),this.accession||"")):Object(S.c)(Ti())}},{key:"updateTooltip",value:(e=d()(l.a.mark((function t(e){var n,i,r,a,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.detail.feature).tooltipContent){t.next=3;break}return t.abrupt("return");case 3:(i=this.querySelector("protvista-tooltip")).title="".concat(n.type," ").concat(n.start,"-").concat(n.end),i.innerHTML=n.tooltipContent,i.visible=!0,r=u()(e.detail.coords,2),a=r[0],o=r[1],i.x=a,i.y=o;case 10:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"handleCategoryClick",value:function(t){var e=t.target.getAttribute("data-category-toggle");t.target.classList.contains("open")?(t.target.classList.remove("open"),this.openCategories=r()(this.openCategories).filter((function(t){return t!==e}))):(t.target.classList.add("open"),this.openCategories=[].concat(r()(this.openCategories),[e]))}},{key:"getCategoryTypesAsString",value:function(t){return t.map((function(t){return t.filter})).join(",")}},{key:"getFilterComponent",value:function(t){return Object(S.c)(Ei(),t)}},{key:"getTrack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";switch(t){case"protvista-track":return Object(S.c)(Ci(),this.sequence.length,e,n,i,this.displayCoordinates.start,this.displayCoordinates.end,r);case"protvista-interpro-track":return Object(S.c)(xi(),this.sequence.length,n,i,this.displayCoordinates.start,this.displayCoordinates.end,r);case"protvista-variation":return Object(S.c)(wi(),this.sequence.length,this.displayCoordinates.start,this.displayCoordinates.end,r);case"protvista-variation-graph":return Object(S.c)(_i(),this.sequence.length,this.displayCoordinates.start,this.displayCoordinates.end,r);default:console.warn("No Matching ProtvistaTrack Found.")}}},{key:"cssStyle",get:function(){return Object(S.c)(yi())}}],[{key:"properties",get:function(){return{suspend:{type:Boolean,reflect:!0},accession:{type:String,reflect:!0},sequence:{type:String},data:{type:Object},openCategories:{type:Array},config:{type:Object},notooltip:{type:Boolean,reflect:!0},nostructure:{type:Boolean,reflect:!0}}}}]),o}(S.a);e.b=Ri},307:function(t,e,n){"use strict";n.d(e,"a",(function(){return fr})),n.d(e,"b",(function(){return Yr})),n.d(e,"c",(function(){return Qr}));var i=n(0),r=n.n(i),a=n(19),o=n(2),s=n(18),l=(n(41),r.a.createContext(null));var c=function(t){t()},u={notify:function(){}};function h(){var t=c,e=null,n=null;return{clear:function(){e=null,n=null},notify:function(){t((function(){for(var t=e;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],n=e;n;)t.push(n),n=n.next;return t},subscribe:function(t){var i=!0,r=n={callback:t,next:null,prev:n};return r.prev?r.prev.next=r:e=r,function(){i&&null!==e&&(i=!1,r.next?r.next.prev=r.prev:n=r.prev,r.prev?r.prev.next=r.next:e=r.next)}}}}var d=function(){function t(t,e){this.store=t,this.parentSub=e,this.unsubscribe=null,this.listeners=u,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var e=t.prototype;return e.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},e.notifyNestedSubs=function(){this.listeners.notify()},e.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},e.isSubscribed=function(){return Boolean(this.unsubscribe)},e.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=h())},e.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=u)},t}();var p=function(t){var e=t.store,n=t.context,a=t.children,o=Object(i.useMemo)((function(){var t=new d(e);return t.onStateChange=t.notifyNestedSubs,{store:e,subscription:t}}),[e]),s=Object(i.useMemo)((function(){return e.getState()}),[e]);Object(i.useEffect)((function(){var t=o.subscription;return t.trySubscribe(),s!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[o,s]);var c=n||l;return r.a.createElement(c.Provider,{value:o},a)},f=n(4),g=n(51),m=n.n(g),b=n(62),v="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?i.useLayoutEffect:i.useEffect,y=[],_=[null,null];function w(t,e){var n=t[1];return[e.payload,n+1]}function x(t,e,n){v((function(){return t.apply(void 0,e)}),n)}function C(t,e,n,i,r,a,o){t.current=i,e.current=r,n.current=!1,a.current&&(a.current=null,o())}function E(t,e,n,i,r,a,o,s,l,c){if(t){var u=!1,h=null,d=function(){if(!u){var t,n,d=e.getState();try{t=i(d,r.current)}catch(t){n=t,h=t}n||(h=null),t===a.current?o.current||l():(a.current=t,s.current=t,o.current=!0,c({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=d,n.trySubscribe(),d();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,h)throw h}}}var S=function(){return[null,0]};function M(t,e){void 0===e&&(e={});var n=e,a=n.getDisplayName,s=void 0===a?function(t){return"ConnectAdvanced("+t+")"}:a,c=n.methodName,u=void 0===c?"connectAdvanced":c,h=n.renderCountProp,p=void 0===h?void 0:h,g=n.shouldHandleStateChanges,v=void 0===g||g,M=n.storeKey,A=void 0===M?"store":M,O=(n.withRef,n.forwardRef),k=void 0!==O&&O,T=n.context,N=void 0===T?l:T,L=Object(f.a)(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),D=N;return function(e){var n=e.displayName||e.name||"Component",a=s(n),l=Object(o.a)({},L,{getDisplayName:s,methodName:u,renderCountProp:p,shouldHandleStateChanges:v,storeKey:A,displayName:a,wrappedComponentName:n,WrappedComponent:e}),c=L.pure;var h=c?i.useMemo:function(t){return t()};function g(n){var a=Object(i.useMemo)((function(){var t=n.reactReduxForwardedRef,e=Object(f.a)(n,["reactReduxForwardedRef"]);return[n.context,t,e]}),[n]),s=a[0],c=a[1],u=a[2],p=Object(i.useMemo)((function(){return s&&s.Consumer&&Object(b.isContextConsumer)(r.a.createElement(s.Consumer,null))?s:D}),[s,D]),g=Object(i.useContext)(p),m=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(g)&&Boolean(g.store);var M=m?n.store:g.store,A=Object(i.useMemo)((function(){return function(e){return t(e.dispatch,l)}(M)}),[M]),O=Object(i.useMemo)((function(){if(!v)return _;var t=new d(M,m?null:g.subscription),e=t.notifyNestedSubs.bind(t);return[t,e]}),[M,m,g]),k=O[0],T=O[1],N=Object(i.useMemo)((function(){return m?g:Object(o.a)({},g,{subscription:k})}),[m,g,k]),L=Object(i.useReducer)(w,y,S),I=L[0][0],P=L[1];if(I&&I.error)throw I.error;var j=Object(i.useRef)(),R=Object(i.useRef)(u),F=Object(i.useRef)(),B=Object(i.useRef)(!1),H=h((function(){return F.current&&u===R.current?F.current:A(M.getState(),u)}),[M,I,u]);x(C,[R,j,B,u,H,F,T]),x(E,[v,M,k,A,R,j,B,F,T,P],[M,k,A]);var $=Object(i.useMemo)((function(){return r.a.createElement(e,Object(o.a)({},H,{ref:c}))}),[c,e,H]);return Object(i.useMemo)((function(){return v?r.a.createElement(p.Provider,{value:N},$):$}),[p,$,N])}var M=c?r.a.memo(g):g;if(M.WrappedComponent=e,M.displayName=a,k){var O=r.a.forwardRef((function(t,e){return r.a.createElement(M,Object(o.a)({},t,{reactReduxForwardedRef:e}))}));return O.displayName=a,O.WrappedComponent=e,m()(O,e)}return m()(M,e)}}function A(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function O(t,e){if(A(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(e,n[r])||!A(t[n[r]],e[n[r]]))return!1;return!0}function k(t){return function(e,n){var i=t(e,n);function r(){return i}return r.dependsOnOwnProps=!1,r}}function T(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function N(t,e){return function(e,n){n.displayName;var i=function(t,e){return i.dependsOnOwnProps?i.mapToProps(t,e):i.mapToProps(t)};return i.dependsOnOwnProps=!0,i.mapToProps=function(e,n){i.mapToProps=t,i.dependsOnOwnProps=T(t);var r=i(e,n);return"function"==typeof r&&(i.mapToProps=r,i.dependsOnOwnProps=T(r),r=i(e,n)),r},i}}var L=[function(t){return"function"==typeof t?N(t):void 0},function(t){return t?void 0:k((function(t){return{dispatch:t}}))},function(t){return t&&"object"==typeof t?k((function(e){return Object(s.b)(t,e)})):void 0}];var D=[function(t){return"function"==typeof t?N(t):void 0},function(t){return t?void 0:k((function(){return{}}))}];function I(t,e,n){return Object(o.a)({},n,{},t,{},e)}var P=[function(t){return"function"==typeof t?function(t){return function(e,n){n.displayName;var i,r=n.pure,a=n.areMergedPropsEqual,o=!1;return function(e,n,s){var l=t(e,n,s);return o?r&&a(l,i)||(i=l):(o=!0,i=l),i}}}(t):void 0},function(t){return t?void 0:function(){return I}}];function j(t,e,n,i){return function(r,a){return n(t(r,a),e(i,a),a)}}function R(t,e,n,i,r){var a,o,s,l,c,u=r.areStatesEqual,h=r.areOwnPropsEqual,d=r.areStatePropsEqual,p=!1;function f(r,p){var f,g,m=!h(p,o),b=!u(r,a);return a=r,o=p,m&&b?(s=t(a,o),e.dependsOnOwnProps&&(l=e(i,o)),c=n(s,l,o)):m?(t.dependsOnOwnProps&&(s=t(a,o)),e.dependsOnOwnProps&&(l=e(i,o)),c=n(s,l,o)):b?(f=t(a,o),g=!d(f,s),s=f,g&&(c=n(s,l,o)),c):c}return function(r,u){return p?f(r,u):(s=t(a=r,o=u),l=e(i,o),c=n(s,l,o),p=!0,c)}}function F(t,e){var n=e.initMapStateToProps,i=e.initMapDispatchToProps,r=e.initMergeProps,a=Object(f.a)(e,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),o=n(t,a),s=i(t,a),l=r(t,a);return(a.pure?R:j)(o,s,l,t,a)}function B(t,e,n){for(var i=e.length-1;i>=0;i--){var r=e[i](t);if(r)return r}return function(e,i){throw new Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+i.wrappedComponentName+".")}}function H(t,e){return t===e}function $(t){var e=void 0===t?{}:t,n=e.connectHOC,i=void 0===n?M:n,r=e.mapStateToPropsFactories,a=void 0===r?D:r,s=e.mapDispatchToPropsFactories,l=void 0===s?L:s,c=e.mergePropsFactories,u=void 0===c?P:c,h=e.selectorFactory,d=void 0===h?F:h;return function(t,e,n,r){void 0===r&&(r={});var s=r,c=s.pure,h=void 0===c||c,p=s.areStatesEqual,g=void 0===p?H:p,m=s.areOwnPropsEqual,b=void 0===m?O:m,v=s.areStatePropsEqual,y=void 0===v?O:v,_=s.areMergedPropsEqual,w=void 0===_?O:_,x=Object(f.a)(s,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),C=B(t,a,"mapStateToProps"),E=B(e,l,"mapDispatchToProps"),S=B(n,u,"mergeProps");return i(d,Object(o.a)({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:C,initMapDispatchToProps:E,initMergeProps:S,pure:h,areStatesEqual:g,areOwnPropsEqual:b,areStatePropsEqual:y,areMergedPropsEqual:w},x))}}var q=$();var U,W=n(58),z=n.n(W);function G(t,e){var n=Object(i.useState)((function(){return{inputs:e,result:t()}}))[0],r=Object(i.useRef)(n),a=Boolean(e&&r.current.inputs&&function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,r.current.inputs))?r.current:{inputs:e,result:t()};return Object(i.useEffect)((function(){r.current=a}),[a]),a.result}U=W.unstable_batchedUpdates,c=U;var V=G,Z=function(t,e){return G((function(){return t}),e)},Y=n(20),X=function(t){var e=t.top,n=t.right,i=t.bottom,r=t.left;return{top:e,right:n,bottom:i,left:r,width:n-r,height:i-e,x:r,y:e,center:{x:(n+r)/2,y:(i+e)/2}}},K=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},J=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},Q={top:0,right:0,bottom:0,left:0},tt=function(t){var e=t.borderBox,n=t.margin,i=void 0===n?Q:n,r=t.border,a=void 0===r?Q:r,o=t.padding,s=void 0===o?Q:o,l=X(K(e,i)),c=X(J(e,a)),u=X(J(c,s));return{marginBox:l,borderBox:X(e),paddingBox:c,contentBox:u,margin:i,border:a,padding:s}},et=function(t){var e=t.slice(0,-2);if("px"!==t.slice(-2))return 0;var n=Number(e);return isNaN(n)&&Object(Y.a)(!1),n},nt=function(t,e){var n,i,r=t.borderBox,a=t.border,o=t.margin,s=t.padding,l=(i=e,{top:(n=r).top+i.y,left:n.left+i.x,bottom:n.bottom+i.y,right:n.right+i.x});return tt({borderBox:l,border:a,margin:o,padding:s})},it=function(t,e){return void 0===e&&(e={x:window.pageXOffset,y:window.pageYOffset}),nt(t,e)},rt=function(t,e){var n={top:et(e.marginTop),right:et(e.marginRight),bottom:et(e.marginBottom),left:et(e.marginLeft)},i={top:et(e.paddingTop),right:et(e.paddingRight),bottom:et(e.paddingBottom),left:et(e.paddingLeft)},r={top:et(e.borderTopWidth),right:et(e.borderRightWidth),bottom:et(e.borderBottomWidth),left:et(e.borderLeftWidth)};return tt({borderBox:t,margin:n,padding:i,border:r})},at=function(t){var e=t.getBoundingClientRect(),n=window.getComputedStyle(t);return rt(e,n)};function ot(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var st=function(t,e){var n;void 0===e&&(e=ot);var i,r=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&n===this&&e(o,r)||(i=t.apply(this,o),a=!0,n=this,r=o),i}},lt=function(t){var e=[],n=null,i=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];e=r,n||(n=requestAnimationFrame((function(){n=null,t.apply(void 0,e)})))};return i.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},i};function ct(t,e){}ct.bind(null,"warn"),ct.bind(null,"error");function ut(){}function ht(t,e,n){var i=e.map((function(e){var i,r,a=(i=n,r=e.options,Object(o.a)({},i,{},r));return t.addEventListener(e.eventName,e.fn,a),function(){t.removeEventListener(e.eventName,e.fn,a)}}));return function(){i.forEach((function(t){t()}))}}function dt(t){this.message=t}function pt(t,e){if(!t)throw new dt("Invariant failed")}dt.prototype.toString=function(){return this.message};var ft=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).callbacks=null,e.unbind=ut,e.onWindowError=function(t){var n=e.getCallbacks();n.isDragging()&&n.tryAbort(),t.error instanceof dt&&t.preventDefault()},e.getCallbacks=function(){if(!e.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return e.callbacks},e.setCallbacks=function(t){e.callbacks=t},e}Object(a.a)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.unbind=ht(window,[{eventName:"error",fn:this.onWindowError}])},n.componentWillUnmount=function(){this.unbind()},n.componentDidCatch=function(t){if(!(t instanceof dt))throw t;this.setState({})},n.render=function(){return this.props.children(this.setCallbacks)},e}(r.a.Component),gt=function(t){return t+1},mt=function(t,e){var n=t.droppableId===e.droppableId,i=gt(t.index),r=gt(e.index);return n?"\n      You have moved the item from position "+i+"\n      to position "+r+"\n    ":"\n    You have moved the item from position "+i+"\n    in list "+t.droppableId+"\n    to list "+e.droppableId+"\n    in position "+r+"\n  "},bt=function(t,e,n){return e.droppableId===n.droppableId?"\n      The item "+t+"\n      has been combined with "+n.draggableId:"\n      The item "+t+"\n      in list "+e.droppableId+"\n      has been combined with "+n.draggableId+"\n      in list "+n.droppableId+"\n    "},vt=function(t){return"\n  The item has returned to its starting position\n  of "+gt(t.index)+"\n"},yt="\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n",_t=function(t){return"\n  You have lifted an item in position "+gt(t.source.index)+"\n"},wt=function(t){var e=t.destination;if(e)return mt(t.source,e);var n=t.combine;return n?bt(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},xt=function(t){if("CANCEL"===t.reason)return"\n      Movement cancelled.\n      "+vt(t.source)+"\n    ";var e=t.destination,n=t.combine;return e?"\n      You have dropped the item.\n      "+mt(t.source,e)+"\n    ":n?"\n      You have dropped the item.\n      "+bt(t.draggableId,t.source,n)+"\n    ":"\n    The item has been dropped while not over a drop area.\n    "+vt(t.source)+"\n  "},Ct={x:0,y:0},Et=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},St=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},Mt=function(t,e){return t.x===e.x&&t.y===e.y},At=function(t){return{x:0!==t.x?-t.x:0,y:0!==t.y?-t.y:0}},Ot=function(t,e,n){var i;return void 0===n&&(n=0),(i={})[t]=e,i["x"===t?"y":"x"]=n,i},kt=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},Tt=function(t,e){return Math.min.apply(Math,e.map((function(e){return kt(t,e)})))},Nt=function(t){return function(e){return{x:t(e.x),y:t(e.y)}}},Lt=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}},Dt=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},It=function(t,e){return e&&e.shouldClipSubject?function(t,e){var n=X({top:Math.max(e.top,t.top),right:Math.min(e.right,t.right),bottom:Math.min(e.bottom,t.bottom),left:Math.max(e.left,t.left)});return n.width<=0||n.height<=0?null:n}(e.pageMarginBox,t):X(t)},Pt=function(t){var e=t.page,n=t.withPlaceholder,i=t.axis,r=t.frame,a=function(t,e,n){var i;return n&&n.increasedBy?Object(o.a)({},t,((i={})[e.end]=t[e.end]+n.increasedBy[e.line],i)):t}(function(t,e){return e?Lt(t,e.scroll.diff.displacement):t}(e.marginBox,r),i,n);return{page:e,withPlaceholder:n,active:It(a,r)}},jt=function(t,e){t.frame||pt(!1);var n=t.frame,i=St(e,n.scroll.initial),r=At(i),a=Object(o.a)({},n,{scroll:{initial:n.scroll.initial,current:e,diff:{value:i,displacement:r},max:n.scroll.max}}),s=Pt({page:t.subject.page,withPlaceholder:t.subject.withPlaceholder,axis:t.axis,frame:a});return Object(o.a)({},t,{frame:a,subject:s})};function Rt(t){return Object.values?Object.values(t):Object.keys(t).map((function(e){return t[e]}))}function Ft(t,e){if(t.findIndex)return t.findIndex(e);for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function Bt(t,e){if(t.find)return t.find(e);var n=Ft(t,e);return-1!==n?t[n]:void 0}function Ht(t){return Array.prototype.slice.call(t)}var $t=st((function(t){return t.reduce((function(t,e){return t[e.descriptor.id]=e,t}),{})})),qt=st((function(t){return t.reduce((function(t,e){return t[e.descriptor.id]=e,t}),{})})),Ut=st((function(t){return Rt(t)})),Wt=st((function(t){return Rt(t)})),zt=st((function(t,e){return Wt(e).filter((function(e){return t===e.descriptor.droppableId})).sort((function(t,e){return t.descriptor.index-e.descriptor.index}))}));function Gt(t){return t.at&&"REORDER"===t.at.type?t.at.destination:null}function Vt(t){return t.at&&"COMBINE"===t.at.type?t.at.combine:null}var Zt=st((function(t,e){return e.filter((function(e){return e.descriptor.id!==t.descriptor.id}))})),Yt=function(t,e){return t.descriptor.droppableId===e.descriptor.id},Xt={point:Ct,value:0},Kt={invisible:{},visible:{},all:[]},Jt={displaced:Kt,displacedBy:Xt,at:null},Qt=function(t,e){return function(n){return t<=n&&n<=e}},te=function(t){var e=Qt(t.top,t.bottom),n=Qt(t.left,t.right);return function(i){if(e(i.top)&&e(i.bottom)&&n(i.left)&&n(i.right))return!0;var r=e(i.top)||e(i.bottom),a=n(i.left)||n(i.right);if(r&&a)return!0;var o=i.top<t.top&&i.bottom>t.bottom,s=i.left<t.left&&i.right>t.right;return!(!o||!s)||(o&&a||s&&r)}},ee=function(t){var e=Qt(t.top,t.bottom),n=Qt(t.left,t.right);return function(t){return e(t.top)&&e(t.bottom)&&n(t.left)&&n(t.right)}},ne={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},ie={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},re=function(t){var e=t.target,n=t.destination,i=t.viewport,r=t.withDroppableDisplacement,a=t.isVisibleThroughFrameFn,o=r?function(t,e){var n=e.frame?e.frame.scroll.diff.displacement:Ct;return Lt(t,n)}(e,n):e;return function(t,e,n){return!!e.subject.active&&n(e.subject.active)(t)}(o,n,a)&&function(t,e,n){return n(e)(t)}(o,i,a)},ae=function(t){return re(Object(o.a)({},t,{isVisibleThroughFrameFn:te}))},oe=function(t){return re(Object(o.a)({},t,{isVisibleThroughFrameFn:ee}))};function se(t){var e=t.afterDragging,n=t.destination,i=t.displacedBy,r=t.viewport,a=t.forceShouldAnimate,o=t.last;return e.reduce((function(t,e){var s=function(t,e){var n=t.page.marginBox,i={top:e.point.y,right:0,bottom:0,left:e.point.x};return X(K(n,i))}(e,i),l=e.descriptor.id;if(t.all.push(l),!ae({target:s,destination:n,viewport:r,withDroppableDisplacement:!0}))return t.invisible[e.descriptor.id]=!0,t;var c={draggableId:l,shouldAnimate:function(t,e,n){if("boolean"==typeof n)return n;if(!e)return!0;var i=e.invisible,r=e.visible;if(i[t])return!1;var a=r[t];return!a||a.shouldAnimate}(l,o,a)};return t.visible[l]=c,t}),{all:[],visible:{},invisible:{}})}function le(t){var e=t.insideDestination,n=t.inHomeList,i=t.displacedBy,r=t.destination,a=function(t,e){if(!t.length)return 0;var n=t[t.length-1].descriptor.index;return e.inHomeList?n:n+1}(e,{inHomeList:n});return{displaced:Kt,displacedBy:i,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:a}}}}function ce(t){var e=t.draggable,n=t.insideDestination,i=t.destination,r=t.viewport,a=t.displacedBy,o=t.last,s=t.index,l=t.forceShouldAnimate,c=Yt(e,i);if(null==s)return le({insideDestination:n,inHomeList:c,displacedBy:a,destination:i});var u=Bt(n,(function(t){return t.descriptor.index===s}));if(!u)return le({insideDestination:n,inHomeList:c,displacedBy:a,destination:i});var h=Zt(e,n),d=n.indexOf(u);return{displaced:se({afterDragging:h.slice(d),destination:i,displacedBy:a,last:o,viewport:r.frame,forceShouldAnimate:l}),displacedBy:a,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:s}}}}function ue(t,e){return Boolean(e.effected[t])}var he=function(t){var e=t.isMovingForward,n=t.isInHomeList,i=t.draggable,r=t.draggables,a=t.destination,o=t.insideDestination,s=t.previousImpact,l=t.viewport,c=t.afterCritical,u=s.at;if(u||pt(!1),"REORDER"===u.type){var h=function(t){var e=t.isMovingForward,n=t.isInHomeList,i=t.insideDestination,r=t.location;if(!i.length)return null;var a=r.index,o=e?a+1:a-1,s=i[0].descriptor.index,l=i[i.length-1].descriptor.index;return o<s||o>(n?l:l+1)?null:o}({isMovingForward:e,isInHomeList:n,location:u.destination,insideDestination:o});return null==h?null:ce({draggable:i,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:h})}var d=function(t){var e=t.isMovingForward,n=t.destination,i=t.draggables,r=t.combine,a=t.afterCritical;if(!n.isCombineEnabled)return null;var o=r.draggableId,s=i[o].descriptor.index;return ue(o,a)?e?s:s-1:e?s+1:s}({isMovingForward:e,destination:a,displaced:s.displaced,draggables:r,combine:u.combine,afterCritical:c});return null==d?null:ce({draggable:i,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:d})},de=function(t){var e=t.afterCritical,n=t.impact,i=t.draggables,r=Vt(n);r||pt(!1);var a=r.draggableId,o=i[a].page.borderBox.center,s=function(t){var e=t.displaced,n=t.afterCritical,i=t.combineWith,r=t.displacedBy,a=Boolean(e.visible[i]||e.invisible[i]);return ue(i,n)?a?Ct:At(r.point):a?r.point:Ct}({displaced:n.displaced,afterCritical:e,combineWith:a,displacedBy:n.displacedBy});return Et(o,s)},pe=function(t,e){return e.margin[t.start]+e.borderBox[t.size]/2},fe=function(t,e,n){return e[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},ge=function(t){var e=t.axis,n=t.moveRelativeTo,i=t.isMoving;return Ot(e.line,n.marginBox[e.end]+pe(e,i),fe(e,n.marginBox,i))},me=function(t){var e=t.axis,n=t.moveRelativeTo,i=t.isMoving;return Ot(e.line,n.marginBox[e.start]-function(t,e){return e.margin[t.end]+e.borderBox[t.size]/2}(e,i),fe(e,n.marginBox,i))},be=function(t){var e=t.impact,n=t.draggable,i=t.draggables,r=t.droppable,a=t.afterCritical,o=zt(r.descriptor.id,i),s=n.page,l=r.axis;if(!o.length)return function(t){var e=t.axis,n=t.moveInto,i=t.isMoving;return Ot(e.line,n.contentBox[e.start]+pe(e,i),fe(e,n.contentBox,i))}({axis:l,moveInto:r.page,isMoving:s});var c=e.displaced,u=e.displacedBy,h=c.all[0];if(h){var d=i[h];if(ue(h,a))return me({axis:l,moveRelativeTo:d.page,isMoving:s});var p=nt(d.page,u.point);return me({axis:l,moveRelativeTo:p,isMoving:s})}var f=o[o.length-1];if(f.descriptor.id===n.descriptor.id)return s.borderBox.center;if(ue(f.descriptor.id,a)){var g=nt(f.page,At(a.displacedBy.point));return ge({axis:l,moveRelativeTo:g,isMoving:s})}return ge({axis:l,moveRelativeTo:f.page,isMoving:s})},ve=function(t,e){var n=t.frame;return n?Et(e,n.scroll.diff.displacement):e},ye=function(t){var e=function(t){var e=t.impact,n=t.draggable,i=t.droppable,r=t.draggables,a=t.afterCritical,o=n.page.borderBox.center,s=e.at;return i&&s?"REORDER"===s.type?be({impact:e,draggable:n,draggables:r,droppable:i,afterCritical:a}):de({impact:e,draggables:r,afterCritical:a}):o}(t),n=t.droppable;return n?ve(n,e):e},_e=function(t,e){var n=St(e,t.scroll.initial),i=At(n);return{frame:X({top:e.y,bottom:e.y+t.frame.height,left:e.x,right:e.x+t.frame.width}),scroll:{initial:t.scroll.initial,max:t.scroll.max,current:e,diff:{value:n,displacement:i}}}};function we(t,e){return t.map((function(t){return e[t]}))}var xe=function(t){var e=t.pageBorderBoxCenter,n=t.draggable,i=function(t,e){return Et(t.scroll.diff.displacement,e)}(t.viewport,e),r=St(i,n.page.borderBox.center);return Et(n.client.borderBox.center,r)},Ce=function(t){var e=t.draggable,n=t.destination,i=t.newPageBorderBoxCenter,r=t.viewport,a=t.withDroppableDisplacement,s=t.onlyOnMainAxis,l=void 0!==s&&s,c=St(i,e.page.borderBox.center),u={target:Lt(e.page.borderBox,c),destination:n,withDroppableDisplacement:a,viewport:r};return l?function(t){return re(Object(o.a)({},t,{isVisibleThroughFrameFn:(e=t.destination.axis,function(t){var n=Qt(t.top,t.bottom),i=Qt(t.left,t.right);return function(t){return e===ne?n(t.top)&&n(t.bottom):i(t.left)&&i(t.right)}})}));var e}(u):oe(u)},Ee=function(t){var e=t.isMovingForward,n=t.draggable,i=t.destination,r=t.draggables,a=t.previousImpact,s=t.viewport,l=t.previousPageBorderBoxCenter,c=t.previousClientSelection,u=t.afterCritical;if(!i.isEnabled)return null;var h=zt(i.descriptor.id,r),d=Yt(n,i),p=function(t){var e=t.isMovingForward,n=t.draggable,i=t.destination,r=t.insideDestination,a=t.previousImpact;if(!i.isCombineEnabled)return null;if(!Gt(a))return null;function s(t){var e={type:"COMBINE",combine:{draggableId:t,droppableId:i.descriptor.id}};return Object(o.a)({},a,{at:e})}var l=a.displaced.all,c=l.length?l[0]:null;if(e)return c?s(c):null;var u=Zt(n,r);if(!c)return u.length?s(u[u.length-1].descriptor.id):null;var h=Ft(u,(function(t){return t.descriptor.id===c}));-1===h&&pt(!1);var d=h-1;return d<0?null:s(u[d].descriptor.id)}({isMovingForward:e,draggable:n,destination:i,insideDestination:h,previousImpact:a})||he({isMovingForward:e,isInHomeList:d,draggable:n,draggables:r,destination:i,insideDestination:h,previousImpact:a,viewport:s,afterCritical:u});if(!p)return null;var f=ye({impact:p,draggable:n,droppable:i,draggables:r,afterCritical:u});if(Ce({draggable:n,destination:i,newPageBorderBoxCenter:f,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:xe({pageBorderBoxCenter:f,draggable:n,viewport:s}),impact:p,scrollJumpRequest:null};var g=St(f,l);return{clientSelection:c,impact:function(t){var e=t.impact,n=t.viewport,i=t.destination,r=t.draggables,a=t.maxScrollChange,s=_e(n,Et(n.scroll.current,a)),l=i.frame?jt(i,Et(i.frame.scroll.current,a)):i,c=e.displaced,u=se({afterDragging:we(c.all,r),destination:i,displacedBy:e.displacedBy,viewport:s.frame,last:c,forceShouldAnimate:!1}),h=se({afterDragging:we(c.all,r),destination:l,displacedBy:e.displacedBy,viewport:n.frame,last:c,forceShouldAnimate:!1}),d={},p={},f=[c,u,h];return c.all.forEach((function(t){var e=function(t,e){for(var n=0;n<e.length;n++){var i=e[n].visible[t];if(i)return i}return null}(t,f);e?p[t]=e:d[t]=!0})),Object(o.a)({},e,{displaced:{all:c.all,invisible:d,visible:p}})}({impact:p,viewport:s,destination:i,draggables:r,maxScrollChange:g}),scrollJumpRequest:g}},Se=function(t){var e=t.subject.active;return e||pt(!1),e},Me=function(t,e){var n=t.page.borderBox.center;return ue(t.descriptor.id,e)?St(n,e.displacedBy.point):n},Ae=function(t,e){var n=t.page.borderBox;return ue(t.descriptor.id,e)?Lt(n,At(e.displacedBy.point)):n},Oe=st((function(t,e){var n=e[t.line];return{value:n,point:Ot(t.line,n)}})),ke=function(t,e){return Object(o.a)({},t,{scroll:Object(o.a)({},t.scroll,{max:e})})},Te=function(t,e,n){var i=t.frame;Yt(e,t)&&pt(!1),t.subject.withPlaceholder&&pt(!1);var r=Oe(t.axis,e.displaceBy).point,a=function(t,e,n){var i=t.axis;if("virtual"===t.descriptor.mode)return Ot(i.line,e[i.line]);var r=t.subject.page.contentBox[i.size],a=zt(t.descriptor.id,n).reduce((function(t,e){return t+e.client.marginBox[i.size]}),0)+e[i.line]-r;return a<=0?null:Ot(i.line,a)}(t,r,n),s={placeholderSize:r,increasedBy:a,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!i){var l=Pt({page:t.subject.page,withPlaceholder:s,axis:t.axis,frame:t.frame});return Object(o.a)({},t,{subject:l})}var c=a?Et(i.scroll.max,a):i.scroll.max,u=ke(i,c),h=Pt({page:t.subject.page,withPlaceholder:s,axis:t.axis,frame:u});return Object(o.a)({},t,{subject:h,frame:u})},Ne=function(t){var e=t.isMovingForward,n=t.previousPageBorderBoxCenter,i=t.draggable,r=t.isOver,a=t.draggables,o=t.droppables,s=t.viewport,l=t.afterCritical,c=function(t){var e=t.isMovingForward,n=t.pageBorderBoxCenter,i=t.source,r=t.droppables,a=t.viewport,o=i.subject.active;if(!o)return null;var s=i.axis,l=Qt(o[s.start],o[s.end]),c=Ut(r).filter((function(t){return t!==i})).filter((function(t){return t.isEnabled})).filter((function(t){return Boolean(t.subject.active)})).filter((function(t){return te(a.frame)(Se(t))})).filter((function(t){var n=Se(t);return e?o[s.crossAxisEnd]<n[s.crossAxisEnd]:n[s.crossAxisStart]<o[s.crossAxisStart]})).filter((function(t){var e=Se(t),n=Qt(e[s.start],e[s.end]);return l(e[s.start])||l(e[s.end])||n(o[s.start])||n(o[s.end])})).sort((function(t,n){var i=Se(t)[s.crossAxisStart],r=Se(n)[s.crossAxisStart];return e?i-r:r-i})).filter((function(t,e,n){return Se(t)[s.crossAxisStart]===Se(n[0])[s.crossAxisStart]}));if(!c.length)return null;if(1===c.length)return c[0];var u=c.filter((function(t){return Qt(Se(t)[s.start],Se(t)[s.end])(n[s.line])}));return 1===u.length?u[0]:u.length>1?u.sort((function(t,e){return Se(t)[s.start]-Se(e)[s.start]}))[0]:c.sort((function(t,e){var i=Tt(n,Dt(Se(t))),r=Tt(n,Dt(Se(e)));return i!==r?i-r:Se(t)[s.start]-Se(e)[s.start]}))[0]}({isMovingForward:e,pageBorderBoxCenter:n,source:r,droppables:o,viewport:s});if(!c)return null;var u=zt(c.descriptor.id,a),h=function(t){var e=t.previousPageBorderBoxCenter,n=t.moveRelativeTo,i=t.insideDestination,r=t.draggable,a=t.draggables,o=t.destination,s=t.viewport,l=t.afterCritical;if(!n){if(i.length)return null;var c={displaced:Kt,displacedBy:Xt,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},u=ye({impact:c,draggable:r,droppable:o,draggables:a,afterCritical:l}),h=Yt(r,o)?o:Te(o,r,a);return Ce({draggable:r,destination:h,newPageBorderBoxCenter:u,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?c:null}var d,p=Boolean(e[o.axis.line]<=n.page.borderBox.center[o.axis.line]),f=(d=n.descriptor.index,n.descriptor.id===r.descriptor.id||p?d:d+1),g=Oe(o.axis,r.displaceBy);return ce({draggable:r,insideDestination:i,destination:o,viewport:s,displacedBy:g,last:Kt,index:f})}({previousPageBorderBoxCenter:n,destination:c,draggable:i,draggables:a,moveRelativeTo:function(t){var e=t.pageBorderBoxCenter,n=t.viewport,i=t.destination,r=t.insideDestination,a=t.afterCritical;return r.filter((function(t){return oe({target:Ae(t,a),destination:i,viewport:n.frame,withDroppableDisplacement:!0})})).sort((function(t,n){var r=kt(e,ve(i,Me(t,a))),o=kt(e,ve(i,Me(n,a)));return r<o?-1:o<r?1:t.descriptor.index-n.descriptor.index}))[0]||null}({pageBorderBoxCenter:n,viewport:s,destination:c,insideDestination:u,afterCritical:l}),insideDestination:u,viewport:s,afterCritical:l});if(!h)return null;var d=ye({impact:h,draggable:i,droppable:c,draggables:a,afterCritical:l});return{clientSelection:xe({pageBorderBoxCenter:d,draggable:i,viewport:s}),impact:h,scrollJumpRequest:null}},Le=function(t){var e=t.at;return e?"REORDER"===e.type?e.destination.droppableId:e.combine.droppableId:null},De=function(t){var e=t.state,n=t.type,i=function(t,e){var n=Le(t);return n?e[n]:null}(e.impact,e.dimensions.droppables),r=Boolean(i),a=e.dimensions.droppables[e.critical.droppable.id],o=i||a,s=o.axis.direction,l="vertical"===s&&("MOVE_UP"===n||"MOVE_DOWN"===n)||"horizontal"===s&&("MOVE_LEFT"===n||"MOVE_RIGHT"===n);if(l&&!r)return null;var c="MOVE_DOWN"===n||"MOVE_RIGHT"===n,u=e.dimensions.draggables[e.critical.draggable.id],h=e.current.page.borderBoxCenter,d=e.dimensions,p=d.draggables,f=d.droppables;return l?Ee({isMovingForward:c,previousPageBorderBoxCenter:h,draggable:u,destination:o,draggables:p,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):Ne({isMovingForward:c,previousPageBorderBoxCenter:h,draggable:u,isOver:o,draggables:p,droppables:f,viewport:e.viewport,afterCritical:e.afterCritical})};function Ie(t){return"DRAGGING"===t.phase||"COLLECTING"===t.phase}function Pe(t){var e=Qt(t.top,t.bottom),n=Qt(t.left,t.right);return function(t){return e(t.y)&&n(t.x)}}function je(t){var e=t.pageBorderBox,n=t.draggable,i=t.droppables,r=Ut(i).filter((function(t){if(!t.isEnabled)return!1;var n,i,r=t.subject.active;if(!r)return!1;if(i=r,!((n=e).left<i.right&&n.right>i.left&&n.top<i.bottom&&n.bottom>i.top))return!1;if(Pe(r)(e.center))return!0;var a=t.axis,o=r.center[a.crossAxisLine],s=e[a.crossAxisStart],l=e[a.crossAxisEnd],c=Qt(r[a.crossAxisStart],r[a.crossAxisEnd]),u=c(s),h=c(l);return!u&&!h||(u?s<o:l>o)}));return r.length?1===r.length?r[0].descriptor.id:function(t){var e=t.pageBorderBox,n=t.draggable,i=t.candidates,r=n.page.borderBox.center,a=i.map((function(t){var n=t.axis,i=Ot(t.axis.line,e.center[n.line],t.page.borderBox.center[n.crossAxisLine]);return{id:t.descriptor.id,distance:kt(r,i)}})).sort((function(t,e){return e.distance-t.distance}));return a[0]?a[0].id:null}({pageBorderBox:e,draggable:n,candidates:r}):null}var Re=function(t,e){return X(Lt(t,e))};function Fe(t){var e=t.displaced,n=t.id;return Boolean(e.visible[n]||e.invisible[n])}var Be=function(t){var e=t.pageOffset,n=t.draggable,i=t.draggables,r=t.droppables,a=t.previousImpact,o=t.viewport,s=t.afterCritical,l=Re(n.page.borderBox,e),c=je({pageBorderBox:l,draggable:n,droppables:r});if(!c)return Jt;var u,h,d=r[c],p=zt(d.descriptor.id,i),f=(u=l,(h=d.frame)?Re(u,h.scroll.diff.value):u);return function(t){var e=t.draggable,n=t.pageBorderBoxWithDroppableScroll,i=t.previousImpact,r=t.destination,a=t.insideDestination,o=t.afterCritical;if(!r.isCombineEnabled)return null;var s=r.axis,l=Oe(r.axis,e.displaceBy),c=l.value,u=n[s.start],h=n[s.end],d=Bt(Zt(e,a),(function(t){var e=t.descriptor.id,n=t.page.borderBox,r=n[s.size]/4,a=ue(e,o),l=Fe({displaced:i.displaced,id:e});return a?l?h>n[s.start]+r&&h<n[s.end]-r:u>n[s.start]-c+r&&u<n[s.end]-c-r:l?h>n[s.start]+c+r&&h<n[s.end]+c-r:u>n[s.start]+r&&u<n[s.end]-r}));return d?{displacedBy:l,displaced:i.displaced,at:{type:"COMBINE",combine:{draggableId:d.descriptor.id,droppableId:r.descriptor.id}}}:null}({pageBorderBoxWithDroppableScroll:f,draggable:n,previousImpact:a,destination:d,insideDestination:p,afterCritical:s})||function(t){var e=t.pageBorderBoxWithDroppableScroll,n=t.draggable,i=t.destination,r=t.insideDestination,a=t.last,o=t.viewport,s=t.afterCritical,l=i.axis,c=Oe(i.axis,n.displaceBy),u=c.value,h=e[l.start],d=e[l.end],p=function(t){var e=t.draggable,n=t.closest,i=t.inHomeList;return n?i&&n.descriptor.index>e.descriptor.index?n.descriptor.index-1:n.descriptor.index:null}({draggable:n,closest:Bt(Zt(n,r),(function(t){var e=t.descriptor.id,n=t.page.borderBox.center[l.line],i=ue(e,s),r=Fe({displaced:a,id:e});return i?r?d<=n:h<n-u:r?d<=n+u:h<n})),inHomeList:Yt(n,i)});return ce({draggable:n,insideDestination:r,destination:i,viewport:o,last:a,displacedBy:c,index:p})}({pageBorderBoxWithDroppableScroll:f,draggable:n,destination:d,insideDestination:p,last:a.displaced,viewport:o,afterCritical:s})},He=function(t,e){var n;return Object(o.a)({},t,((n={})[e.descriptor.id]=e,n))},$e=function(t){var e=t.previousImpact,n=t.impact,i=t.droppables,r=Le(e),a=Le(n);if(!r)return i;if(r===a)return i;var s=i[r];if(!s.subject.withPlaceholder)return i;var l=function(t){var e=t.subject.withPlaceholder;e||pt(!1);var n=t.frame;if(!n){var i=Pt({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return Object(o.a)({},t,{subject:i})}var r=e.oldFrameMaxScroll;r||pt(!1);var a=ke(n,r),s=Pt({page:t.subject.page,axis:t.axis,frame:a,withPlaceholder:null});return Object(o.a)({},t,{subject:s,frame:a})}(s);return He(i,l)},qe=function(t){var e=t.state,n=t.clientSelection,i=t.dimensions,r=t.viewport,a=t.impact,s=t.scrollJumpRequest,l=r||e.viewport,c=i||e.dimensions,u=n||e.current.client.selection,h=St(u,e.initial.client.selection),d={offset:h,selection:u,borderBoxCenter:Et(e.initial.client.borderBoxCenter,h)},p={selection:Et(d.selection,l.scroll.current),borderBoxCenter:Et(d.borderBoxCenter,l.scroll.current),offset:Et(d.offset,l.scroll.diff.value)},f={client:d,page:p};if("COLLECTING"===e.phase)return Object(o.a)({phase:"COLLECTING"},e,{dimensions:c,viewport:l,current:f});var g=c.draggables[e.critical.draggable.id],m=a||Be({pageOffset:p.offset,draggable:g,draggables:c.draggables,droppables:c.droppables,previousImpact:e.impact,viewport:l,afterCritical:e.afterCritical}),b=function(t){var e=t.draggable,n=t.draggables,i=t.droppables,r=t.previousImpact,a=t.impact,o=$e({previousImpact:r,impact:a,droppables:i}),s=Le(a);if(!s)return o;var l=i[s];if(Yt(e,l))return o;if(l.subject.withPlaceholder)return o;var c=Te(l,e,n);return He(o,c)}({draggable:g,impact:m,previousImpact:e.impact,draggables:c.draggables,droppables:c.droppables});return Object(o.a)({},e,{current:f,dimensions:{draggables:c.draggables,droppables:b},impact:m,viewport:l,scrollJumpRequest:s||null,forceShouldAnimate:!s&&null})};var Ue=function(t){var e=t.impact,n=t.viewport,i=t.draggables,r=t.destination,a=t.forceShouldAnimate,s=e.displaced,l=se({afterDragging:function(t,e){return t.map((function(t){return e[t]}))}(s.all,i),destination:r,displacedBy:e.displacedBy,viewport:n.frame,forceShouldAnimate:a,last:s});return Object(o.a)({},e,{displaced:l})},We=function(t){var e=t.impact,n=t.draggable,i=t.droppable,r=t.draggables,a=t.viewport,o=t.afterCritical,s=ye({impact:e,draggable:n,draggables:r,droppable:i,afterCritical:o});return xe({pageBorderBoxCenter:s,draggable:n,viewport:a})},ze=function(t){var e=t.state,n=t.dimensions,i=t.viewport;"SNAP"!==e.movementMode&&pt(!1);var r=e.impact,a=i||e.viewport,o=n||e.dimensions,s=o.draggables,l=o.droppables,c=s[e.critical.draggable.id],u=Le(r);u||pt(!1);var h=l[u],d=Ue({impact:r,viewport:a,destination:h,draggables:s}),p=We({impact:d,draggable:c,droppable:h,draggables:s,viewport:a,afterCritical:e.afterCritical});return qe({impact:d,clientSelection:p,state:e,dimensions:o,viewport:a})},Ge=function(t){var e=t.draggable,n=t.home,i=t.draggables,r=t.viewport,a=Oe(n.axis,e.displaceBy),o=zt(n.descriptor.id,i),s=o.indexOf(e);-1===s&&pt(!1);var l,c=o.slice(s+1),u=c.reduce((function(t,e){return t[e.descriptor.id]=!0,t}),{}),h={inVirtualList:"virtual"===n.descriptor.mode,displacedBy:a,effected:u};return{impact:{displaced:se({afterDragging:c,destination:n,displacedBy:a,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:a,at:{type:"REORDER",destination:(l=e.descriptor,{index:l.index,droppableId:l.droppableId})}},afterCritical:h}},Ve=function(t){0},Ze=function(t){0},Ye=function(t){var e=t.additions,n=t.updatedDroppables,i=t.viewport,r=i.scroll.diff.value;return e.map((function(t){var e=t.descriptor.droppableId,a=function(t){var e=t.frame;return e||pt(!1),e}(n[e]).scroll.diff.value;return function(t){var e=t.draggable,n=t.offset,i=t.initialWindowScroll,r=nt(e.client,n),a=it(r,i);return Object(o.a)({},e,{placeholder:Object(o.a)({},e.placeholder,{client:r}),client:r,page:a})}({draggable:t,offset:Et(r,a),initialWindowScroll:i.scroll.initial})}))},Xe=function(t){return"SNAP"===t.movementMode},Ke=function(t,e,n){var i=function(t,e){return{draggables:t.draggables,droppables:He(t.droppables,e)}}(t.dimensions,e);return!Xe(t)||n?qe({state:t,dimensions:i}):ze({state:t,dimensions:i})};function Je(t){return t.isDragging&&"SNAP"===t.movementMode?Object(o.a)({phase:"DRAGGING"},t,{scrollJumpRequest:null}):t}var Qe={phase:"IDLE",completed:null,shouldFlush:!1},tn=function(t,e){if(void 0===t&&(t=Qe),"FLUSH"===e.type)return Object(o.a)({},Qe,{shouldFlush:!0});if("INITIAL_PUBLISH"===e.type){"IDLE"!==t.phase&&pt(!1);var n=e.payload,i=n.critical,r=n.clientSelection,a=n.viewport,s=n.dimensions,l=n.movementMode,c=s.draggables[i.draggable.id],u=s.droppables[i.droppable.id],h={selection:r,borderBoxCenter:c.client.borderBox.center,offset:Ct},d={client:h,page:{selection:Et(h.selection,a.scroll.initial),borderBoxCenter:Et(h.selection,a.scroll.initial),offset:Et(h.selection,a.scroll.diff.value)}},p=Ut(s.droppables).every((function(t){return!t.isFixedOnPage})),f=Ge({draggable:c,home:u,draggables:s.draggables,viewport:a}),g=f.impact;return{phase:"DRAGGING",isDragging:!0,critical:i,movementMode:l,dimensions:s,initial:d,current:d,isWindowScrollAllowed:p,impact:g,afterCritical:f.afterCritical,onLiftImpact:g,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null}}if("COLLECTION_STARTING"===e.type)return"COLLECTING"===t.phase||"DROP_PENDING"===t.phase?t:("DRAGGING"!==t.phase&&pt(!1),Object(o.a)({phase:"COLLECTING"},t,{phase:"COLLECTING"}));if("PUBLISH_WHILE_DRAGGING"===e.type)return"COLLECTING"!==t.phase&&"DROP_PENDING"!==t.phase&&pt(!1),function(t){var e=t.state,n=t.published;Ve();var i=n.modified.map((function(t){var n=e.dimensions.droppables[t.droppableId];return jt(n,t.scroll)})),r=Object(o.a)({},e.dimensions.droppables,{},$t(i)),a=qt(Ye({additions:n.additions,updatedDroppables:r,viewport:e.viewport})),s=Object(o.a)({},e.dimensions.draggables,{},a);n.removals.forEach((function(t){delete s[t]}));var l={droppables:r,draggables:s},c=Le(e.impact),u=c?l.droppables[c]:null,h=l.draggables[e.critical.draggable.id],d=l.droppables[e.critical.droppable.id],p=Ge({draggable:h,home:d,draggables:s,viewport:e.viewport}),f=p.impact,g=p.afterCritical,m=u&&u.isCombineEnabled?e.impact:f,b=Be({pageOffset:e.current.page.offset,draggable:l.draggables[e.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:m,viewport:e.viewport,afterCritical:g});Ze();var v=Object(o.a)({phase:"DRAGGING"},e,{phase:"DRAGGING",impact:b,onLiftImpact:f,dimensions:l,afterCritical:g,forceShouldAnimate:!1});return"COLLECTING"===e.phase?v:Object(o.a)({phase:"DROP_PENDING"},v,{phase:"DROP_PENDING",reason:e.reason,isWaiting:!1})}({state:t,published:e.payload});if("MOVE"===e.type){if("DROP_PENDING"===t.phase)return t;Ie(t)||pt(!1);var m=e.payload.client;return Mt(m,t.current.client.selection)?t:qe({state:t,clientSelection:m,impact:Xe(t)?t.impact:null})}if("UPDATE_DROPPABLE_SCROLL"===e.type){if("DROP_PENDING"===t.phase)return Je(t);if("COLLECTING"===t.phase)return Je(t);Ie(t)||pt(!1);var b=e.payload,v=b.id,y=b.newScroll,_=t.dimensions.droppables[v];if(!_)return t;var w=jt(_,y);return Ke(t,w,!1)}if("UPDATE_DROPPABLE_IS_ENABLED"===e.type){if("DROP_PENDING"===t.phase)return t;Ie(t)||pt(!1);var x=e.payload,C=x.id,E=x.isEnabled,S=t.dimensions.droppables[C];S||pt(!1),S.isEnabled===E&&pt(!1);var M=Object(o.a)({},S,{isEnabled:E});return Ke(t,M,!0)}if("UPDATE_DROPPABLE_IS_COMBINE_ENABLED"===e.type){if("DROP_PENDING"===t.phase)return t;Ie(t)||pt(!1);var A=e.payload,O=A.id,k=A.isCombineEnabled,T=t.dimensions.droppables[O];T||pt(!1),T.isCombineEnabled===k&&pt(!1);var N=Object(o.a)({},T,{isCombineEnabled:k});return Ke(t,N,!0)}if("MOVE_BY_WINDOW_SCROLL"===e.type){if("DROP_PENDING"===t.phase||"DROP_ANIMATING"===t.phase)return t;Ie(t)||pt(!1),t.isWindowScrollAllowed||pt(!1);var L=e.payload.newScroll;if(Mt(t.viewport.scroll.current,L))return Je(t);var D=_e(t.viewport,L);return Xe(t)?ze({state:t,viewport:D}):qe({state:t,viewport:D})}if("UPDATE_VIEWPORT_MAX_SCROLL"===e.type){if(!Ie(t))return t;var I=e.payload.maxScroll;if(Mt(I,t.viewport.scroll.max))return t;var P=Object(o.a)({},t.viewport,{scroll:Object(o.a)({},t.viewport.scroll,{max:I})});return Object(o.a)({phase:"DRAGGING"},t,{viewport:P})}if("MOVE_UP"===e.type||"MOVE_DOWN"===e.type||"MOVE_LEFT"===e.type||"MOVE_RIGHT"===e.type){if("COLLECTING"===t.phase||"DROP_PENDING"===t.phase)return t;"DRAGGING"!==t.phase&&pt(!1);var j=De({state:t,type:e.type});return j?qe({state:t,impact:j.impact,clientSelection:j.clientSelection,scrollJumpRequest:j.scrollJumpRequest}):t}if("DROP_PENDING"===e.type){var R=e.payload.reason;return"COLLECTING"!==t.phase&&pt(!1),Object(o.a)({phase:"DROP_PENDING"},t,{phase:"DROP_PENDING",isWaiting:!0,reason:R})}if("DROP_ANIMATE"===e.type){var F=e.payload,B=F.completed,H=F.dropDuration,$=F.newHomeClientOffset;return"DRAGGING"!==t.phase&&"DROP_PENDING"!==t.phase&&pt(!1),{phase:"DROP_ANIMATING",completed:B,dropDuration:H,newHomeClientOffset:$,dimensions:t.dimensions}}return"DROP_COMPLETE"===e.type?{phase:"IDLE",completed:e.payload.completed,shouldFlush:!1}:t},en=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},nn=function(){return{type:"COLLECTION_STARTING",payload:null}},rn=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},an=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},on=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},sn=function(t){return{type:"MOVE",payload:t}},ln=function(){return{type:"MOVE_UP",payload:null}},cn=function(){return{type:"MOVE_DOWN",payload:null}},un=function(){return{type:"MOVE_RIGHT",payload:null}},hn=function(){return{type:"MOVE_LEFT",payload:null}},dn=function(t){return{type:"DROP_COMPLETE",payload:t}},pn=function(t){return{type:"DROP",payload:t}},fn=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}};var gn="cubic-bezier(.2,1,.1,1)",mn={drop:0,combining:.7},bn={drop:.75},vn=.2+"s "+"cubic-bezier(0.2, 0, 0, 1)",yn={fluid:"opacity "+vn,snap:"transform "+vn+", opacity "+vn,drop:function(t){var e=t+"s "+gn;return"transform "+e+", opacity "+e},outOfTheWay:"transform "+vn,placeholder:"height "+vn+", width "+vn+", margin "+vn},_n=function(t){return Mt(t,Ct)?null:"translate("+t.x+"px, "+t.y+"px)"},wn=_n,xn=function(t,e){var n=_n(t);return n?e?n+" scale("+bn.drop+")":n:null},Cn=.33,En=.55,Sn=En-Cn,Mn=function(t){var e=t.getState,n=t.dispatch;return function(t){return function(i){if("DROP"===i.type){var r=e(),a=i.payload.reason;if("COLLECTING"!==r.phase){if("IDLE"!==r.phase){"DROP_PENDING"===r.phase&&r.isWaiting&&pt(!1),"DRAGGING"!==r.phase&&"DROP_PENDING"!==r.phase&&pt(!1);var s=r.critical,l=r.dimensions,c=l.draggables[r.critical.draggable.id],u=function(t){var e=t.draggables,n=t.reason,i=t.lastImpact,r=t.home,a=t.viewport,s=t.onLiftImpact;return i.at&&"DROP"===n?"REORDER"===i.at.type?{impact:i,didDropInsideDroppable:!0}:{impact:Object(o.a)({},i,{displaced:Kt}),didDropInsideDroppable:!0}:{impact:Ue({draggables:e,impact:s,destination:r,viewport:a,forceShouldAnimate:!0}),didDropInsideDroppable:!1}}({reason:a,lastImpact:r.impact,afterCritical:r.afterCritical,onLiftImpact:r.onLiftImpact,home:r.dimensions.droppables[r.critical.droppable.id],viewport:r.viewport,draggables:r.dimensions.draggables}),h=u.impact,d=u.didDropInsideDroppable,p=d?Gt(h):null,f=d?Vt(h):null,g={index:s.draggable.index,droppableId:s.droppable.id},m={draggableId:c.descriptor.id,type:c.descriptor.type,source:g,reason:a,mode:r.movementMode,destination:p,combine:f},b=function(t){var e=t.impact,n=t.draggable,i=t.dimensions,r=t.viewport,a=t.afterCritical,o=i.draggables,s=i.droppables,l=Le(e),c=l?s[l]:null,u=s[n.descriptor.droppableId],h=We({impact:e,draggable:n,draggables:o,afterCritical:a,droppable:c||u,viewport:r});return St(h,n.client.borderBox.center)}({impact:h,draggable:c,dimensions:l,viewport:r.viewport,afterCritical:r.afterCritical}),v={critical:r.critical,afterCritical:r.afterCritical,result:m,impact:h};if(!Mt(r.current.client.offset,b)||Boolean(m.combine)){var y=function(t){var e=t.current,n=t.destination,i=t.reason,r=kt(e,n);if(r<=0)return Cn;if(r>=1500)return En;var a=Cn+Sn*(r/1500);return Number(("CANCEL"===i?.6*a:a).toFixed(2))}({current:r.current.client.offset,destination:b,reason:a});n(function(t){return{type:"DROP_ANIMATE",payload:t}}({newHomeClientOffset:b,dropDuration:y,completed:v}))}else n(dn({completed:v}))}}else n(function(t){return{type:"DROP_PENDING",payload:t}}({reason:a}))}else t(i)}}},An=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function On(t){var e=t.onWindowScroll;var n,i=lt((function(){e(An())})),r=(n=i,{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(t){t.target!==window&&t.target!==window.document||n()}}),a=ut;function o(){return a!==ut}return{start:function(){o()&&pt(!1),a=ht(window,[r])},stop:function(){o()||pt(!1),i.cancel(),a(),a=ut},isActive:o}}var kn=function(t){var e=On({onWindowScroll:function(e){t.dispatch({type:"MOVE_BY_WINDOW_SCROLL",payload:{newScroll:e}})}});return function(t){return function(n){e.isActive()||"INITIAL_PUBLISH"!==n.type||e.start(),e.isActive()&&function(t){return"DROP_COMPLETE"===t.type||"DROP_ANIMATE"===t.type||"FLUSH"===t.type}(n)&&e.stop(),t(n)}}},Tn=function(){var t=[];return{add:function(e){var n=setTimeout((function(){return function(e){var n=Ft(t,(function(t){return t.timerId===e}));-1===n&&pt(!1),t.splice(n,1)[0].callback()}(n)})),i={timerId:n,callback:e};t.push(i)},flush:function(){if(t.length){var e=[].concat(t);t.length=0,e.forEach((function(t){clearTimeout(t.timerId),t.callback()}))}}}},Nn=function(t,e){Ve(),e(),Ze()},Ln=function(t,e){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:e}},Dn=function(t,e,n,i){if(t){var r=function(t){var e=!1,n=!1,i=setTimeout((function(){n=!0})),r=function(r){e||n||(e=!0,t(r),clearTimeout(i))};return r.wasCalled=function(){return e},r}(n);t(e,{announce:r}),r.wasCalled()||n(i(e))}else n(i(e))},In=function(t,e){var n=function(t,e){var n=Tn(),i=null,r=function(n){i||pt(!1),i=null,Nn(0,(function(){return Dn(t().onDragEnd,n,e,xt)}))};return{beforeCapture:function(e,n){i&&pt(!1),Nn(0,(function(){var i=t().onBeforeCapture;i&&i({draggableId:e,mode:n})}))},beforeStart:function(e,n){i&&pt(!1),Nn(0,(function(){var i=t().onBeforeDragStart;i&&i(Ln(e,n))}))},start:function(r,a){i&&pt(!1);var o=Ln(r,a);i={mode:a,lastCritical:r,lastLocation:o.source,lastCombine:null},n.add((function(){Nn(0,(function(){return Dn(t().onDragStart,o,e,_t)}))}))},update:function(r,a){var s=Gt(a),l=Vt(a);i||pt(!1);var c=!function(t,e){if(t===e)return!0;var n=t.draggable.id===e.draggable.id&&t.draggable.droppableId===e.draggable.droppableId&&t.draggable.type===e.draggable.type&&t.draggable.index===e.draggable.index,i=t.droppable.id===e.droppable.id&&t.droppable.type===e.droppable.type;return n&&i}(r,i.lastCritical);c&&(i.lastCritical=r);var u,h,d=(u=i.lastLocation,h=s,!(null==u&&null==h||null!=u&&null!=h&&u.droppableId===h.droppableId&&u.index===h.index));d&&(i.lastLocation=s);var p=!function(t,e){return null==t&&null==e||null!=t&&null!=e&&(t.draggableId===e.draggableId&&t.droppableId===e.droppableId)}(i.lastCombine,l);if(p&&(i.lastCombine=l),c||d||p){var f=Object(o.a)({},Ln(r,i.mode),{combine:l,destination:s});n.add((function(){Nn(0,(function(){return Dn(t().onDragUpdate,f,e,wt)}))}))}},flush:function(){i||pt(!1),n.flush()},drop:r,abort:function(){if(i){var t=Object(o.a)({},Ln(i.lastCritical,i.mode),{combine:null,destination:null,reason:"CANCEL"});r(t)}}}}(t,e);return function(t){return function(e){return function(i){if("BEFORE_INITIAL_CAPTURE"!==i.type){if("INITIAL_PUBLISH"===i.type){var r=i.payload.critical;return n.beforeStart(r,i.payload.movementMode),e(i),void n.start(r,i.payload.movementMode)}if("DROP_COMPLETE"===i.type){var a=i.payload.completed.result;return n.flush(),e(i),void n.drop(a)}if(e(i),"FLUSH"!==i.type){var o=t.getState();"DRAGGING"===o.phase&&n.update(o.critical,o.impact)}else n.abort()}else n.beforeCapture(i.payload.draggableId,i.payload.movementMode)}}}},Pn=function(t){return function(e){return function(n){if("DROP_ANIMATION_FINISHED"===n.type){var i=t.getState();"DROP_ANIMATING"!==i.phase&&pt(!1),t.dispatch(dn({completed:i.completed}))}else e(n)}}},jn=function(t){var e=null,n=null;return function(i){return function(r){if("FLUSH"!==r.type&&"DROP_COMPLETE"!==r.type&&"DROP_ANIMATION_FINISHED"!==r.type||(n&&(cancelAnimationFrame(n),n=null),e&&(e(),e=null)),i(r),"DROP_ANIMATE"===r.type){var a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){"DROP_ANIMATING"===t.getState().phase&&t.dispatch({type:"DROP_ANIMATION_FINISHED",payload:null})}};n=requestAnimationFrame((function(){n=null,e=ht(window,[a])}))}}}},Rn=function(t){return function(e){return function(n){if(e(n),"PUBLISH_WHILE_DRAGGING"===n.type){var i=t.getState();"DROP_PENDING"===i.phase&&(i.isWaiting||t.dispatch(pn({reason:i.reason})))}}}},Fn=s.d,Bn=function(t){var e,n=t.dimensionMarshal,i=t.focusMarshal,r=t.styleMarshal,a=t.getResponders,o=t.announce,l=t.autoScroller;return Object(s.e)(tn,Fn(Object(s.a)((e=r,function(){return function(t){return function(n){"INITIAL_PUBLISH"===n.type&&e.dragging(),"DROP_ANIMATE"===n.type&&e.dropping(n.payload.completed.result.reason),"FLUSH"!==n.type&&"DROP_COMPLETE"!==n.type||e.resting(),t(n)}}}),function(t){return function(){return function(e){return function(n){"DROP_COMPLETE"!==n.type&&"FLUSH"!==n.type&&"DROP_ANIMATE"!==n.type||t.stopPublishing(),e(n)}}}}(n),function(t){return function(e){var n=e.getState,i=e.dispatch;return function(e){return function(r){if("LIFT"===r.type){var a=r.payload,o=a.id,s=a.clientSelection,l=a.movementMode,c=n();"DROP_ANIMATING"===c.phase&&i(dn({completed:c.completed})),"IDLE"!==n().phase&&pt(!1),i({type:"FLUSH",payload:null}),i({type:"BEFORE_INITIAL_CAPTURE",payload:{draggableId:o,movementMode:l}});var u={draggableId:o,scrollOptions:{shouldPublishImmediately:"SNAP"===l}},h=t.startPublishing(u),d=h.critical,p=h.dimensions,f=h.viewport;i(function(t){return{type:"INITIAL_PUBLISH",payload:t}}({critical:d,dimensions:p,clientSelection:s,movementMode:l,viewport:f}))}else e(r)}}}}(n),Mn,Pn,jn,Rn,function(t){return function(e){return function(n){return function(i){if(function(t){return"DROP_COMPLETE"===t.type||"DROP_ANIMATE"===t.type||"FLUSH"===t.type}(i))return t.stop(),void n(i);if("INITIAL_PUBLISH"===i.type){n(i);var r=e.getState();return"DRAGGING"!==r.phase&&pt(!1),void t.start(r)}n(i),t.scroll(e.getState())}}}}(l),kn,function(t){var e=!1;return function(){return function(n){return function(i){if("INITIAL_PUBLISH"===i.type)return e=!0,t.tryRecordFocus(i.payload.critical.draggable.id),n(i),void t.tryRestoreFocusRecorded();if(n(i),e){if("FLUSH"===i.type)return e=!1,void t.tryRestoreFocusRecorded();if("DROP_COMPLETE"===i.type){e=!1;var r=i.payload.completed.result;r.combine&&t.tryShiftRecord(r.draggableId,r.combine.draggableId),t.tryRestoreFocusRecorded()}}}}}}(i),In(a,o))))};var Hn=function(t){var e=t.scrollHeight,n=t.scrollWidth,i=t.height,r=t.width,a=St({x:n,y:e},{x:r,y:i});return{x:Math.max(0,a.x),y:Math.max(0,a.y)}},$n=function(){var t=document.documentElement;return t||pt(!1),t},qn=function(){var t=$n();return Hn({scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth,width:t.clientWidth,height:t.clientHeight})},Un=function(t){var e=t.critical,n=t.scrollOptions,i=t.registry;Ve();var r,a,o,s,l,c,u,h=(r=An(),a=qn(),o=r.y,s=r.x,l=$n(),c=l.clientWidth,u=l.clientHeight,{frame:X({top:o,left:s,right:s+c,bottom:o+u}),scroll:{initial:r,current:r,max:a,diff:{value:Ct,displacement:Ct}}}),d=h.scroll.current,p=e.droppable,f=i.droppable.getAllByType(p.type).map((function(t){return t.callbacks.getDimensionAndWatchScroll(d,n)})),g=i.draggable.getAllByType(e.draggable.type).map((function(t){return t.getDimension(d)})),m={draggables:qt(g),droppables:$t(f)};return Ze(),{dimensions:m,critical:e,viewport:h}};function Wn(t,e,n){return n.descriptor.id!==e.id&&(n.descriptor.type===e.type&&"virtual"===t.droppable.getById(n.descriptor.droppableId).descriptor.mode)}var zn,Gn,Vn=function(t,e){var n=null,i=function(t){var e=t.registry,n=t.callbacks,i={additions:{},removals:{},modified:{}},r=null,a=function(){r||(n.collectionStarting(),r=requestAnimationFrame((function(){r=null,Ve();var t=i,a=t.additions,o=t.removals,s=t.modified,l=Object.keys(a).map((function(t){return e.draggable.getById(t).getDimension(Ct)})).sort((function(t,e){return t.descriptor.index-e.descriptor.index})),c=Object.keys(s).map((function(t){return{droppableId:t,scroll:e.droppable.getById(t).callbacks.getScrollWhileDragging()}})),u={additions:l,removals:Object.keys(o),modified:c};i={additions:{},removals:{},modified:{}},Ze(),n.publish(u)})))};return{add:function(t){var e=t.descriptor.id;i.additions[e]=t,i.modified[t.descriptor.droppableId]=!0,i.removals[e]&&delete i.removals[e],a()},remove:function(t){var e=t.descriptor;i.removals[e.id]=!0,i.modified[e.droppableId]=!0,i.additions[e.id]&&delete i.additions[e.id],a()},stop:function(){r&&(cancelAnimationFrame(r),r=null,i={additions:{},removals:{},modified:{}})}}}({callbacks:{publish:e.publishWhileDragging,collectionStarting:e.collectionStarting},registry:t}),r=function(e){n||pt(!1);var r=n.critical.draggable;"ADDITION"===e.type&&Wn(t,r,e.value)&&i.add(e.value),"REMOVAL"===e.type&&Wn(t,r,e.value)&&i.remove(e.value)};return{updateDroppableIsEnabled:function(i,r){t.droppable.exists(i)||pt(!1),n&&e.updateDroppableIsEnabled({id:i,isEnabled:r})},updateDroppableIsCombineEnabled:function(i,r){n&&(t.droppable.exists(i)||pt(!1),e.updateDroppableIsCombineEnabled({id:i,isCombineEnabled:r}))},scrollDroppable:function(e,i){n&&t.droppable.getById(e).callbacks.scroll(i)},updateDroppableScroll:function(i,r){n&&(t.droppable.exists(i)||pt(!1),e.updateDroppableScroll({id:i,newScroll:r}))},startPublishing:function(e){n&&pt(!1);var i=t.draggable.getById(e.draggableId),a=t.droppable.getById(i.descriptor.droppableId),o={draggable:i.descriptor,droppable:a.descriptor},s=t.subscribe(r);return n={critical:o,unsubscribe:s},Un({critical:o,registry:t,scrollOptions:e.scrollOptions})},stopPublishing:function(){if(n){i.stop();var e=n.critical.droppable;t.droppable.getAllByType(e.type).forEach((function(t){return t.callbacks.dragStopped()})),n.unsubscribe(),n=null}}}},Zn=function(t,e){return"IDLE"===t.phase||"DROP_ANIMATING"===t.phase&&(t.completed.result.draggableId!==e&&"DROP"===t.completed.result.reason)},Yn=function(t){window.scrollBy(t.x,t.y)},Xn=st((function(t){return Ut(t).filter((function(t){return!!t.isEnabled&&!!t.frame}))})),Kn=function(t){var e=t.center,n=t.destination,i=t.droppables;if(n){var r=i[n];return r.frame?r:null}return function(t,e){return Bt(Xn(e),(function(e){return e.frame||pt(!1),Pe(e.frame.pageMarginBox)(t)}))}(e,i)},Jn=.25,Qn=.05,ti=28,ei=function(t){return Math.pow(t,2)},ni={stopDampeningAt:1200,accelerateAt:360},ii=function(t){var e=t.startOfRange,n=t.endOfRange,i=t.current,r=n-e;return 0===r?0:(i-e)/r},ri=ni.accelerateAt,ai=ni.stopDampeningAt,oi=function(t){var e=t.distanceToEdge,n=t.thresholds,i=t.dragStartTime,r=t.shouldUseTimeDampening,a=function(t,e){if(t>e.startScrollingFrom)return 0;if(t<=e.maxScrollValueAt)return ti;if(t===e.startScrollingFrom)return 1;var n=ii({startOfRange:e.maxScrollValueAt,endOfRange:e.startScrollingFrom,current:t}),i=ti*ei(1-n);return Math.ceil(i)}(e,n);return 0===a?0:r?Math.max(function(t,e){var n=e,i=ai,r=Date.now()-n;if(r>=ai)return t;if(r<ri)return 1;var a=ii({startOfRange:ri,endOfRange:i,current:r}),o=t*ei(a);return Math.ceil(o)}(a,i),1):a},si=function(t){var e=t.container,n=t.distanceToEdges,i=t.dragStartTime,r=t.axis,a=t.shouldUseTimeDampening,o=function(t,e){return{startScrollingFrom:t[e.size]*Jn,maxScrollValueAt:t[e.size]*Qn}}(e,r);return n[r.end]<n[r.start]?oi({distanceToEdge:n[r.end],thresholds:o,dragStartTime:i,shouldUseTimeDampening:a}):-1*oi({distanceToEdge:n[r.start],thresholds:o,dragStartTime:i,shouldUseTimeDampening:a})},li=Nt((function(t){return 0===t?0:t})),ci=function(t){var e=t.dragStartTime,n=t.container,i=t.subject,r=t.center,a=t.shouldUseTimeDampening,o={top:r.y-n.top,right:n.right-r.x,bottom:n.bottom-r.y,left:r.x-n.left},s=si({container:n,distanceToEdges:o,dragStartTime:e,axis:ne,shouldUseTimeDampening:a}),l=si({container:n,distanceToEdges:o,dragStartTime:e,axis:ie,shouldUseTimeDampening:a}),c=li({x:l,y:s});if(Mt(c,Ct))return null;var u=function(t){var e=t.container,n=t.subject,i=t.proposedScroll,r=n.height>e.height,a=n.width>e.width;return a||r?a&&r?null:{x:a?0:i.x,y:r?0:i.y}:i}({container:n,subject:i,proposedScroll:c});return u?Mt(u,Ct)?null:u:null},ui=Nt((function(t){return 0===t?0:t>0?1:-1})),hi=(zn=function(t,e){return t<0?t:t>e?t-e:0},function(t){var e=t.current,n=t.max,i=t.change,r=Et(e,i),a={x:zn(r.x,n.x),y:zn(r.y,n.y)};return Mt(a,Ct)?null:a}),di=function(t){var e=t.max,n=t.current,i=t.change,r={x:Math.max(n.x,e.x),y:Math.max(n.y,e.y)},a=ui(i),o=hi({max:r,current:n,change:a});return!o||(0!==a.x&&0===o.x||0!==a.y&&0===o.y)},pi=function(t,e){return di({current:t.scroll.current,max:t.scroll.max,change:e})},fi=function(t,e){var n=t.frame;return!!n&&di({current:n.scroll.current,max:n.scroll.max,change:e})},gi=function(t){var e=t.state,n=t.dragStartTime,i=t.shouldUseTimeDampening,r=t.scrollWindow,a=t.scrollDroppable,o=e.current.page.borderBoxCenter,s=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){var l=function(t){var e=t.viewport,n=t.subject,i=t.center,r=t.dragStartTime,a=t.shouldUseTimeDampening,o=ci({dragStartTime:r,container:e.frame,subject:n,center:i,shouldUseTimeDampening:a});return o&&pi(e,o)?o:null}({dragStartTime:n,viewport:e.viewport,subject:s,center:o,shouldUseTimeDampening:i});if(l)return void r(l)}var c=Kn({center:o,destination:Le(e.impact),droppables:e.dimensions.droppables});if(c){var u=function(t){var e=t.droppable,n=t.subject,i=t.center,r=t.dragStartTime,a=t.shouldUseTimeDampening,o=e.frame;if(!o)return null;var s=ci({dragStartTime:r,container:o.pageMarginBox,subject:n,center:i,shouldUseTimeDampening:a});return s&&fi(e,s)?s:null}({dragStartTime:n,droppable:c,subject:s,center:o,shouldUseTimeDampening:i});u&&a(c.descriptor.id,u)}},mi=function(t){var e=t.move,n=t.scrollDroppable,i=t.scrollWindow,r=function(t,e){if(!fi(t,e))return e;var i=function(t,e){var n=t.frame;return n&&fi(t,e)?hi({current:n.scroll.current,max:n.scroll.max,change:e}):null}(t,e);if(!i)return n(t.descriptor.id,e),null;var r=St(e,i);return n(t.descriptor.id,r),St(e,r)},a=function(t,e,n){if(!t)return n;if(!pi(e,n))return n;var r=function(t,e){if(!pi(t,e))return null;var n=t.scroll.max,i=t.scroll.current;return hi({current:i,max:n,change:e})}(e,n);if(!r)return i(n),null;var a=St(n,r);return i(a),St(n,a)};return function(t){var n=t.scrollJumpRequest;if(n){var i=Le(t.impact);i||pt(!1);var o=r(t.dimensions.droppables[i],n);if(o){var s=t.viewport,l=a(t.isWindowScrollAllowed,s,o);l&&function(t,n){var i=Et(t.current.client.selection,n);e({client:i})}(t,l)}}}},bi=function(t){var e=t.scrollDroppable,n=t.scrollWindow,i=t.move,r=function(t){var e=t.scrollWindow,n=t.scrollDroppable,i=lt(e),r=lt(n),a=null,o=function(t){a||pt(!1);var e=a,n=e.shouldUseTimeDampening,o=e.dragStartTime;gi({state:t,scrollWindow:i,scrollDroppable:r,dragStartTime:o,shouldUseTimeDampening:n})};return{start:function(t){Ve(),a&&pt(!1);var e=Date.now(),n=!1,i=function(){n=!0};gi({state:t,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:i,scrollDroppable:i}),a={dragStartTime:e,shouldUseTimeDampening:n},Ze(),n&&o(t)},stop:function(){a&&(i.cancel(),r.cancel(),a=null)},scroll:o}}({scrollWindow:n,scrollDroppable:e}),a=mi({move:i,scrollWindow:n,scrollDroppable:e});return{scroll:function(t){"DRAGGING"===t.phase&&("FLUID"!==t.movementMode?t.scrollJumpRequest&&a(t):r.scroll(t))},start:r.start,stop:r.stop}},vi={base:Gn="data-rbd-drag-handle",draggableId:Gn+"-draggable-id",contextId:Gn+"-context-id"},yi=function(){var t="data-rbd-draggable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),_i=function(){var t="data-rbd-droppable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),wi={contextId:"data-rbd-scroll-container-context-id"},xi=function(t,e){return t.map((function(t){var n=t.styles[e];return n?t.selector+" { "+n+" }":""})).join(" ")},Ci="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?i.useLayoutEffect:i.useEffect,Ei=function(){var t=document.querySelector("head");return t||pt(!1),t},Si=function(t){var e=document.createElement("style");return t&&e.setAttribute("nonce",t),e.type="text/css",e};function Mi(t,e){var n=V((function(){return function(t){var e,n,i,r=(e=t,function(t){return"["+t+'="'+e+'"]'}),a=(n="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ",{selector:r(vi.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:n,dragging:"pointer-events: none;",dropAnimating:n}}),o=[(i="\n      transition: "+yn.outOfTheWay+";\n    ",{selector:r(yi.contextId),styles:{dragging:i,dropAnimating:i,userCancel:i}}),a,{selector:r(_i.contextId),styles:{always:"overflow-anchor: none;"}},{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:xi(o,"always"),resting:xi(o,"resting"),dragging:xi(o,"dragging"),dropAnimating:xi(o,"dropAnimating"),userCancel:xi(o,"userCancel")}}(t)}),[t]),r=Object(i.useRef)(null),a=Object(i.useRef)(null),o=Z(st((function(t){var e=a.current;e||pt(!1),e.textContent=t})),[]),s=Z((function(t){var e=r.current;e||pt(!1),e.textContent=t}),[]);Ci((function(){(r.current||a.current)&&pt(!1);var i=Si(e),l=Si(e);return r.current=i,a.current=l,i.setAttribute("data-rbd-always",t),l.setAttribute("data-rbd-dynamic",t),Ei().appendChild(i),Ei().appendChild(l),s(n.always),o(n.resting),function(){var t=function(t){var e=t.current;e||pt(!1),Ei().removeChild(e),t.current=null};t(r),t(a)}}),[e,s,o,n.always,n.resting,t]);var l=Z((function(){return o(n.dragging)}),[o,n.dragging]),c=Z((function(t){o("DROP"!==t?n.userCancel:n.dropAnimating)}),[o,n.dropAnimating,n.userCancel]),u=Z((function(){a.current&&o(n.resting)}),[o,n.resting]);return V((function(){return{dragging:l,dropping:c,resting:u}}),[l,c,u])}var Ai=function(t){return t&&t.ownerDocument?t.ownerDocument.defaultView:window};function Oi(t){return t instanceof Ai(t).HTMLElement}function ki(t,e){var n="["+vi.contextId+'="'+t+'"]',i=Ht(document.querySelectorAll(n));if(!i.length)return null;var r=Bt(i,(function(t){return t.getAttribute(vi.draggableId)===e}));return r&&Oi(r)?r:null}function Ti(){var t={draggables:{},droppables:{}},e=[];function n(t){e.length&&e.forEach((function(e){return e(t)}))}function i(e){return t.draggables[e]||null}function r(e){return t.droppables[e]||null}return{draggable:{register:function(e){t.draggables[e.descriptor.id]=e,n({type:"ADDITION",value:e})},update:function(e,n){var i=t.draggables[n.descriptor.id];i&&i.uniqueId===e.uniqueId&&(delete t.draggables[n.descriptor.id],t.draggables[e.descriptor.id]=e)},unregister:function(e){var r=e.descriptor.id,a=i(r);a&&e.uniqueId===a.uniqueId&&(delete t.draggables[r],n({type:"REMOVAL",value:e}))},getById:function(t){var e=i(t);return e||pt(!1),e},findById:i,exists:function(t){return Boolean(i(t))},getAllByType:function(e){return Rt(t.draggables).filter((function(t){return t.descriptor.type===e}))}},droppable:{register:function(e){t.droppables[e.descriptor.id]=e},unregister:function(e){var n=r(e.descriptor.id);n&&e.uniqueId===n.uniqueId&&delete t.droppables[e.descriptor.id]},getById:function(t){var e=r(t);return e||pt(!1),e},findById:r,exists:function(t){return Boolean(r(t))},getAllByType:function(e){return Rt(t.droppables).filter((function(t){return t.descriptor.type===e}))}},subscribe:function(t){return e.push(t),function(){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},clean:function(){t.draggables={},t.droppables={},e.length=0}}}var Ni=r.a.createContext(null),Li=function(){var t=document.body;return t||pt(!1),t},Di={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"};var Ii=0,Pi={separator:"::"};function ji(t,e){return void 0===e&&(e=Pi),V((function(){return""+t+e.separator+Ii++}),[e.separator,t])}var Ri=r.a.createContext(null);function Fi(t){0}function Bi(t,e){Fi()}function Hi(){Bi()}function $i(t){var e=Object(i.useRef)(t);return Object(i.useEffect)((function(){e.current=t})),e}var qi,Ui=((qi={})[13]=!0,qi[9]=!0,qi),Wi=function(t){Ui[t.keyCode]&&t.preventDefault()},zi=function(){var t="visibilitychange";return"undefined"==typeof document?t:Bt([t,"ms"+t,"webkit"+t,"moz"+t,"o"+t],(function(t){return"on"+t in document}))||t}();var Gi,Vi={type:"IDLE"};function Zi(t){var e=t.cancel,n=t.completed,i=t.getPhase,r=t.setPhase;return[{eventName:"mousemove",fn:function(t){var e=t.button,n=t.clientX,a=t.clientY;if(0===e){var o={x:n,y:a},s=i();if("DRAGGING"===s.type)return t.preventDefault(),void s.actions.move(o);"PENDING"!==s.type&&pt(!1);var l=s.point;if(c=l,u=o,Math.abs(u.x-c.x)>=5||Math.abs(u.y-c.y)>=5){var c,u;t.preventDefault();var h=s.actions.fluidLift(o);r({type:"DRAGGING",actions:h})}}}},{eventName:"mouseup",fn:function(t){var r=i();"DRAGGING"===r.type?(t.preventDefault(),r.actions.drop({shouldBlockNextClick:!0}),n()):e()}},{eventName:"mousedown",fn:function(t){"DRAGGING"===i().type&&t.preventDefault(),e()}},{eventName:"keydown",fn:function(t){if("PENDING"!==i().type)return 27===t.keyCode?(t.preventDefault(),void e()):void Wi(t);e()}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){"PENDING"===i().type&&e()}},{eventName:"webkitmouseforcedown",fn:function(t){var n=i();"IDLE"===n.type&&pt(!1),n.actions.shouldRespectForcePress()?e():t.preventDefault()}},{eventName:zi,fn:e}]}function Yi(){}var Xi=((Gi={})[34]=!0,Gi[33]=!0,Gi[36]=!0,Gi[35]=!0,Gi);function Ki(t,e){function n(){e(),t.cancel()}return[{eventName:"keydown",fn:function(i){return 27===i.keyCode?(i.preventDefault(),void n()):32===i.keyCode?(i.preventDefault(),e(),void t.drop()):40===i.keyCode?(i.preventDefault(),void t.moveDown()):38===i.keyCode?(i.preventDefault(),void t.moveUp()):39===i.keyCode?(i.preventDefault(),void t.moveRight()):37===i.keyCode?(i.preventDefault(),void t.moveLeft()):void(Xi[i.keyCode]?i.preventDefault():Wi(i))}},{eventName:"mousedown",fn:n},{eventName:"mouseup",fn:n},{eventName:"click",fn:n},{eventName:"touchstart",fn:n},{eventName:"resize",fn:n},{eventName:"wheel",fn:n,options:{passive:!0}},{eventName:zi,fn:n}]}var Ji={type:"IDLE"};var Qi={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function tr(t,e){var n=e.target;return!!Oi(n)&&function t(e,n){if(null==n)return!1;if(Boolean(Qi[n.tagName.toLowerCase()]))return!0;var i=n.getAttribute("contenteditable");return"true"===i||""===i||n!==e&&t(e,n.parentElement)}(t,n)}var er=function(t){return X(t.getBoundingClientRect()).center};var nr="undefined"==typeof document?"matches":Bt(["matches","msMatchesSelector","webkitMatchesSelector"],(function(t){return t in Element.prototype}))||"matches";function ir(t,e){return t.closest?t.closest(e):function t(e,n){return null==e?null:e[nr](n)?e:t(e.parentElement,n)}(t,e)}function rr(t,e){var n,i=e.target;if(!((n=i)instanceof Ai(n).Element))return null;var r=ir(i,function(t){return"["+vi.contextId+'="'+t+'"]'}(t));return r&&Oi(r)?r:null}function ar(t){t.preventDefault()}function or(t){var e=t.expected,n=t.phase,i=t.isLockActive;t.shouldWarn;return!!i()&&e===n}function sr(t){var e=t.lockAPI,n=t.store,i=t.registry,r=t.draggableId;if(e.isClaimed())return!1;var a=i.draggable.findById(r);return!!a&&(!!a.options.isEnabled&&!!Zn(n.getState(),r))}function lr(t){var e=t.lockAPI,n=t.contextId,i=t.store,r=t.registry,a=t.draggableId,s=t.forceSensorStop,l=t.sourceEvent;if(!sr({lockAPI:e,store:i,registry:r,draggableId:a}))return null;var c=r.draggable.getById(a),u=function(t,e){var n="["+yi.contextId+'="'+t+'"]',i=Bt(Ht(document.querySelectorAll(n)),(function(t){return t.getAttribute(yi.id)===e}));return i&&Oi(i)?i:null}(n,c.descriptor.id);if(!u)return null;if(l&&!c.options.canDragInteractiveElements&&tr(u,l))return null;var h=e.claim(s||ut),d="PRE_DRAG";function p(){return c.options.shouldRespectForcePress}function f(){return e.isActive(h)}var g=function(t,e){or({expected:t,phase:d,isLockActive:f,shouldWarn:!0})&&i.dispatch(e())}.bind(null,"DRAGGING");function m(t){function n(){e.release(),d="COMPLETED"}function r(e,r){if(void 0===r&&(r={shouldBlockNextClick:!1}),t.cleanup(),r.shouldBlockNextClick){var a=ht(window,[{eventName:"click",fn:ar,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(a)}n(),i.dispatch(pn({reason:e}))}return"PRE_DRAG"!==d&&(n(),"PRE_DRAG"!==d&&pt(!1)),i.dispatch(function(t){return{type:"LIFT",payload:t}}(t.liftActionArgs)),d="DRAGGING",Object(o.a)({isActive:function(){return or({expected:"DRAGGING",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,drop:function(t){return r("DROP",t)},cancel:function(t){return r("CANCEL",t)}},t.actions)}return{isActive:function(){return or({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,fluidLift:function(t){var e=lt((function(t){g((function(){return sn({client:t})}))})),n=m({liftActionArgs:{id:a,clientSelection:t,movementMode:"FLUID"},cleanup:function(){return e.cancel()},actions:{move:e}});return Object(o.a)({},n,{move:e})},snapLift:function(){var t={moveUp:function(){return g(ln)},moveRight:function(){return g(un)},moveDown:function(){return g(cn)},moveLeft:function(){return g(hn)}};return m({liftActionArgs:{id:a,clientSelection:er(u),movementMode:"SNAP"},cleanup:ut,actions:t})},abort:function(){or({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!0})&&e.release()}}}var cr=[function(t){var e=Object(i.useRef)(Vi),n=Object(i.useRef)(ut),r=V((function(){return{eventName:"mousedown",fn:function(e){if(!e.defaultPrevented&&0===e.button&&!(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)){var i=t.findClosestDraggableId(e);if(i){var r=t.tryGetLock(i,s,{sourceEvent:e});if(r){e.preventDefault();var a={x:e.clientX,y:e.clientY};n.current(),u(r,a)}}}}}}),[t]),a=V((function(){return{eventName:"webkitmouseforcewillbegin",fn:function(e){if(!e.defaultPrevented){var n=t.findClosestDraggableId(e);if(n){var i=t.findOptionsForDraggable(n);i&&(i.shouldRespectForcePress||t.canGetLock(n)&&e.preventDefault())}}}}}),[t]),o=Z((function(){n.current=ht(window,[a,r],{passive:!1,capture:!0})}),[a,r]),s=Z((function(){"IDLE"!==e.current.type&&(e.current=Vi,n.current(),o())}),[o]),l=Z((function(){var t=e.current;s(),"DRAGGING"===t.type&&t.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===t.type&&t.actions.abort()}),[s]),c=Z((function(){var t=Zi({cancel:l,completed:s,getPhase:function(){return e.current},setPhase:function(t){e.current=t}});n.current=ht(window,t,{capture:!0,passive:!1})}),[l,s]),u=Z((function(t,n){"IDLE"!==e.current.type&&pt(!1),e.current={type:"PENDING",point:n,actions:t},c()}),[c]);Ci((function(){return o(),function(){n.current()}}),[o])},function(t){var e=Object(i.useRef)(Yi),n=V((function(){return{eventName:"keydown",fn:function(n){if(!n.defaultPrevented&&32===n.keyCode){var i=t.findClosestDraggableId(n);if(i){var a=t.tryGetLock(i,l,{sourceEvent:n});if(a){n.preventDefault();var o=!0,s=a.snapLift();e.current(),e.current=ht(window,Ki(s,l),{capture:!0,passive:!1})}}}function l(){o||pt(!1),o=!1,e.current(),r()}}}}),[t]),r=Z((function(){e.current=ht(window,[n],{passive:!1,capture:!0})}),[n]);Ci((function(){return r(),function(){e.current()}}),[r])},function(t){var e=Object(i.useRef)(Ji),n=Object(i.useRef)(ut),r=Z((function(){return e.current}),[]),a=Z((function(t){e.current=t}),[]),o=V((function(){return{eventName:"touchstart",fn:function(e){if(!e.defaultPrevented){var i=t.findClosestDraggableId(e);if(i){var r=t.tryGetLock(i,l,{sourceEvent:e});if(r){var a=e.touches[0],o={x:a.clientX,y:a.clientY};n.current(),d(r,o)}}}}}}),[t]),s=Z((function(){n.current=ht(window,[o],{capture:!0,passive:!1})}),[o]),l=Z((function(){var t=e.current;"IDLE"!==t.type&&("PENDING"===t.type&&clearTimeout(t.longPressTimerId),a(Ji),n.current(),s())}),[s,a]),c=Z((function(){var t=e.current;l(),"DRAGGING"===t.type&&t.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===t.type&&t.actions.abort()}),[l]),u=Z((function(){var t={capture:!0,passive:!1},e={cancel:c,completed:l,getPhase:r},i=ht(window,function(t){var e=t.cancel,n=t.completed,i=t.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(t){var n=i();if("DRAGGING"===n.type){n.hasMoved=!0;var r=t.touches[0],a={x:r.clientX,y:r.clientY};t.preventDefault(),n.actions.move(a)}else e()}},{eventName:"touchend",fn:function(t){var r=i();"DRAGGING"===r.type?(t.preventDefault(),r.actions.drop({shouldBlockNextClick:!0}),n()):e()}},{eventName:"touchcancel",fn:function(t){"DRAGGING"===i().type?(t.preventDefault(),e()):e()}},{eventName:"touchforcechange",fn:function(t){var n=i();"IDLE"===n.type&&pt(!1);var r=t.touches[0];if(r&&r.force>=.15){var a=n.actions.shouldRespectForcePress();if("PENDING"!==n.type)return a?n.hasMoved?void t.preventDefault():void e():void t.preventDefault();a&&e()}}},{eventName:zi,fn:e}]}(e),t),a=ht(window,function(t){var e=t.cancel,n=t.getPhase;return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:function(t){t.preventDefault()}},{eventName:"keydown",fn:function(t){"DRAGGING"===n().type?(27===t.keyCode&&t.preventDefault(),e()):e()}},{eventName:zi,fn:e}]}(e),t);n.current=function(){i(),a()}}),[c,r,l]),h=Z((function(){var t=r();"PENDING"!==t.type&&pt(!1);var e=t.actions.fluidLift(t.point);a({type:"DRAGGING",actions:e,hasMoved:!1})}),[r,a]),d=Z((function(t,e){"IDLE"!==r().type&&pt(!1);var n=setTimeout(h,120);a({type:"PENDING",point:e,actions:t,longPressTimerId:n}),u()}),[u,r,a,h]);Ci((function(){return s(),function(){n.current();var t=r();"PENDING"===t.type&&(clearTimeout(t.longPressTimerId),a(Ji))}}),[r,s,a]),Ci((function(){return ht(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}])}),[])}];function ur(t){var e=t.contextId,n=t.store,r=t.registry,a=t.customSensors,o=t.enableDefaultSensors,s=[].concat(o?cr:[],a||[]),l=Object(i.useState)((function(){return function(){var t=null;function e(){t||pt(!1),t=null}return{isClaimed:function(){return Boolean(t)},isActive:function(e){return e===t},claim:function(e){t&&pt(!1);var n={abandon:e};return t=n,n},release:e,tryAbandon:function(){t&&(t.abandon(),e())}}}()}))[0],c=Z((function(t,e){t.isDragging&&!e.isDragging&&l.tryAbandon()}),[l]);Ci((function(){var t=n.getState();return n.subscribe((function(){var e=n.getState();c(t,e),t=e}))}),[l,n,c]),Ci((function(){return l.tryAbandon}),[l.tryAbandon]);var u=Z((function(t){return sr({lockAPI:l,registry:r,store:n,draggableId:t})}),[l,r,n]),h=Z((function(t,i,a){return lr({lockAPI:l,registry:r,contextId:e,store:n,draggableId:t,forceSensorStop:i,sourceEvent:a&&a.sourceEvent?a.sourceEvent:null})}),[e,l,r,n]),d=Z((function(t){return function(t,e){var n=rr(t,e);return n?n.getAttribute(vi.draggableId):null}(e,t)}),[e]),p=Z((function(t){var e=r.draggable.findById(t);return e?e.options:null}),[r.draggable]),f=Z((function(){l.isClaimed()&&(l.tryAbandon(),"IDLE"!==n.getState().phase&&n.dispatch({type:"FLUSH",payload:null}))}),[l,n]),g=Z(l.isClaimed,[l]),m=V((function(){return{canGetLock:u,tryGetLock:h,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:f,isLockClaimed:g}}),[u,h,d,p,f,g]);Fi();for(var b=0;b<s.length;b++)s[b](m)}function hr(t){return t.current||pt(!1),t.current}function dr(t){var e=t.contextId,n=t.setCallbacks,a=t.sensors,l=t.nonce,c=t.dragHandleUsageInstructions,u=Object(i.useRef)(null);Hi();var h=$i(t),d=Z((function(){return function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}}(h.current)}),[h]),f=function(t){var e=V((function(){return function(t){return"rbd-announcement-"+t}(t)}),[t]),n=Object(i.useRef)(null);return Object(i.useEffect)((function(){var t=document.createElement("div");return n.current=t,t.id=e,t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),Object(o.a)(t.style,Di),Li().appendChild(t),function(){setTimeout((function(){var e=Li();e.contains(t)&&e.removeChild(t),t===n.current&&(n.current=null)}))}}),[e]),Z((function(t){var e=n.current;e&&(e.textContent=t)}),[])}(e),g=function(t){var e=t.contextId,n=t.text,r=ji("hidden-text",{separator:"-"}),a=V((function(){return"rbd-hidden-text-"+(t={contextId:e,uniqueId:r}).contextId+"-"+t.uniqueId;var t}),[r,e]);return Object(i.useEffect)((function(){var t=document.createElement("div");return t.id=a,t.textContent=n,t.style.display="none",Li().appendChild(t),function(){var e=Li();e.contains(t)&&e.removeChild(t)}}),[a,n]),a}({contextId:e,text:c}),m=Mi(e,l),b=Z((function(t){hr(u).dispatch(t)}),[]),v=V((function(){return Object(s.b)({publishWhileDragging:en,updateDroppableScroll:rn,updateDroppableIsEnabled:an,updateDroppableIsCombineEnabled:on,collectionStarting:nn},b)}),[b]),y=function(){var t=V(Ti,[]);return Object(i.useEffect)((function(){return function(){requestAnimationFrame(t.clean)}}),[t]),t}(),_=V((function(){return Vn(y,v)}),[y,v]),w=V((function(){return bi(Object(o.a)({scrollWindow:Yn,scrollDroppable:_.scrollDroppable},Object(s.b)({move:sn},b)))}),[_.scrollDroppable,b]),x=function(t){var e=Object(i.useRef)({}),n=Object(i.useRef)(null),r=Object(i.useRef)(null),a=Object(i.useRef)(!1),o=Z((function(t,n){var i={id:t,focus:n};return e.current[t]=i,function(){var n=e.current;n[t]!==i&&delete n[t]}}),[]),s=Z((function(e){var n=ki(t,e);n&&n!==document.activeElement&&n.focus()}),[t]),l=Z((function(t,e){n.current===t&&(n.current=e)}),[]),c=Z((function(){r.current||a.current&&(r.current=requestAnimationFrame((function(){r.current=null;var t=n.current;t&&s(t)})))}),[s]),u=Z((function(t){n.current=null;var e=document.activeElement;e&&e.getAttribute(vi.draggableId)===t&&(n.current=t)}),[]);return Ci((function(){return a.current=!0,function(){a.current=!1;var t=r.current;t&&cancelAnimationFrame(t)}}),[]),V((function(){return{register:o,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}}),[o,u,c,l])}(e),C=V((function(){return Bn({announce:f,autoScroller:w,dimensionMarshal:_,focusMarshal:x,getResponders:d,styleMarshal:m})}),[f,w,_,x,d,m]);u.current=C;var E=Z((function(){var t=hr(u);"IDLE"!==t.getState().phase&&t.dispatch({type:"FLUSH",payload:null})}),[]),S=Z((function(){var t=hr(u).getState();return t.isDragging||"DROP_ANIMATING"===t.phase}),[]);n(V((function(){return{isDragging:S,tryAbort:E}}),[S,E]));var M=Z((function(t){return Zn(hr(u).getState(),t)}),[]),A=Z((function(){return Ie(hr(u).getState())}),[]),O=V((function(){return{marshal:_,focus:x,contextId:e,canLift:M,isMovementAllowed:A,dragHandleUsageInstructionsId:g,registry:y}}),[e,_,g,x,M,A,y]);return ur({contextId:e,store:C,registry:y,customSensors:a,enableDefaultSensors:!1!==t.enableDefaultSensors}),Object(i.useEffect)((function(){return E}),[E]),r.a.createElement(Ri.Provider,{value:O},r.a.createElement(p,{context:Ni,store:C},t.children))}var pr=0;function fr(t){var e=V((function(){return""+pr++}),[]),n=t.dragHandleUsageInstructions||yt;return r.a.createElement(ft,null,(function(i){return r.a.createElement(dr,{nonce:t.nonce,contextId:e,setCallbacks:i,dragHandleUsageInstructions:n,enableDefaultSensors:t.enableDefaultSensors,sensors:t.sensors,onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragUpdate:t.onDragUpdate,onDragEnd:t.onDragEnd},t.children)}))}var gr=function(t){return function(e){return t===e}},mr=gr("scroll"),br=gr("auto"),vr=(gr("visible"),function(t,e){return e(t.overflowX)||e(t.overflowY)}),yr=function(t){var e=window.getComputedStyle(t),n={overflowX:e.overflowX,overflowY:e.overflowY};return vr(n,mr)||vr(n,br)},_r=function t(e){return null==e||e===document.body||e===document.documentElement?null:yr(e)?e:t(e.parentElement)},wr=function(t){return{x:t.scrollLeft,y:t.scrollTop}},xr=function(t){return{closestScrollable:_r(t),isFixedOnPage:function t(e){return!!e&&("fixed"===window.getComputedStyle(e).position||t(e.parentElement))}(t)}},Cr=function(t){var e=t.ref,n=t.descriptor,i=t.env,r=t.windowScroll,a=t.direction,o=t.isDropDisabled,s=t.isCombineEnabled,l=t.shouldClipSubject,c=i.closestScrollable,u=function(t,e){var n=at(t);if(!e)return n;if(t!==e)return n;var i=n.paddingBox.top-e.scrollTop,r=n.paddingBox.left-e.scrollLeft,a=i+e.scrollHeight,o=r+e.scrollWidth,s=K({top:i,right:o,bottom:a,left:r},n.border);return tt({borderBox:s,margin:n.margin,border:n.border,padding:n.padding})}(e,c),h=it(u,r),d=function(){if(!c)return null;var t=at(c),e={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:t,page:it(t,r),scroll:wr(c),scrollSize:e,shouldClipSubject:l}}();return function(t){var e=t.descriptor,n=t.isEnabled,i=t.isCombineEnabled,r=t.isFixedOnPage,a=t.direction,o=t.client,s=t.page,l=t.closest,c=function(){if(!l)return null;var t=l.scrollSize,e=l.client,n=Hn({scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth,height:e.paddingBox.height,width:e.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:e,scrollSize:t,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:n,diff:{value:Ct,displacement:Ct}}}}(),u="vertical"===a?ne:ie;return{descriptor:e,isCombineEnabled:i,isFixedOnPage:r,axis:u,isEnabled:n,client:o,page:s,frame:c,subject:Pt({page:s,withPlaceholder:null,axis:u,frame:c})}}({descriptor:n,isEnabled:!o,isCombineEnabled:s,isFixedOnPage:i.isFixedOnPage,direction:a,client:u,page:h,closest:d})},Er={passive:!1},Sr={passive:!0},Mr=function(t){return t.shouldPublishImmediately?Er:Sr};function Ar(t){var e=Object(i.useContext)(t);return e||pt(!1),e}var Or=function(t){return t&&t.env.closestScrollable||null};function kr(){}var Tr={width:0,height:0,margin:{top:0,right:0,bottom:0,left:0}},Nr=function(t){var e=t.isAnimatingOpenOnMount,n=t.placeholder,i=t.animate,r=function(t){var e=t.isAnimatingOpenOnMount,n=t.placeholder,i=t.animate;return e||"close"===i?Tr:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}}({isAnimatingOpenOnMount:e,placeholder:n,animate:i});return{display:n.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:"none"!==i?yn.placeholder:null}};var Lr=r.a.memo((function(t){var e=Object(i.useRef)(null),n=Z((function(){e.current&&(clearTimeout(e.current),e.current=null)}),[]),a=t.animate,o=t.onTransitionEnd,s=t.onClose,l=t.contextId,c=Object(i.useState)("open"===t.animate),u=c[0],h=c[1];Object(i.useEffect)((function(){return u?"open"!==a?(n(),h(!1),kr):e.current?kr:(e.current=setTimeout((function(){e.current=null,h(!1)})),n):kr}),[a,u,n]);var d=Z((function(t){"height"===t.propertyName&&(o(),"close"===a&&s())}),[a,s,o]),p=Nr({isAnimatingOpenOnMount:u,animate:t.animate,placeholder:t.placeholder});return r.a.createElement(t.placeholder.tagName,{style:p,"data-rbd-placeholder-context-id":l,onTransitionEnd:d,ref:t.innerRef})})),Dr=r.a.createContext(null);var Ir=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).state={isVisible:Boolean(e.props.on),data:e.props.on,animate:e.props.shouldAnimate&&e.props.on?"open":"none"},e.onClose=function(){"close"===e.state.animate&&e.setState({isVisible:!1})},e}return Object(a.a)(e,t),e.getDerivedStateFromProps=function(t,e){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:e.isVisible?{isVisible:!0,data:e.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:Boolean(t.on),data:t.on,animate:"none"}},e.prototype.render=function(){if(!this.state.isVisible)return null;var t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)},e}(r.a.PureComponent),Pr=5e3,jr=4500,Rr=function(t,e){return e?yn.drop(e.duration):t?yn.snap:yn.fluid},Fr=function(t,e){return t?e?mn.drop:mn.combining:null};function Br(t){return"DRAGGING"===t.type?(i=(n=t).dimension.client,r=n.offset,a=n.combineWith,o=n.dropping,s=Boolean(a),l=function(t){return null!=t.forceShouldAnimate?t.forceShouldAnimate:"SNAP"===t.mode}(n),c=Boolean(o),u=c?xn(r,s):wn(r),{position:"fixed",top:i.marginBox.top,left:i.marginBox.left,boxSizing:"border-box",width:i.borderBox.width,height:i.borderBox.height,transition:Rr(l,o),transform:u,opacity:Fr(s,c),zIndex:c?jr:Pr,pointerEvents:"none"}):{transform:wn((e=t).offset),transition:e.shouldAnimateDisplacement?null:"none"};var e,n,i,r,a,o,s,l,c,u}function Hr(t){var e=ji("draggable"),n=t.descriptor,r=t.registry,a=t.getDraggableRef,o=t.canDragInteractiveElements,s=t.shouldRespectForcePress,l=t.isEnabled,c=V((function(){return{canDragInteractiveElements:o,shouldRespectForcePress:s,isEnabled:l}}),[o,l,s]),u=Z((function(t){var e=a();return e||pt(!1),function(t,e,n){void 0===n&&(n=Ct);var i=window.getComputedStyle(e),r=e.getBoundingClientRect(),a=rt(r,i),o=it(a,n);return{descriptor:t,placeholder:{client:a,tagName:e.tagName.toLowerCase(),display:i.display},displaceBy:{x:a.marginBox.width,y:a.marginBox.height},client:a,page:o}}(n,e,t)}),[n,a]),h=V((function(){return{uniqueId:e,descriptor:n,options:c,getDimension:u}}),[n,u,c,e]),d=Object(i.useRef)(h),p=Object(i.useRef)(!0);Ci((function(){return r.draggable.register(d.current),function(){return r.draggable.unregister(d.current)}}),[r.draggable]),Ci((function(){if(p.current)p.current=!1;else{var t=d.current;d.current=h,r.draggable.update(h,t)}}),[h,r.draggable])}function $r(t,e,n){Bi()}function qr(t){t.preventDefault()}var Ur=function(t,e){return t===e},Wr=function(t){var e=t.combine,n=t.destination;return n?n.droppableId:e?e.droppableId:null};function zr(t){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:t,combineWith:null}}var Gr={mapped:{type:"SECONDARY",offset:Ct,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:zr(null)}};var Vr=q((function(){var t,e,n,i=(t=st((function(t,e){return{x:t,y:e}})),e=st((function(t,e,n,i,r){return{isDragging:!0,isClone:e,isDropAnimating:Boolean(r),dropAnimation:r,mode:t,draggingOver:n,combineWith:i,combineTargetFor:null}})),n=st((function(t,n,i,r,a,o,s){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:a,combineWith:o,mode:n,offset:t,dimension:i,forceShouldAnimate:s,snapshot:e(n,r,a,o,null)}}})),function(i,r){if(i.isDragging){if(i.critical.draggable.id!==r.draggableId)return null;var a=i.current.client.offset,o=i.dimensions.draggables[r.draggableId],s=Le(i.impact),l=(u=i.impact).at&&"COMBINE"===u.at.type?u.at.combine.draggableId:null,c=i.forceShouldAnimate;return n(t(a.x,a.y),i.movementMode,o,r.isClone,s,l,c)}var u;if("DROP_ANIMATING"===i.phase){var h=i.completed;if(h.result.draggableId!==r.draggableId)return null;var d=r.isClone,p=i.dimensions.draggables[r.draggableId],f=h.result,g=f.mode,m=Wr(f),b=function(t){return t.combine?t.combine.draggableId:null}(f),v={duration:i.dropDuration,curve:gn,moveTo:i.newHomeClientOffset,opacity:b?mn.drop:null,scale:b?bn.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:p,dropping:v,draggingOver:m,combineWith:b,mode:g,forceShouldAnimate:null,snapshot:e(g,d,m,b,v)}}}return null}),r=function(){var t=st((function(t,e){return{x:t,y:e}})),e=st(zr),n=st((function(t,n,i){return void 0===n&&(n=null),{mapped:{type:"SECONDARY",offset:t,combineTargetFor:n,shouldAnimateDisplacement:i,snapshot:e(n)}}})),i=function(t){return t?n(Ct,t,!0):null},r=function(e,r,a,o){var s=a.displaced.visible[e],l=Boolean(o.inVirtualList&&o.effected[e]),c=Vt(a),u=c&&c.draggableId===e?r:null;if(!s){if(!l)return i(u);if(a.displaced.invisible[e])return null;var h=At(o.displacedBy.point),d=t(h.x,h.y);return n(d,u,!0)}if(l)return i(u);var p=a.displacedBy.point,f=t(p.x,p.y);return n(f,u,s.shouldAnimate)};return function(t,e){if(t.isDragging)return t.critical.draggable.id===e.draggableId?null:r(e.draggableId,t.critical.draggable.id,t.impact,t.afterCritical);if("DROP_ANIMATING"===t.phase){var n=t.completed;return n.result.draggableId===e.draggableId?null:r(e.draggableId,n.result.draggableId,n.impact,n.afterCritical)}return null}}();return function(t,e){return i(t,e)||r(t,e)||Gr}}),{dropAnimationFinished:fn},null,{context:Ni,pure:!0,areStatePropsEqual:Ur})((function(t){var e=Object(i.useRef)(null),n=Z((function(t){e.current=t}),[]),r=Z((function(){return e.current}),[]),a=Ar(Ri),o=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,c=Ar(Dr),u=c.type,h=c.droppableId,d=V((function(){return{id:t.draggableId,index:t.index,type:u,droppableId:h}}),[t.draggableId,t.index,u,h]),p=t.children,f=t.draggableId,g=t.isEnabled,m=t.shouldRespectForcePress,b=t.canDragInteractiveElements,v=t.isClone,y=t.mapped,_=t.dropAnimationFinished;$r(),Fi(),v||Hr(V((function(){return{descriptor:d,registry:l,getDraggableRef:r,canDragInteractiveElements:b,shouldRespectForcePress:m,isEnabled:g}}),[d,l,r,b,m,g]));var w=V((function(){return g?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":f,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:qr}:null}),[o,s,f,g]),x=Z((function(t){"DRAGGING"===y.type&&y.dropping&&"transform"===t.propertyName&&_()}),[_,y]),C=V((function(){var t=Br(y),e="DRAGGING"===y.type&&y.dropping?x:null;return{innerRef:n,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":f,style:t,onTransitionEnd:e},dragHandleProps:w}}),[o,w,f,y,x,n]),E=V((function(){return{draggableId:d.id,type:d.type,source:{index:d.index,droppableId:d.droppableId}}}),[d.droppableId,d.id,d.index,d.type]);return p(C,y.snapshot,E)}));function Zr(t){return Ar(Dr).isUsingCloneFor!==t.draggableId||t.isClone?r.a.createElement(Vr,t):null}function Yr(t){var e="boolean"!=typeof t.isDragDisabled||!t.isDragDisabled,n=Boolean(t.disableInteractiveElementBlocking),i=Boolean(t.shouldRespectForcePress);return r.a.createElement(Zr,Object(o.a)({},t,{isClone:!1,isEnabled:e,canDragInteractiveElements:n,shouldRespectForcePress:i}))}var Xr=function(t,e){return t===e.droppable.type},Kr=function(t,e){return e.draggables[t.draggable.id]};var Jr={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:function(){return document.body||pt(!1),document.body}},Qr=q((function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},e=Object(o.a)({},t,{shouldAnimatePlaceholder:!1}),n=st((function(t){return{draggableId:t.id,type:t.type,source:{index:t.index,droppableId:t.droppableId}}})),i=st((function(i,r,a,o,s,l){var c=s.descriptor.id;if(s.descriptor.droppableId===i){var u=l?{render:l,dragging:n(s.descriptor)}:null,h={isDraggingOver:a,draggingOverWith:a?c:null,draggingFromThisWith:c,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:h,useClone:u}}if(!r)return e;if(!o)return t;var d={isDraggingOver:a,draggingOverWith:c,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:d,useClone:null}}));return function(n,r){var a=r.droppableId,o=r.type,s=!r.isDropDisabled,l=r.renderClone;if(n.isDragging){var c=n.critical;if(!Xr(o,c))return e;var u=Kr(c,n.dimensions),h=Le(n.impact)===a;return i(a,s,h,h,u,l)}if("DROP_ANIMATING"===n.phase){var d=n.completed;if(!Xr(o,d.critical))return e;var p=Kr(d.critical,n.dimensions);return i(a,s,Wr(d.result)===a,Le(d.impact)===a,p,l)}if("IDLE"===n.phase&&n.completed&&!n.shouldFlush){var f=n.completed;if(!Xr(o,f.critical))return e;var g=Le(f.impact)===a,m=Boolean(f.impact.at&&"COMBINE"===f.impact.at.type),b=f.critical.droppable.id===a;return g?m?t:e:b?t:e}return e}}),{updateViewportMaxScroll:function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}}},null,{context:Ni,pure:!0,areStatePropsEqual:Ur})((function(t){var e=Object(i.useContext)(Ri);e||pt(!1);var n=e.contextId,a=e.isMovementAllowed,o=Object(i.useRef)(null),s=Object(i.useRef)(null),l=t.children,c=t.droppableId,u=t.type,h=t.mode,d=t.direction,p=t.ignoreContainerClipping,f=t.isDropDisabled,g=t.isCombineEnabled,m=t.snapshot,b=t.useClone,v=t.updateViewportMaxScroll,y=t.getContainerForClone,_=Z((function(){return o.current}),[]),w=Z((function(t){o.current=t}),[]),x=(Z((function(){return s.current}),[]),Z((function(t){s.current=t}),[]));Bi();var C=Z((function(){a()&&v({maxScroll:qn()})}),[a,v]);!function(t){var e=Object(i.useRef)(null),n=Ar(Ri),r=ji("droppable"),a=n.registry,o=n.marshal,s=$i(t),l=V((function(){return{id:t.droppableId,type:t.type,mode:t.mode}}),[t.droppableId,t.mode,t.type]),c=Object(i.useRef)(l),u=V((function(){return st((function(t,n){e.current||pt(!1);var i={x:t,y:n};o.updateDroppableScroll(l.id,i)}))}),[l.id,o]),h=Z((function(){var t=e.current;return t&&t.env.closestScrollable?wr(t.env.closestScrollable):Ct}),[]),d=Z((function(){var t=h();u(t.x,t.y)}),[h,u]),p=V((function(){return lt(d)}),[d]),f=Z((function(){var t=e.current,n=Or(t);t&&n||pt(!1),t.scrollOptions.shouldPublishImmediately?d():p()}),[p,d]),g=Z((function(t,i){e.current&&pt(!1);var r=s.current,a=r.getDroppableRef();a||pt(!1);var o=xr(a),c={ref:a,descriptor:l,env:o,scrollOptions:i};e.current=c;var u=Cr({ref:a,descriptor:l,env:o,windowScroll:t,direction:r.direction,isDropDisabled:r.isDropDisabled,isCombineEnabled:r.isCombineEnabled,shouldClipSubject:!r.ignoreContainerClipping}),h=o.closestScrollable;return h&&(h.setAttribute(wi.contextId,n.contextId),h.addEventListener("scroll",f,Mr(c.scrollOptions))),u}),[n.contextId,l,f,s]),m=Z((function(){var t=e.current,n=Or(t);return t&&n||pt(!1),wr(n)}),[]),b=Z((function(){var t=e.current;t||pt(!1);var n=Or(t);e.current=null,n&&(p.cancel(),n.removeAttribute(wi.contextId),n.removeEventListener("scroll",f,Mr(t.scrollOptions)))}),[f,p]),v=Z((function(t){var n=e.current;n||pt(!1);var i=Or(n);i||pt(!1),i.scrollTop+=t.y,i.scrollLeft+=t.x}),[]),y=V((function(){return{getDimensionAndWatchScroll:g,getScrollWhileDragging:m,dragStopped:b,scroll:v}}),[b,g,m,v]),_=V((function(){return{uniqueId:r,descriptor:l,callbacks:y}}),[y,l,r]);Ci((function(){return c.current=_.descriptor,a.droppable.register(_),function(){e.current&&b(),a.droppable.unregister(_)}}),[y,l,b,_,o,a.droppable]),Ci((function(){e.current&&o.updateDroppableIsEnabled(c.current.id,!t.isDropDisabled)}),[t.isDropDisabled,o]),Ci((function(){e.current&&o.updateDroppableIsCombineEnabled(c.current.id,t.isCombineEnabled)}),[t.isCombineEnabled,o])}({droppableId:c,type:u,mode:h,direction:d,isDropDisabled:f,isCombineEnabled:g,ignoreContainerClipping:p,getDroppableRef:_});var E=r.a.createElement(Ir,{on:t.placeholder,shouldAnimate:t.shouldAnimatePlaceholder},(function(t){var e=t.onClose,i=t.data,a=t.animate;return r.a.createElement(Lr,{placeholder:i,onClose:e,innerRef:x,animate:a,contextId:n,onTransitionEnd:C})})),S=V((function(){return{innerRef:w,placeholder:E,droppableProps:{"data-rbd-droppable-id":c,"data-rbd-droppable-context-id":n}}}),[n,c,E,w]),M=b?b.dragging.draggableId:null,A=V((function(){return{droppableId:c,type:u,isUsingCloneFor:M}}),[c,M,u]);return r.a.createElement(Dr.Provider,{value:A},l(S,m),function(){if(!b)return null;var t=b.dragging,e=b.render,n=r.a.createElement(Zr,{draggableId:t.draggableId,index:t.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(function(n,i){return e(n,i,t)}));return z.a.createPortal(n,y())}())}));Qr.defaultProps=Jr},308:function(t,e,n){"use strict";var i=n(191),r=n(240),a=n(182),o=n(212),s=n(215),l=n(241),c=n(254);class u extends HTMLElement{constructor(){super(),u._polyfillElementClosest(),this._updateScaleDomain=this._updateScaleDomain.bind(this),this._initZoom=this._initZoom.bind(this),this.zoomed=this.zoomed.bind(this),this._applyZoomTranslation=this.applyZoomTranslation.bind(this),this._resetEventHandler=this._resetEventHandler.bind(this);let t=!1;this.applyZoomTranslation=()=>{t||(t=!0,requestAnimationFrame(()=>{t=!1,this._applyZoomTranslation()}))},this._onResize=this._onResize.bind(this),this._listenForResize=this._listenForResize.bind(this),this.trackHighlighter=new l.b({element:this,min:1}),this.scrollFilter=new l.a(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth,this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=this.getAttribute("length")?parseFloat(this.getAttribute("length")):0,this._displaystart=this.getAttribute("displaystart")?parseFloat(this.getAttribute("displaystart")):1,this._displayend=this.getAttribute("displayend")?parseFloat(this.getAttribute("displayend")):this.length,this._height=this.getAttribute("height")?Number(this.getAttribute("height")):44,this._highlightEvent=this.getAttribute("highlight-event")?this.getAttribute("highlight-event"):"onclick",this.trackHighlighter.setAttributesInElement(this),this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this._initZoom(),this._listenForResize(),this.addEventListener("error",t=>{console.error(t)}),this.addEventListener("click",this._resetEventHandler),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro?this._ro.unobserve(this):window.removeEventListener("resize",this._onResize),this.removeEventListener("click",this._resetEventHandler),document.removeEventListener("wheel",this.wheelListener)}get width(){return this._width}set width(t){this._width=t}set height(t){this._height=t}get height(){return this._height}set length(t){this._length=t,this.trackHighlighter.max=t}get length(){return this._length}get xScale(){return this._xScale}set xScale(t){this._xScale=t}get zoom(){return this._zoom}set svg(t){this._svg=t,t.call(this._zoom),this.applyZoomTranslation()}get svg(){return this._svg}set fixedHighlight(t){this.trackHighlighter.setFixedHighlight(t)}getWidthWithMargins(){return this.width?this.width-this.margin.left-this.margin.right:0}_updateScaleDomain(){this.xScale=Object(i.i)().domain([1,this._length+1]).range([0,this.getWidthWithMargins()])}_initZoom(){this._zoom=Object(i.m)().scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]).extent([[0,0],[this.getWidthWithMargins(),0]]).filter(()=>{if(!(i.e instanceof WheelEvent))return!0;if(this.hasAttribute("scroll-filter")){const t=this.getAttribute("scrollable");if(t)return"true"===t}return!this.hasAttribute("use-ctrl-to-zoom")||i.e.ctrlKey}).on("zoom",this.zoomed)}static get observedAttributes(){return["displaystart","displayend","length","highlight"]}setFloatAttribute(t,e){const n=parseFloat(e);this["_"+t]=Number.isNaN(n)?e:n}attributeChangedCallback(t,e,n){if("null"===n&&(n=null),e!==n){if(t.startsWith("highlight"))return void this.trackHighlighter.changedCallBack(t,n);this.setFloatAttribute(t,n),"length"===t&&(this._updateScaleDomain(),this._originXScale=this.xScale.copy()),this.applyZoomTranslation()}}zoomed(){if(this.xScale=i.e.transform.rescaleX(this._originXScale),this.dontDispatch)return;const[t,e]=this.xScale.domain();this.dispatchEvent(new CustomEvent("change",{detail:{displaystart:Math.max(1,t),displayend:Math.min(this.length,Math.max(e-1,t+1))},bubbles:!0,cancelable:!0}))}applyZoomTranslation(){if(!this.svg||!this._originXScale)return;const t=Math.max(1,this.length/(1+this._displayend-this._displaystart)),e=-this._originXScale(this._displaystart);this.dontDispatch=!0,this.svg.call(this.zoom.transform,i.n.scale(t).translate(e,0)),this.dontDispatch=!1,this.refresh()}_onResize(){this.width=this.offsetWidth,this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this.svg&&this.svg.attr("width",this.width),this._zoom.scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]),this.applyZoomTranslation()}_listenForResize(){this._ro=new c.a(this._onResize),this._ro.observe(this)}_resetEventHandler(t){t.target.closest(".feature")||this.dispatchEvent(this.createEvent("reset",null,!0))}getXFromSeqPosition(t){return this.margin.left+this.xScale(t)}getSingleBaseWidth(){return this.xScale(2)-this.xScale(1)}static _getClickCoords(){return i.e?[i.e.pageX,i.e.pageY]:null}static _polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}createEvent(t,e=null,n=!1,r=!1,a,o,s){e&&(e=e.feature?e.feature:e);const l={eventtype:t,coords:u._getClickCoords(),feature:e,target:s};return n&&(e&&e.fragments?l.highlight=e.fragments.map(t=>`${t.start}:${t.end}`).join(","):i.e&&i.e.shiftKey&&this._highlight?l.highlight=`${this._highlight},${a}:${o}`:l.highlight=a&&o?`${a}:${o}`:null),r&&(l.selectedid=e&&e.protvistaFeatureId),new CustomEvent("change",{detail:l,bubbles:!0,cancelable:!0})}bindEvents(t,e){t.on("mouseover",(t,n,i)=>{e.dispatchEvent(e.createEvent("mouseover",t,"onmouseover"===e._highlightEvent,!1,t.start,t.end,i[n]))}).on("mouseout",()=>{e.dispatchEvent(e.createEvent("mouseout",null,"onmouseover"===e._highlightEvent))}).on("click",(t,n,i)=>{e.dispatchEvent(e.createEvent("click",t,"onclick"===e._highlightEvent,!0,t.start,t.end,i[n]))})}}var h=Object(l.c)(u,{initialValue:{top:10,right:10,bottom:10,left:10}});class d{getFeatureShape(t,e,n,i){return i=i||"rectangle",this._ftLength=n,this._ftHeight=e,this._ftWidth=t*n,"function"!=typeof this["_"+i]&&(i="rectangle"),this["_"+i]()}static isContinuous(t){return"bridge"!==(t=t.toLowerCase())}_rectangle(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+"Z"}_roundRectangle(){return"M6,0h"+(this._ftWidth-12)+",0a6,6 0 0 1 6,6v"+(this._ftHeight-12)+"a6,6 0 0 1 "+"-6,6h"+(12-this._ftWidth)+"a6,6 0 0 1 "+"-6,"+"-6v"+(12-this._ftHeight)+"a6,6 0 0 1 6,"+"-6Z"}_line(){return`M0,${this._ftHeight/2} L${this._ftWidth},${this._ftHeight/2}`}_bridge(){return 1!==this._ftLength?"M0,"+this._ftHeight+"L0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L"+this._ftWidth+",2L0,2Z":"M0,"+this._ftHeight+"L0,"+this._ftHeight/2+"L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth/2+",0L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight+"Z"}_getMiddleLine(t){return"M0,"+t+"L"+this._ftWidth+","+t+"Z"}_diamond(){const t=this._ftWidth/2,e="M"+t+",0L"+(t+5)+",5L"+t+",10L"+(t-5)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth):e+"Z"}_chevron(){const t=this._ftWidth/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+",10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==this._ftLength?e+"L"+t+",5"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_catFace(){const t=this._ftWidth/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+",10L"+(2+t)+",10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==this._ftLength?e+"M"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_triangle(){const t=this._ftWidth/2,e="M"+t+",0L"+(5+t)+",10L"+(-5+t)+",10";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_wave(){const t=this._ftWidth/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getPolygon(t){let e="M ";const n=this._ftWidth/2;for(let i=0;i<t;i++)e+=5*Math.cos(2*Math.PI*i/t)+n+","+(5*Math.sin(2*Math.PI*i/t)+5)+" ";return 1!==this._ftLength?e+" "+(5*Math.cos(0)+n)+","+(5*Math.sin(0)+5)+" "+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_hexagon(){return this._getPolygon(6)}_pentagon(){return this._getPolygon(5)}_circle(){const t=this._ftWidth/2,e=Math.sqrt(10/Math.PI),n="M"+t+",0A"+e+","+e+" 0 1,1 "+t+",10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==this._ftLength?n+this._getMiddleLine(5,this._ftWidth)+"Z":n+"Z"}_arrow(){const t=this._ftWidth/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+this._ftHeight+"L"+t+","+this._ftHeight+"L"+(4+t)+",4";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_doubleBar(){const t=this._ftWidth/2,e="M"+t+",0L"+(-5+t)+",10L"+t+",10L"+(5+t)+",0";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getBrokenEnd(){const t=this._ftHeight/4;return"L"+(this._ftWidth-t)+","+t+"L"+this._ftWidth+","+2*t+"L"+(this._ftWidth-t)+","+3*t+"L"+this._ftWidth+","+this._ftHeight}_getBrokenStart(){const t=this._ftHeight/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t}_discontinuosStart(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuos(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuosEnd(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+"Z"}_helix(){const t=2.5;let e=2.5;const n=Math.round(this._ftWidth/5);let i="";for(let r=0;r<n;r++){i+="M"+(-2.5+e)+","+this._ftHeight+" C"+(e+t)+",7.5 "+(2.5+e)+","+"2.5 "+e+", 0 C"+(e-t)+","+"2.5 "+e+",7.5 "+(2.5+e)+","+this._ftHeight,e+=5}return i}_strand(){let t=0;this._ftWidth>5&&(t=this._ftWidth-5);const e=this._ftHeight/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+("M"+t+",0L"+this._ftWidth+","+2*e+"L"+t+","+this._ftHeight+"Z")}}class p{constructor({layoutHeight:t,padding:e=1,minHeight:n=17}){this._padding=e,this._minHeight=n,this._layoutHeight=t}init(t){this._features=t}getFeatureYPos(){const t=this.getFeatureHeight();return this._layoutHeight/2-t/2}getFeatureHeight(){return Math.min(this._layoutHeight,this._minHeight)-this._padding}}const f=(t,e)=>e.some(e=>{return n=t,i=e,!(Number(i.start)>Number(n.end)||Number(i.end)<Number(n.start));var n,i});class g extends p{constructor(t){super(t),this.featuresMap=new Map,this._rowHeight=0,this._rows=[],this._minHeight=15}init(t){t.forEach(t=>{const e=this._rows.findIndex(e=>!f(t,e));e>=0?(this._rows[e].push(t),this.featuresMap.set(t,e)):(this._rows.push([t]),this.featuresMap.set(t,this._rows.length-1))}),this._rowHeight=Math.min(this._layoutHeight/this._rows.length,this._minHeight)}getOffset(){return this._rows.length*this._rowHeight<this._layoutHeight?this._layoutHeight/2-this._rows.length*this._rowHeight/2:0}getFeatureYPos(t){const e=this.featuresMap.get(t);return this.getOffset()+this._rowHeight*e+2*this._padding}getFeatureHeight(){return this._rowHeight-2*this._padding}}const m={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},b=t=>{if(m[t.toUpperCase()])return m[t.toUpperCase()].shape;const e=Object.values(m).find(e=>e.name.toUpperCase()===t.toUpperCase());return e?e.shape:"rectangle"},v=t=>{if(m[t.toUpperCase()])return m[t.toUpperCase()].color;const e=Object.values(m).find(e=>e.name.toUpperCase()===t.toUpperCase());return e||console.log(t),e?e.color:"black"};class y extends h{getLayout(){return"non-overlapping"===String(this.getAttribute("layout")).toLowerCase()?new g({layoutHeight:this._height}):new p({layoutHeight:this._height})}connectedCallback(){super.connectedCallback(),this._color=this.getAttribute("color"),this._shape=this.getAttribute("shape"),this._featureShape=new d,this._layoutObj=this.getLayout(),this._data&&this._createTrack(),this.addEventListener("load",t=>{Object(r.a)(this.children,t.target)&&(this.data=t.detail.payload)})}static normalizeLocations(t){return t.map(t=>{const{locations:e,start:n,end:i}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:n,end:i}]}]})})}processData(t){this._originalData=y.normalizeLocations(t)}set data(t){this.processData(t),this._applyFilters(),this._layoutObj=this.getLayout(),this._createTrack()}set filters(t){this._filters=t,this._applyFilters(),this._createTrack()}static get observedAttributes(){return h.observedAttributes.concat(["highlight","color","shape","filters"])}_getFeatureColor(t){return t.color?t.color:t.feature&&t.feature.color?t.feature.color:this._color?this._color:t.type?v(t.type):t.feature&&t.feature.type?v(t.feature.type):"black"}_getFeatureFillColor(t){return t.fill?t.fill:t.feature&&t.feature.fill?t.feature.fill:this._getFeatureColor(t)}_getShape(t){return t.shape?t.shape:t.feature&&t.feature.shape?t.feature.shape:this._shape?this._shape:t.type?b(t.type):t.feature&&t.feature.type?b(t.feature.type):"rectangle"}_createTrack(){this._layoutObj.init(this._data),Object(i.l)(this).selectAll("div").remove(),this.svg=Object(i.l)(this).append("div").style("line-height",0).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this.seq_g=this.svg.append("g").attr("class","sequence-features"),this._createFeatures()}_createFeatures(){this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data),this.locations=this.featuresG.enter().append("g").attr("class","feature-group").attr("id",t=>"g_"+t.accession).selectAll("g.location-group").data(t=>t.locations.map(e=>Object.assign({},e,{feature:t}))).enter().append("g").attr("class","location-group");const t=this.locations.selectAll("g.fragment-group").data(t=>t.fragments.map(e=>Object.assign({},e,{feature:t.feature}))).enter().append("g").attr("class","fragment-group");t.append("path").attr("class",t=>this._getShape(t)+" feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill",t=>this._getFeatureFillColor(t)).attr("stroke",t=>this._getFeatureColor(t)).style("fill-opacity",({feature:t})=>t.opacity?t.opacity:.9).style("stroke-opacity",({feature:t})=>t.opacity?t.opacity:.9),t.append("rect").attr("class","outer-rectangle feature").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`).attr("fill","transparent").attr("stroke","transparent").call(this.bindEvents,this)}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(a.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return Object(o.a)(...e)}),n=Object(s.a)(...e);this._data=n}refresh(){if(this.xScale&&this.seq_g){const t=this.seq_g.selectAll("g.fragment-group").data(this._data.reduce((t,e)=>t.concat(e.locations.reduce((t,n)=>t.concat(n.fragments.map(t=>Object.assign({},t,{feature:e}))),[])),[]));t.selectAll("path.feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),t.selectAll("rect.outer-rectangle").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>`translate(${this.getXFromSeqPosition(t.start)},${this._layoutObj.getFeatureYPos(t.feature)})`),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}e.a=y},309:function(t,e,n){"use strict";var i=function(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1};var r=function(t){return t!=t};var a=function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1};e.a=function(t,e,n){return e==e?a(t,e,n):i(t,r,n)}},310:function(t,e,n){"use strict";var i=n(99),r=n(281),a=n(282),o=n(95),s=n(71);var l=function(){},c=n(96),u=s.a&&1/Object(c.a)(new s.a([,-0]))[1]==1/0?function(t){return new s.a(t)}:l;e.a=function(t,e,n){var s=-1,l=r.a,h=t.length,d=!0,p=[],f=p;if(n)d=!1,l=a.a;else if(h>=200){var g=e?null:u(t);if(g)return Object(c.a)(g);d=!1,l=o.a,f=new i.a}else f=e?[]:p;t:for(;++s<h;){var m=t[s],b=e?e(m):m;if(m=n||0!==m?m:0,d&&b==b){for(var v=f.length;v--;)if(f[v]===b)continue t;e&&f.push(b),p.push(m)}else l(f,b,n)||(f!==p&&f.push(b),p.push(m))}return p}},311:function(t,e,n){"use strict";var i=n(191),r=n(241),a=n(254);class o extends HTMLElement{constructor(){super(),o._polyfillElementClosest(),this._updateScaleDomain=this._updateScaleDomain.bind(this),this._initZoom=this._initZoom.bind(this),this.zoomed=this.zoomed.bind(this),this._applyZoomTranslation=this.applyZoomTranslation.bind(this),this._resetEventHandler=this._resetEventHandler.bind(this);let t=!1;this.applyZoomTranslation=()=>{t||(t=!0,requestAnimationFrame(()=>{t=!1,this._applyZoomTranslation()}))},this._onResize=this._onResize.bind(this),this._listenForResize=this._listenForResize.bind(this),this.trackHighlighter=new r.b({element:this,min:1}),this.scrollFilter=new r.a(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth,this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=this.getAttribute("length")?parseFloat(this.getAttribute("length")):0,this._displaystart=this.getAttribute("displaystart")?parseFloat(this.getAttribute("displaystart")):1,this._displayend=this.getAttribute("displayend")?parseFloat(this.getAttribute("displayend")):this.length,this._height=this.getAttribute("height")?Number(this.getAttribute("height")):44,this._highlightEvent=this.getAttribute("highlight-event")?this.getAttribute("highlight-event"):"onclick",this.trackHighlighter.setAttributesInElement(this),this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this._initZoom(),this._listenForResize(),this.addEventListener("error",t=>{console.error(t)}),this.addEventListener("click",this._resetEventHandler),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro?this._ro.unobserve(this):window.removeEventListener("resize",this._onResize),this.removeEventListener("click",this._resetEventHandler),document.removeEventListener("wheel",this.wheelListener)}get width(){return this._width}set width(t){this._width=t}set height(t){this._height=t}get height(){return this._height}set length(t){this._length=t,this.trackHighlighter.max=t}get length(){return this._length}get xScale(){return this._xScale}set xScale(t){this._xScale=t}get zoom(){return this._zoom}set svg(t){this._svg=t,t.call(this._zoom),this.applyZoomTranslation()}get svg(){return this._svg}set fixedHighlight(t){this.trackHighlighter.setFixedHighlight(t)}getWidthWithMargins(){return this.width?this.width-this.margin.left-this.margin.right:0}_updateScaleDomain(){this.xScale=Object(i.i)().domain([1,this._length+1]).range([0,this.getWidthWithMargins()])}_initZoom(){this._zoom=Object(i.m)().scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]).extent([[0,0],[this.getWidthWithMargins(),0]]).filter(()=>{if(!(i.e instanceof WheelEvent))return!0;if(this.hasAttribute("scroll-filter")){const t=this.getAttribute("scrollable");if(t)return"true"===t}return!this.hasAttribute("use-ctrl-to-zoom")||i.e.ctrlKey}).on("zoom",this.zoomed)}static get observedAttributes(){return["displaystart","displayend","length","highlight"]}setFloatAttribute(t,e){const n=parseFloat(e);this["_"+t]=Number.isNaN(n)?e:n}attributeChangedCallback(t,e,n){if("null"===n&&(n=null),e!==n){if(t.startsWith("highlight"))return void this.trackHighlighter.changedCallBack(t,n);this.setFloatAttribute(t,n),"length"===t&&(this._updateScaleDomain(),this._originXScale=this.xScale.copy()),this.applyZoomTranslation()}}zoomed(){if(this.xScale=i.e.transform.rescaleX(this._originXScale),this.dontDispatch)return;const[t,e]=this.xScale.domain();this.dispatchEvent(new CustomEvent("change",{detail:{displaystart:Math.max(1,t),displayend:Math.min(this.length,Math.max(e-1,t+1))},bubbles:!0,cancelable:!0}))}applyZoomTranslation(){if(!this.svg||!this._originXScale)return;const t=Math.max(1,this.length/(1+this._displayend-this._displaystart)),e=-this._originXScale(this._displaystart);this.dontDispatch=!0,this.svg.call(this.zoom.transform,i.n.scale(t).translate(e,0)),this.dontDispatch=!1,this.refresh()}_onResize(){this.width=this.offsetWidth,this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this.svg&&this.svg.attr("width",this.width),this._zoom.scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]),this.applyZoomTranslation()}_listenForResize(){this._ro=new a.a(this._onResize),this._ro.observe(this)}_resetEventHandler(t){t.target.closest(".feature")||this.dispatchEvent(this.createEvent("reset",null,!0))}getXFromSeqPosition(t){return this.margin.left+this.xScale(t)}getSingleBaseWidth(){return this.xScale(2)-this.xScale(1)}static _getClickCoords(){return i.e?[i.e.pageX,i.e.pageY]:null}static _polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}createEvent(t,e=null,n=!1,r=!1,a,s,l){e&&(e=e.feature?e.feature:e);const c={eventtype:t,coords:o._getClickCoords(),feature:e,target:l};return n&&(e&&e.fragments?c.highlight=e.fragments.map(t=>`${t.start}:${t.end}`).join(","):i.e&&i.e.shiftKey&&this._highlight?c.highlight=`${this._highlight},${a}:${s}`:c.highlight=a&&s?`${a}:${s}`:null),r&&(c.selectedid=e&&e.protvistaFeatureId),new CustomEvent("change",{detail:c,bubbles:!0,cancelable:!0})}bindEvents(t,e){t.on("mouseover",(t,n,i)=>{e.dispatchEvent(e.createEvent("mouseover",t,"onmouseover"===e._highlightEvent,!1,t.start,t.end,i[n]))}).on("mouseout",()=>{e.dispatchEvent(e.createEvent("mouseout",null,"onmouseover"===e._highlightEvent))}).on("click",(t,n,i)=>{e.dispatchEvent(e.createEvent("click",t,"onclick"===e._highlightEvent,!0,t.start,t.end,i[n]))})}}var s=Object(r.c)(o,{initialValue:{top:10,right:10,bottom:10,left:10}});e.a=class extends s{connectedCallback(){super.connectedCallback(),this.sequence=this.getAttribute("sequence"),this.sequence&&this._createSequence(),this.addEventListener("load",t=>{this.data=t.detail.payload})}static get observedAttributes(){return s.observedAttributes.concat("highlightstart","highlightend")}get data(){return this.sequence}set data(t){"string"==typeof t?this.sequence=t:"sequence"in t&&(this.sequence=t.sequence),this.sequence&&!super.svg?this._createSequence():this.refresh()}_getCharSize(){if(!this.seq_g)return;const t=this.seq_g.select("text.base").node();if(t)this.chWidth=.8*t.getBBox().width,this.chHeight=1.6*t.getBBox().height;else{const t=this.seq_g.append("text").attr("class","base").text("T");this.chWidth=.8*t.node().getBBox().width,this.chHeight=1.6*t.node().getBBox().height,t.remove()}}_createSequence(){super.svg=Object(i.l)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",this._height),this.seq_bg=super.svg.append("g").attr("class","background"),this.axis=super.svg.append("g").attr("class","x axis"),this.seq_g=super.svg.append("g").attr("class","sequence").attr("transform",`translate(0,${.75*this._height})`),this.trackHighlighter.appendHighlightTo(this.svg),this.refresh()}refresh(){if(this._getCharSize(),this.axis){const t=this.getSingleBaseWidth(),e=t-this.chWidth,n=t/2,r=Math.round(Math.max(0,this._displaystart-2)),a=Math.round(Math.min(this.sequence.length,this._displayend+1)),o=e<0?[]:this.sequence.slice(r,a).split("").map((t,e)=>({start:1+r+e,end:1+r+e,aa:t}));this.height>this.chHeight&&(this.xAxis=Object(i.a)(this.xScale).tickFormat(t=>Number.isInteger(t)?t:"").ticks(3,"s"),this.axis.call(this.xAxis)),this.axis.attr("transform",`translate(${this.margin.left+n},0)`),this.axis.select(".domain").remove(),this.axis.selectAll(".tick line").remove(),this.bases=this.seq_g.selectAll("text.base").data(o,t=>t.start),this.bases.enter().append("text").attr("class","base").attr("text-anchor","middle").attr("x",t=>this.getXFromSeqPosition(t.start)+n).text(t=>t.aa).style("pointer-events","none").style("font-family","monospace"),this.bases.exit().remove(),this.bases.attr("x",t=>this.getXFromSeqPosition(t.start)+n),this.background=this.seq_bg.selectAll("rect.base_bg").data(o,t=>t.start),this.background.enter().append("rect").attr("class","base_bg feature").attr("height",this._height).merge(this.background).attr("width",t).attr("fill",t=>Math.round(t.start)%2?"#ccc":"#eee").attr("x",t=>this.getXFromSeqPosition(t.start)).call(this.bindEvents,this),this.background.exit().remove(),this.seq_g.style("opacity",Math.min(1,e)),this.background.style("opacity",Math.min(1,e)),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}},360:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(194),r=n(192);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const a=new WeakMap,o=Object(r.b)(t=>e=>{if(!(e instanceof r.a))throw new Error("unsafeHTML can only be used in text bindings");const n=a.get(e);if(void 0!==n&&Object(i.f)(t)&&t===n.value&&e.value===n.fragment)return;const o=document.createElement("template");o.innerHTML=t;const s=document.importNode(o.content,!0);e.setValue(s),a.set(e,{value:t,fragment:s})})},362:function(t,e){!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){var i=n(1);"string"==typeof i&&(i=[[t.i,i,""]]);n(3)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"rhea-reaction {\n    display: flex;\n    flex-direction: column;\n    min-width: 100%;\n    justify-content: flex-start;\n    align-items: flex-start;\n    align-content: stretch;\n}\n\nrhea-reaction img {\n    width: 200px;\n    height: 200px;\n}\n\nrhea-reaction .rhea-reaction-container {\n    display: flex;\n    flex-direction: row;\n    justify-content: left;\n}\n\nrhea-reaction-block {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    padding: 10px;\n}\n\nrhea-reaction-block.smallMolecule:hover {\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n}\n\nrhea-reaction .residues {\n    display: flex;\n    flex-direction: row;\n    border: 1px grey dashed;\n    justify-content: center;\n}\n\nrhea-reaction-block .name {\n    margin-bottom: 10px;\n}\n\nrhea-reaction-block.and,\nrhea-reaction-block.none,\nrhea-reaction-block.forward,\nrhea-reaction-block.backward,\nrhea-reaction-block.bi,\nrhea-reaction-block.coefficient {\n    justify-content: center;\n}\n\nrhea-reaction .participantfooter {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n}\n\nrhea-reaction .filler {\n    flex-grow: 1;\n}",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n,i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var a=(n=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),o=r.sources.map((function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"}));return[i].concat(o).concat([a]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var a=this[r][0];null!=a&&(i[a]=!0)}for(r=0;r<t.length;r++){var o=t[r];null!=o[0]&&i[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(t,e,n){var i,r,a={},o=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,c=0,u=[],h=n(4);function d(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=a[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(v(i.parts[o],e))}else{var s=[];for(o=0;o<i.parts.length;o++)s.push(v(i.parts[o],e));a[i.id]={id:i.id,refs:1,parts:s}}}}function p(t,e){for(var n=[],i={},r=0;r<t.length;r++){var a=t[r],o=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};i[o]?i[o].parts.push(s):n.push(i[o]={id:o,parts:[s]})}return n}function f(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),u.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=s(t.insertAt.before,n);n.insertBefore(e,r)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function m(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=n.nc;i&&(t.attrs.nonce=i)}return b(e,t.attrs),f(t,e),e}function b(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function v(t,e){var n,i,r,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var o=c++;n=l||(l=m(e)),i=w.bind(null,n,o,!1),r=w.bind(null,n,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",b(e,t.attrs),f(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,a=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||a)&&(i=h(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,n,e),r=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),i=function(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){g(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return d(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var o=n[r];(s=a[o.id]).refs--,i.push(s)}for(t&&d(p(t,e),e),r=0;r<i.length;r++){var s;if(0===(s=i[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete a[s.id]}}}};var y,_=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function w(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=_(e,r);else{var a=document.createTextNode(r),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var r,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:i+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(t,e,n){"use strict";n.r(e),n(0);const i={forward:"=>",backward:"<=",bi:"<=>",none:"="},r={SMALL_MOLECULE:"smallMolecule",GENERIC_COMPOUND:"genericcomp",POLYMER:"polymer"};window.customElements.get("rhea-reaction-block")||window.customElements.define("rhea-reaction-block",class extends HTMLElement{constructor(){super()}smallMolecule(t,e,n="",i){let r=t.htmlname?t.htmlname:t.label,a=t.htmlname?`<div class="name">\n                <a href="${function(t){return"https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:"+t}(t.id)}">${decodeURI(r)}</a>\n                ${t.location?`(${t.location})`:""}\n            </div>`:"",o=i.structuresearch&&t.smiles,s=t.position?`<div class="position">Position: ${t.position}</div>`:"",l=""!==n?`<a class="participantId">${n}</a>`:"",c=i.polymer?i.polymer.thumbnail:t.thumbnail;c=c.startsWith("http")?c:`${i.imagehost}${c}`;let u=i.polymer?i.polymer.zoomed:t.zoomed;return u=u.startsWith("http")?u:`${i.imagehost}${u}`,(""!==s?`<img alt="No structure information present" src="${c}"></img> ${a} ${l} ${s}`:`${a} ${l} <img alt="No structure information present" src="${c}"></img> ${s}`)+'<span class="filler"></span>'+`<div class="participantfooter">\n        ${(i.formula&&t.formula?`<span class="info"><i>Formula</i>: ${t.formula}</span>`:"")+(i.charge&&t.charge?`<span class="info"><i>Charge</i>: ${t.charge}</span>`:"")+(i.inchikey&&t.inchikey?`<span class="info"><i>InchiKey</i>: ${t.inchikey}</span>`:"")+(e?`<a class="zoomLink" data-chebi-id="${t.id}" data-chebi-zoom="${u}">zoom</a>`:"")+(o?`<a class="structuresearch" href="${i.rheaurl}/structuresearch/?query=${t.id}">structure search`:"")}</div>`}setParticipant(t,e,n){switch(t.type){case"SMALL_MOLECULE":this.innerHTML=this.smallMolecule(t,e,n.showids?"CHEBI:"+t.id:"",n);break;case"POLYMER":let i={...n,polymer:{thumbnail:t.thumbnail,zoomed:t.zoomed}};(t.htmlname||t.label)&&(i.polymer.htmlname=t.htmlname?t.htmlname:t.label),this.innerHTML=this.smallMolecule(t.underlyingChebi,e,n.showids?"RHEA-COMP:"+t.id:"",i);break;case"GENERIC_COMPOUND":this.innerHTML=`\n                <div class="name">\n                    <a class="generic">${decodeURI(t.htmlname)}</a>\n                </div>\n                ${n.showids?`<a class="participantId"> RHEA-COMP:${t.id}</a>`:""}\n                <div class="residues">${t.reactivePart.map((t,e)=>`<rhea-reaction-block class="participant ${r[t.type]}" index="${e}"></rhea-reaction-block>`).join("")}</div>`,this.querySelectorAll("rhea-reaction-block").forEach(i=>{let r=i.getAttribute("index");i.removeAttribute("index"),i.setParticipant(t.reactivePart[r],e,n)});break;default:return""}}}),window.customElements.get("rhea-reaction")||window.customElements.define("rhea-reaction",class extends HTMLElement{constructor(){super(),this.rheaURL="https://beta.rhea-db.org",this.imageHost=this.hasAttribute("imagehost")?this.getAttribute("imagehost"):this.rheaURL}attributeChangedCallback(t,e,n){if(e!==n)switch(t){case"rheaid":let t=n.toLowerCase();t.startsWith("rhea:")&&(t=t.subString(5)),this.render(t);break;case"usehost":this.rheaURL=n;break;case"imagehost":this.imageHost=n}}static get observedAttributes(){return["rheaid","usehost","imagehost"]}get uniprot(){return"https://uniprot.org/uniprot/query="+this.rheaid}async render(t){this.hasAttribute("usehost")&&(this.rheaURL=this.getAttribute("usehost"));let e=await fetch(function(t,e){return`${e}/rhea/${t}/json`}(t,this.rheaURL));e=await e.json(),this.rheaid="rhea:"+e.id;let n={nosource:this.hasAttribute("nosource"),showids:this.hasAttribute("showids"),formula:this.hasAttribute("formula"),charge:this.hasAttribute("charge"),smiles:this.hasAttribute("smiles"),inchikey:this.hasAttribute("inchikey"),structuresearch:this.hasAttribute("structuresearch"),rheaurl:this.rheaURL,imagehost:this.imageHost};this.innerHTML=`\n            ${n.nosource?"":`<div class="rhea-reaction-source">\n                    <a href="${function(t){return"https://www.rhea-db.org/reaction?id="+t}(e.id)}">${n.showids?"RHEA:"+e.id:"Source: Rhea"}</a> \n                </div>`}\n            <div class="rhea-reaction-container">\n                ${this.getList("left",e.left)}\n                    <rhea-reaction-block class="${e.direction}">${i[e.direction]}</rhea-reaction-block>\n                ${this.getList("right",e.right)}\n            </div>`,this.querySelectorAll("rhea-reaction-block.participant").forEach(t=>{let i=t.getAttribute("index").split("-"),r=i[0];i=i[1],t.removeAttribute("index"),t.setParticipant(e[r][i],this.hasAttribute("zoom"),n)}),this.hasAttribute("zoom")&&Array.from(this.querySelectorAll(".zoomLink")).forEach(t=>t.onclick=e=>{e.stopPropagation(),e.preventDefault();let n=new CustomEvent("zoomClicked",{detail:{chebi:"chebi:"+e.target.getAttribute("data-chebi-id"),imgURL:e.target.getAttribute("data-chebi-zoom")},bubbles:!0});t.dispatchEvent(n)});let r=new CustomEvent("rendered",{detail:{},bubbles:!0});this.dispatchEvent(r)}getList(t,e){return e.map((n,i)=>{let a=i!=e.length-1;return`\n                ${n.coff?`<rhea-reaction-block class="coefficient" >${n.coff}</rhea-reaction-block>`:""}\n                <rhea-reaction-block class="participant ${r[n.type]}" index="${t}-${i}"></rhea-reaction-block>\n                ${a?'<rhea-reaction-block class="and">+</rhea-reaction-block>':""}`}).map(t=>t.trim()).join("")}})}])},364:function(t,e,n){var i=n(258);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}},365:function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},366:function(t){t.exports=JSON.parse('{"categories":[{"name":"DOMAINS_AND_SITES","label":"Domains & sites","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"domain","label":"Domain","filter":"DOMAIN","trackType":"protvista-track","tooltip":"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold"},{"name":"region","label":"Region","filter":"REGION","trackType":"protvista-track","tooltip":"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation"},{"name":"motif","label":"Motif","filter":"MOTIF","trackType":"protvista-track","tooltip":"Short conserved sequence motif of biological significance"},{"name":"metal","label":"Metal binding","filter":"METAL","trackType":"protvista-track","tooltip":"Binding site for a metal ion"},{"name":"site","label":"Site","filter":"SITE","trackType":"protvista-track","tooltip":"Any interesting single amino acid site on the sequence"},{"name":"repeat","label":"Repeat","filter":"REPEAT","trackType":"protvista-track","tooltip":"Repeated sequence motifs or repeated domains within the protein"},{"name":"ca_bind","label":"Calcium binding","filter":"CA_BIND","trackType":"protvista-track","tooltip":"Calcium-binding regions, such as the EF-hand motif"},{"name":"dna_bind","label":"DNA binding","filter":"DNA_BIND","trackType":"protvista-track","tooltip":"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain"},{"name":"zn_fing","label":"Zinc finger","filter":"ZN_FING","trackType":"protvista-track","tooltip":"Small, functional, independently folded domain that coordinates one or more zinc ions"},{"name":"np_bind","label":"Nucleotide binding","filter":"NP_BIND","trackType":"protvista-track","tooltip":"(aka flavin-binding). Region in the protein which binds nucleotide phosphates"},{"name":"binding","label":"Binding site","filter":"BINDING","trackType":"protvista-track","tooltip":"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)"},{"name":"act_site","label":"Active site","filter":"ACT_SITE","trackType":"protvista-track","tooltip":"Amino acid(s) directly involved in the activity of an enzyme"}]},{"name":"MOLECULE_PROCESSING","label":"Molecule processing","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"signal","label":"Signal peptide","filter":"SIGNAL","trackType":"protvista-track","tooltip":"N-terminal signal peptide"},{"name":"chain","label":"Chain","filter":"CHAIN","trackType":"protvista-track","tooltip":"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing"},{"name":"transit","label":"Transit peptide","filter":"TRANSIT","trackType":"protvista-track","tooltip":"This describes the extent of a transit peptide"},{"name":"init_met","label":"Initiator methionine","filter":"INIT_MET","trackType":"protvista-track","tooltip":"This indicates that the initiator methionine is cleaved from the mature protein"},{"name":"propep","label":"Propeptide","filter":"PROPEP","trackType":"protvista-track","tooltip":"Part of a protein that is cleaved during maturation or activation"},{"name":"peptide","label":"Peptide","filter":"PEPTIDE","trackType":"protvista-track","tooltip":"The position and length of an active peptide in the mature protein"}]},{"name":"PTM","label":"PTM","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"mod_res","label":"Modified residue","filter":"MOD_RES","trackType":"protvista-track","tooltip":"Modified residues such as phosphorylation, acetylation, acylation, methylation"},{"name":"carbohyd","label":"Glycosylation","filter":"CARBOHYD","trackType":"protvista-track","tooltip":"Covalently attached glycan group(s)"},{"name":"disulfid","label":"Disulfide bond","filter":"DISULFID","trackType":"protvista-track","tooltip":"The positions of cysteine residues participating in disulphide bonds"},{"name":"crosslnk","label":"Cross-link","filter":"CROSSLNK","trackType":"protvista-track","tooltip":"Covalent linkages of various types formed between two proteins or between two parts of the same protein"},{"name":"lipid","label":"Lipidation","filter":"LIPID","trackType":"protvista-track","tooltip":"Covalently attached lipid group(s)"}]},{"name":"SEQUENCE_INFORMATION","label":"Sequence information","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"compbias","label":"Compositional bias","filter":"COMPBIAS","trackType":"protvista-track","tooltip":"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions"},{"name":"conflict","label":"Sequence conflict","filter":"CONFLICT","trackType":"protvista-track","tooltip":"Sequence discrepancies of unknown origin"},{"name":"non_cons","filter":"NON_CONS","trackType":"protvista-track","label":"Non-adjacent residues","tooltip":"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them"},{"name":"non_ter","filter":"NON_TER","trackType":"protvista-track","label":"Non-terminal residue","tooltip":"The sequence is incomplete. The residue is not the terminal residue of the complete protein"},{"name":"unsure","filter":"UNSURE","trackType":"protvista-track","label":"Sequence uncertainty","tooltip":"Regions of a sequence for which the authors are unsure about the sequence assignment"},{"name":"non_std","filter":"NON_STD","trackType":"protvista-track","label":"Non-standard residue","tooltip":"Non-standard amino acids (selenocysteine and pyrrolysine)"}]},{"name":"STRUCTURAL","label":"Structural features","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"helix","label":"Helix","filter":"HELIX","trackType":"protvista-track","tooltip":"The positions of experimentally determined helical regions"},{"name":"strand","label":"Beta strand","filter":"STRAND","trackType":"protvista-track","tooltip":"The positions of experimentally determined beta strands"},{"name":"turn","label":"Turn","filter":"TURN","trackType":"protvista-track","tooltip":"The positions of experimentally determined hydrogen-bonded turns"},{"name":"coiled","label":"Coiled coil","filter":"COILED","trackType":"protvista-track","tooltip":"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil"}]},{"name":"STRUCTURE_COVERAGE","label":"PDBe 3D structure coverage","trackType":"protvista-track","adapter":"protvista-structure-adapter","url":"https://www.ebi.ac.uk/proteins/api/proteins/","tracks":[{"name":"pdbe_cover","label":"PDBe coverage","trackType":"protvista-track","tooltip":"PDBe 3D structure coverage"}]},{"name":"TOPOLOGY","label":"Topology","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"topo_dom","label":"Topological domain","filter":"TOPO_DOM","trackType":"protvista-track","tooltip":"Location of non-membrane regions of membrane-spanning proteins"},{"name":"transmem","label":"Transmembrane","filter":"TRANSMEM","trackType":"protvista-track","tooltip":"Extent of a membrane-spanning region"},{"name":"intramem","label":"Intramembrane","filter":"INTRAMEM","trackType":"protvista-track","tooltip":"Extent of a region located in a membrane without crossing it"}]},{"name":"MUTAGENESIS","label":"Mutagenesis","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/features/","tracks":[{"name":"mutagen","label":"Mutagenesis","filter":"MUTAGEN","trackType":"protvista-track","tooltip":"Site which has been experimentally altered by mutagenesis"}]},{"name":"PROTEOMICS","label":"Proteomics","trackType":"protvista-track","adapter":"protvista-proteomics-adapter","url":"https://www.ebi.ac.uk/proteins/api/proteomics/","tracks":[{"name":"unique","label":"Unique peptide","filter":"unique","trackType":"protvista-track","tooltip":""},{"name":"non_unique","label":"Non-unique peptide","filter":"non_unique","trackType":"protvista-track","tooltip":""}]},{"name":"ANTIGEN","label":"Antigenic sequences","trackType":"protvista-track","adapter":"protvista-feature-adapter","url":"https://www.ebi.ac.uk/proteins/api/antigen/","tracks":[{"name":"antigen","label":"Antibody binding sequences","trackType":"protvista-track","tooltip":""}]},{"name":"VARIATION","label":"Variants","adapter":"protvista-variation-adapter","trackType":"protvista-variation-graph","url":"https://www.ebi.ac.uk/proteins/api/variation/","tracks":[{"name":"variation_graph","trackType":"protvista-variation-graph"},{"name":"variation","filterComponent":"protvista-filter","trackType":"protvista-variation","tooltip":"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events"}]}],"download":[{"type":"features","url":"https://www.ebi.ac.uk/proteins/api/features/"},{"type":"variants","url":"https://www.ebi.ac.uk/proteins/api/variation/"},{"type":"antigens","url":"https://www.ebi.ac.uk/proteins/api/antigen/"},{"type":"proteomics","url":"https://www.ebi.ac.uk/proteins/api/proteomics/"}]}')},368:function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new a(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(369),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(23))},369:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,a,o,s,l=1,c={},u=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){f(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){f(t.data)},i=function(t){a.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(f,0,t)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&f(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(o+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return c[l]=r,i(l),l++},d.clearImmediate=p}function p(t){delete c[t]}function f(t){if(u)setTimeout(f,0,t);else{var e=c[t];if(e){u=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{p(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(23),n(93))},370:function(t,e,n){"use strict";var i=n(203),r=n(182);class a extends i.a{static get properties(){return{filters:{type:Array},selectedFilters:{type:Set},for:{type:String}}}constructor(){super(),this.filters=[],this.selectedFilters=new Set}connectedCallback(){super.connectedCallback(),this.addEventListener("filterChange",this._onFilterChange),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this))}disconnectedCallback(){super.disconnectedCallback(),this.manager&&this.manager.unregister(this),this.removeEventListener("filterChange",this._onFilterChange)}static get styles(){return i.b`
      :host {
        font-size: 0.8rem;
      }

      :host[disabled] {
        opacity: 0.5;
      }

      .protvista_checkbox {
        position: relative;
        cursor: pointer;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        margin-top: 10px;
        line-height: 24px;
        outline: none;
      }

      .protvista_checkbox_input {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
      }

      .checkmark {
        opacity: 0.4;
        height: 25px;
        width: 25px;
        background-color: #eee;
        border-radius: 4px;
        box-sizing: border-box;
        border: 1px solid #bdc3c7;
      }

      .protvista_checkbox_input:checked ~ .checkmark {
        opacity: 1;
      }

      .protvista_checkbox_label {
        margin-left: 0.2rem;
        line-height: 1rem;
      }
    `}render(){const t=Object(r.a)(this.filters,t=>t.type.text);return i.c`
      ${Object.keys(t).map(e=>i.c`
            <h4>${e}</h4>
            <div>
              ${t[e].map(t=>i.c`
                    ${this.getCheckBox(t)}
                  `)}
            </div>
          `)}
    `}getCheckBox(t){const{name:e,options:n}=t,{labels:r}=n;null==n.colors.length&&(n.colors=[n.colors]);const a=n.colors.length>1;return i.c`
      <label
        class="protvista_checkbox ${a?"compound":""}"
        tabindex="0"
      >
        <input
          type="checkbox"
          class="protvista_checkbox_input"
          ?checked="true"
          .value="${e}"
          @change="${()=>this.toggleFilter(e)}"
        />
        <span
          class="checkmark"
          style=${`background: ${a?`\n            linear-gradient(${n.colors[0]},\n            ${n.colors[1]})\n          `:n.colors[0]};`}
        ></span>
        <span class="protvista_checkbox_label">
          ${r.join("/")}
        </span>
      </label>
    `}toggleFilter(t){this.selectedFilters.has(t)?this.selectedFilters.delete(t):this.selectedFilters.add(t),this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0,detail:{type:"filters",handler:"property",for:this.for,value:this.filters.filter(t=>this.selectedFilters.has(t.name)).map(t=>({category:t.type.name,filterFn:t.filterData}))}}))}}e.a=a},372:function(t,e,n){"use strict";(function(t){var i=n(12),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===r?i.a.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.a=function(t,e){if(e)return t.slice();var n=t.length,i=s?s(n):new t.constructor(n);return t.copy(i),i}}).call(this,n(59)(t))},373:function(t,e,n){},383:function(t,e,n){"use strict";var i=n(301),r=n(279),a=n(212),o=n(215),s=n(46);var l=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},c=n(98),u=n(63),h=Object.prototype.hasOwnProperty;var d=function(t,e,n){var i=t[e];h.call(t,e)&&Object(u.a)(i,n)&&(void 0!==n||e in t)||Object(c.a)(t,e,n)};var p=function(t,e,n,i){var r=!n;n||(n={});for(var a=-1,o=e.length;++a<o;){var s=e[a],l=i?i(n[s],t[s],s,n,t):void 0;void 0===l&&(l=t[s]),r?Object(c.a)(n,s,l):d(n,s,l)}return n},f=n(40);var g=function(t,e){return t&&p(e,Object(f.a)(e),t)},m=n(120),b=n(39),v=n(94);var y=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},_=Object.prototype.hasOwnProperty;var w=function(t){if(!Object(b.a)(t))return y(t);var e=Object(v.a)(t),n=[];for(var i in t)("constructor"!=i||!e&&_.call(t,i))&&n.push(i);return n},x=n(56);var C=function(t){return Object(x.a)(t)?Object(m.a)(t,!0):w(t)};var E=function(t,e){return t&&p(e,C(e),t)},S=n(372);var M=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e},A=n(100);var O=function(t,e){return p(t,Object(A.a)(t),e)},k=n(97),T=n(103),N=Object(T.a)(Object.getPrototypeOf,Object),L=n(107),D=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Object(k.a)(e,Object(A.a)(t)),t=N(t);return e}:L.a;var I=function(t,e){return p(t,D(t),e)},P=n(85),j=n(106);var R=function(t){return Object(j.a)(t,C,D)},F=n(79),B=Object.prototype.hasOwnProperty;var H=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&B.call(t,"index")&&(n.index=t.index,n.input=t.input),n},$=n(84);var q=function(t){var e=new t.constructor(t.byteLength);return new $.a(e).set(new $.a(t)),e};var U=function(t,e){var n=e?q(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},W=/\w*$/;var z=function(t){var e=new t.constructor(t.source,W.exec(t));return e.lastIndex=t.lastIndex,e},G=n(21),V=G.a?G.a.prototype:void 0,Z=V?V.valueOf:void 0;var Y=function(t){return Z?Object(Z.call(t)):{}};var X=function(t,e){var n=e?q(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var K=function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return q(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return U(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return X(t,n);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return z(t);case"[object Set]":return new i;case"[object Symbol]":return Y(t)}},J=Object.create,Q=function(){function t(){}return function(e){if(!Object(b.a)(e))return{};if(J)return J(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var tt=function(t){return"function"!=typeof t.constructor||Object(v.a)(t)?{}:Q(N(t))},et=n(11),nt=n(53),it=n(24);var rt=function(t){return Object(it.a)(t)&&"[object Map]"==Object(F.a)(t)},at=n(91),ot=n(83),st=ot.a&&ot.a.isMap,lt=st?Object(at.a)(st):rt;var ct=function(t){return Object(it.a)(t)&&"[object Set]"==Object(F.a)(t)},ut=ot.a&&ot.a.isSet,ht=ut?Object(at.a)(ut):ct,dt={};dt["[object Arguments]"]=dt["[object Array]"]=dt["[object ArrayBuffer]"]=dt["[object DataView]"]=dt["[object Boolean]"]=dt["[object Date]"]=dt["[object Float32Array]"]=dt["[object Float64Array]"]=dt["[object Int8Array]"]=dt["[object Int16Array]"]=dt["[object Int32Array]"]=dt["[object Map]"]=dt["[object Number]"]=dt["[object Object]"]=dt["[object RegExp]"]=dt["[object Set]"]=dt["[object String]"]=dt["[object Symbol]"]=dt["[object Uint8Array]"]=dt["[object Uint8ClampedArray]"]=dt["[object Uint16Array]"]=dt["[object Uint32Array]"]=!0,dt["[object Error]"]=dt["[object Function]"]=dt["[object WeakMap]"]=!1;var pt=function t(e,n,i,r,a,o){var c,u=1&n,h=2&n,p=4&n;if(i&&(c=a?i(e,r,a,o):i(e)),void 0!==c)return c;if(!Object(b.a)(e))return e;var m=Object(et.a)(e);if(m){if(c=H(e),!u)return M(e,c)}else{var v=Object(F.a)(e),y="[object Function]"==v||"[object GeneratorFunction]"==v;if(Object(nt.a)(e))return Object(S.a)(e,u);if("[object Object]"==v||"[object Arguments]"==v||y&&!a){if(c=h||y?{}:tt(e),!u)return h?I(e,E(c,e)):O(e,g(c,e))}else{if(!dt[v])return a?e:{};c=K(e,v,u)}}o||(o=new s.a);var _=o.get(e);if(_)return _;o.set(e,c),ht(e)?e.forEach((function(r){c.add(t(r,n,i,r,e,o))})):lt(e)&&e.forEach((function(r,a){c.set(a,t(r,n,i,a,e,o))}));var w=p?h?R:P.a:h?keysIn:f.a,x=m?void 0:w(e);return l(x||e,(function(r,a){x&&(r=e[a=r]),d(c,a,t(r,n,i,a,e,o))})),c};var ft=function(t){return pt(t,4)};const gt=(t,e,n)=>{if(e.length<=0)return;for(const n of t)if(n.name===e[0])return void gt(n.children,e.slice(1),n);const i={name:e[0],selected:!1,parent:n,children:[]};t.push(i),gt(i.children,e.slice(1),i)};function mt(t,e){const n=t.split(", ");gt(e,n)}function bt(t,e,n){"number"==typeof n?n++:n=1;for(const i of t)i.depth=n,e(i),i.children.length>0&&bt(i.children,e,n)}function vt(t,e){const n=e.find(e=>t.id===e.id);n?t.isoform&&(n.isoform=t.isoform):e.push(t)}var yt=n(280),_t=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a};function wt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const xt=Symbol("implicit");function Ct(){var t=new Map,e=[],n=[],i=xt;function r(r){var a=r+"",o=t.get(a);if(!o){if(i!==xt)return i;t.set(a,o=e.push(r))}return n[(o-1)%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const i of n){const n=i+"";t.has(n)||t.set(n,e.push(i))}return r},r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return Ct(e,n).unknown(i)},wt.apply(r,arguments),r}function Et(){var t,e,n=Ct().unknown(void 0),i=n.domain,r=n.range,a=0,o=1,s=!1,l=0,c=0,u=.5;function h(){var n=i().length,h=o<a,d=h?o:a,p=h?a:o;t=(p-d)/Math.max(1,n-l+2*c),s&&(t=Math.floor(t)),d+=(p-d-t*(n-l))*u,e=t*(1-l),s&&(d=Math.round(d),e=Math.round(e));var f=_t(n).map((function(e){return d+t*e}));return r(h?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),h()):i()},n.range=function(t){return arguments.length?([a,o]=t,a=+a,o=+o,h()):[a,o]},n.rangeRound=function(t){return[a,o]=t,a=+a,o=+o,s=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,h()):s},n.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),h()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),h()):l},n.paddingOuter=function(t){return arguments.length?(c=+t,h()):c},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},n.copy=function(){return Et(i(),[a,o]).round(s).paddingInner(l).paddingOuter(c).align(u)},wt.apply(h(),arguments)}var St=Math.sqrt(50),Mt=Math.sqrt(10),At=Math.sqrt(2);function Ot(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=St?10:a>=Mt?5:a>=At?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=St?10:a>=Mt?5:a>=At?2:1)}var kt=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Tt=function(t){let e=t,n=t;function i(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;n(t[a],e)<0?i=a+1:r=a}return i}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>kt(t(e),n)}(t)),{left:i,center:function(t,n,r,a){null==r&&(r=0),null==a&&(a=t.length);const o=i(t,n,r,a-1);return o>r&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;n(t[a],e)>0?r=a:i=a+1}return i}}};const Nt=Tt(kt),Lt=Nt.right;Nt.left,Tt((function(t){return null===t?NaN:+t})).center;var Dt=Lt,It=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Pt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function jt(){}var Rt="\\s*([+-]?\\d+)\\s*",Ft="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ht=/^#([0-9a-f]{3,8})$/,$t=new RegExp("^rgb\\("+[Rt,Rt,Rt]+"\\)$"),qt=new RegExp("^rgb\\("+[Bt,Bt,Bt]+"\\)$"),Ut=new RegExp("^rgba\\("+[Rt,Rt,Rt,Ft]+"\\)$"),Wt=new RegExp("^rgba\\("+[Bt,Bt,Bt,Ft]+"\\)$"),zt=new RegExp("^hsl\\("+[Ft,Bt,Bt]+"\\)$"),Gt=new RegExp("^hsla\\("+[Ft,Bt,Bt,Ft]+"\\)$"),Vt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Zt(){return this.rgb().formatHex()}function Yt(){return this.rgb().formatRgb()}function Xt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ht.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Kt(e):3===n?new ee(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Jt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Jt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=$t.exec(t))?new ee(e[1],e[2],e[3],1):(e=qt.exec(t))?new ee(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ut.exec(t))?Jt(e[1],e[2],e[3],e[4]):(e=Wt.exec(t))?Jt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=zt.exec(t))?ae(e[1],e[2]/100,e[3]/100,1):(e=Gt.exec(t))?ae(e[1],e[2]/100,e[3]/100,e[4]):Vt.hasOwnProperty(t)?Kt(Vt[t]):"transparent"===t?new ee(NaN,NaN,NaN,0):null}function Kt(t){return new ee(t>>16&255,t>>8&255,255&t,1)}function Jt(t,e,n,i){return i<=0&&(t=e=n=NaN),new ee(t,e,n,i)}function Qt(t){return t instanceof jt||(t=Xt(t)),t?new ee((t=t.rgb()).r,t.g,t.b,t.opacity):new ee}function te(t,e,n,i){return 1===arguments.length?Qt(t):new ee(t,e,n,null==i?1:i)}function ee(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function ne(){return"#"+re(this.r)+re(this.g)+re(this.b)}function ie(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function re(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ae(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new se(t,e,n,i)}function oe(t){if(t instanceof se)return new se(t.h,t.s,t.l,t.opacity);if(t instanceof jt||(t=Xt(t)),!t)return new se;if(t instanceof se)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new se(o,s,l,t.opacity)}function se(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function le(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ce(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}It(jt,Xt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Zt,formatHex:Zt,formatHsl:function(){return oe(this).formatHsl()},formatRgb:Yt,toString:Yt}),It(ee,te,Pt(jt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ee(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ee(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ne,formatHex:ne,formatRgb:ie,toString:ie})),It(se,(function(t,e,n,i){return 1===arguments.length?oe(t):new se(t,e,n,null==i?1:i)}),Pt(jt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new se(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new se(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ee(le(t>=240?t-240:t+120,r,i),le(t,r,i),le(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var ue=t=>()=>t;function he(t,e){return function(n){return t+n*e}}function de(t){return 1==(t=+t)?pe:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):ue(isNaN(e)?n:e)}}function pe(t,e){var n=e-t;return n?he(t,n):ue(isNaN(t)?e:t)}var fe=function t(e){var n=de(e);function i(t,e){var i=n((t=te(t)).r,(e=te(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=pe(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function ge(t){return function(e){var n,i,r=e.length,a=new Array(r),o=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=te(e[n]),a[n]=i.r||0,o[n]=i.g||0,s[n]=i.b||0;return a=t(a),o=t(o),s=t(s),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=s(t),i+""}}}ge((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,s=i<e-1?t[i+2]:2*a-r;return ce((n-i/e)*e,o,r,a,s)}})),ge((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],s=t[(i+2)%e];return ce((n-i/e)*e,r,a,o,s)}}));var me=function(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}};function be(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ve(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=Se(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}var ye=function(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}},_e=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},we=function(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Se(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},xe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ce=new RegExp(xe.source,"g");var Ee=function(t,e){var n,i,r,a=xe.lastIndex=Ce.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=xe.exec(t))&&(i=Ce.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:_e(n,i)})),a=Ce.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})},Se=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?ue(e):("number"===i?_e:"string"===i?(n=Xt(e))?(e=n,fe):Ee:e instanceof Xt?fe:e instanceof Date?ye:be(e)?me:Array.isArray(e)?ve:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?we:_e)(t,e)},Me=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function Ae(t){return+t}var Oe=[0,1];function ke(t){return t}function Te(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ne(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=Te(r,i),a=n(o,a)):(i=Te(i,r),a=n(a,o)),function(t){return a(i(t))}}function Le(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Te(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Dt(t,e,1,i)-1;return a[n](r[n](e))}}function De(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ie(){var t,e,n,i,r,a,o=Oe,s=Oe,l=Se,c=ke;function u(){var t,e,n,l=Math.min(o.length,s.length);return c!==ke&&(t=o[0],e=o[l-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?Le:Ne,r=a=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(o.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((a||(a=i(s,o.map(t),_e)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,Ae),u()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=Me,u()},h.clamp=function(t){return arguments.length?(c=!!t||ke,u()):c!==ke},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}function Pe(){return Ie()(ke,ke)}var je=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Re(t){if(!(e=je.exec(t)))throw new Error("invalid format: "+t);var e;return new Fe({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Fe(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Re.prototype=Fe.prototype,Fe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function Be(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}var He,$e,qe,Ue,We=function(t){return(t=Be(Math.abs(t)))?t[1]:NaN},ze=function(t,e){var n=Be(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},Ge={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ze(100*t,e),r:ze,s:function(t,e){var n=Be(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(He=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Be(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},Ve=function(t){return t},Ze=Array.prototype.map,Ye=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];$e=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Ve:(e=Ze.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Ve:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Ze.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"â":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Re(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,g=t.comma,m=t.precision,b=t.trim,v=t.type;"n"===v?(g=!0,v="g"):Ge[v]||(void 0===m&&(m=12),b=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_="$"===d?a:/[%p]/.test(v)?l:"",w=Ge[v],x=/[defgprs%]/.test(v);function C(t){var r,a,l,d=y,C=_;if("c"===v)C=w(t)+C,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:w(Math.abs(t),m),b&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==h&&(E=!1),d=(E?"("===h?h:c:"-"===h||"("===h?"":h)+d,C=("s"===v?Ye[8+He/3]:"")+C+(E&&"("===h?")":""),x)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){C=(46===l?o+t.slice(r+1):t.slice(r))+C,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var S=d.length+t.length+C.length,M=S<f?new Array(f-S+1).join(e):"";switch(g&&p&&(t=i(M+t,M.length?f-C.length:1/0),M=""),n){case"<":t=d+t+C+M;break;case"=":t=d+M+t+C;break;case"^":t=M.slice(0,S=M.length>>1)+d+t+C+M.slice(S);break;default:t=M+d+t+C}return s(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),C.toString=function(){return t+""},C}return{format:h,formatPrefix:function(t,e){var n=h(((t=Re(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(We(e)/3))),r=Math.pow(10,-i),a=Ye[8+i/3];return function(t){return n(r*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),qe=$e.format,Ue=$e.formatPrefix;function Xe(t,e,n,i){var r,a=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=St?r*=10:a>=Mt?r*=5:a>=At&&(r*=2),e<t?-r:r}(t,e,n);switch((i=Re(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(We(e)/3)))-We(Math.abs(t)))}(a,o))||(i.precision=r),Ue(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,We(e)-We(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-We(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return qe(i)}function Ke(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=Ot(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)*o;else for(o=-o,t=Math.ceil(t*o),e=Math.floor(e*o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)/o;return i&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Xe(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,a=e(),o=0,s=a.length-1,l=a[o],c=a[s],u=10;for(c<l&&(r=l,l=c,c=r,r=o,o=s,s=r);u-- >0;){if((r=Ot(l,c,n))===i)return a[o]=l,a[s]=c,e(a);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return t},t}const Je=(t,e)=>{if(t){let n="";for(const i of t)i.dbReference&&(n+=`<p><a href="//www.uniprot.org/uniprot/${e}#${i.acronym}" target="_blank">${i.diseaseId}</a></p>`);return n}return"N/A"},Qe=()=>{Object(i.a)(".interaction-tooltip").style("opacity",0).style("display","none")},tn=t=>{if(t){let e='<ul class="tree-list">';const n=[];return t.filter(t=>t.locations).forEach(t=>{for(const e of t.locations)mt(e.location.value,n)}),bt(n,t=>e+=`<li style="margin-left:${t.depth}em">${t.name}</li>`),e+"</ul>"}return"N/A"};var en=(t,e,n)=>{const a=n,o=Object(r.a)(t).append("div").attr("class","interaction-tooltip").style("display","none").style("opacity",0);o.append("span").attr("class","close-interaction-tooltip").text("Close â").on("click",Qe),o.append("div").attr("class","tooltip-content"),Object(r.a)(t).append("p").attr("class","interaction-title").text(`${e} has binary interactions with ${a.length-1} proteins`);const s=100,l=0,c=10,u=100,h=18*a.length,d=h,p=Et().rangeRound([0,h]),f=function t(){var e=Pe();return e.copy=function(){return De(e,t())},wt.apply(e,arguments),Ke(e)}().range([.2,1]),g=Object(r.a)(t).append("svg").attr("width",h+u+l).attr("height",d+s+c).attr("class","interaction-viewer").append("g").attr("class","interaction-viewer-group").attr("transform",`translate(${u},${s})`);p.domain(a.map(t=>t.accession)),f.domain([0,10]);const m=(t,e)=>`//www.ebi.ac.uk/intact/query/id:${t} AND id:${e}`,b=t=>{Object(r.a)(void 0).classed("active-cell",!0),Object(i.a)(".interaction-viewer-group").append("line").attr("class","active-row").attr("style","opacity:0.3").attr("x1",0).attr("y1",p(t.source)+p.bandwidth()/2).attr("x2",p(t.id)).attr("y2",p(t.source)+p.bandwidth()/2),Object(i.a)(".interaction-viewer-group").append("line").attr("class","active-row").attr("style","opacity:0.3").attr("x1",p(t.id)+p.bandwidth()/2).attr("y1",0).attr("x2",p(t.id)+p.bandwidth()/2).attr("y2",p(t.source))},v=()=>{Object(i.a)("g").classed("active",!1),Object(i.a)("circle").classed("active-cell",!1),Object(i.a)(".active-row").remove()},y=e=>{((t,e)=>{t.html("");const n=a.find(t=>t.accession===e.source),i=a.find(t=>t.accession===e.id);t.append("h3").text("Interaction"),t.append("p").append("a").attr("href",m(e.interactor1,e.interactor2)).attr("target","_blank").text(`Confirmed by ${e.experiments} experiment(s)`);const r=t.append("table").attr("class","interaction-viewer-table"),o=r.append("tr");o.append("th"),o.append("th").text("Interactor 1"),o.append("th").text("Interactor 2");const s=r.append("tr");s.append("td").text("Name").attr("class","interaction-viewer-table_row-header"),s.append("td").text(""+n.name),s.append("td").text(""+i.name);const l=r.append("tr");if(l.append("td").text("UniProtKB").attr("class","interaction-viewer-table_row-header"),l.append("td").append("a").attr("href","//uniprot.org/uniprot/"+n.accession).text(""+n.accession),l.append("td").append("a").attr("href","//uniprot.org/uniprot/"+i.accession).text(""+i.accession),e.chain1||e.chain2){const t=r.append("tr");t.append("td").text("Chain").attr("class","interaction-viewer-table_row-header"),t.append("td").text(""+(e.chain1?e.chain1:"N/A")),t.append("td").text(""+(e.chain2?e.chain2:"N/A"))}const c=r.append("tr");c.append("td").text("Pathology").attr("class","interaction-viewer-table_row-header"),c.append("td").html(Je(n.diseases,n.accession)),c.append("td").html(Je(i.diseases,i.accession));const u=r.append("tr");u.append("td").text("Subcellular location").attr("class","interaction-viewer-table_row-header"),u.append("td").html(tn(n.subcellularLocations)),u.append("td").html(tn(i.subcellularLocations));const h=r.append("tr");h.append("td").text("IntAct").attr("class","interaction-viewer-table_row-header"),h.append("td").attr("colspan",2).append("a").attr("href",m(e.interactor1,e.interactor2)).attr("target","_blank").text(`${e.interactor1};${e.interactor2}`)})(Object(i.a)(".tooltip-content"),e),o.style("opacity",.9).style("display","inline").style("left",Object(yt.a)(t)[0]+10+"px").style("top",Object(yt.a)(t)[1]-15+"px")};const _=g.selectAll(".interaction-row").data(a).enter().append("g").attr("class","interaction-row").attr("transform",t=>`translate(0,${p(t.accession)})`).each((function(t){if(!t.interactions)return;const e=Object(r.a)(this).selectAll(".cell").data(t.interactions);e.enter().append("circle").attr("class","cell").attr("cx",t=>p(t.id)+p.bandwidth()/2).attr("cy",()=>p.bandwidth()/2).attr("r",p.bandwidth()/3).style("fill-opacity",t=>f(t.experiments)).style("display",e=>p(t.accession)<p(e.id)?"none":"").on("click",y).on("mouseover",b).on("mouseout",v),e.exit().remove()}));_.append("rect").attr("x",-u).attr("width",u).attr("height",p.bandwidth()).attr("class","text-highlight"),_.append("text").attr("y",p.bandwidth()/2).attr("dy",".32em").attr("text-anchor","end").text((t,e)=>a[e].name).attr("class",(t,n)=>a[n].accession===e?"main-accession":"");const w=g.selectAll(".column").data(a).enter().append("g").attr("class","column").attr("transform",t=>`translate(${p(t.accession)}, 0)rotate(-90)`);w.append("rect").attr("x",6).attr("width",s).attr("height",p.bandwidth()).attr("class","text-highlight"),w.append("text").attr("x",6).attr("y",p.bandwidth()/2).attr("dy",".32em").attr("text-anchor","start").text((t,e)=>a[e].name).attr("class",(t,n)=>a[n].accession===e?"main-accession":"");const x=`${p(a[1].accession)} 0,${p(a[a.length-1].accession)} 0,${p(a[a.length-1].accession)} ${p(a[a.length-1].accession)},${p(a[0].accession)} 0`;g.append("polyline").attr("points",x).attr("class","hidden-side").attr("transform",()=>`translate(${p(a[1].accession)}, 0)`)};function nn(){const t="#"+Object(r.a)(this).attr("data-toggle"),e=Object(r.a)(t).style("visibility");Object(r.a)(".dropdown-pane").style("visibility","hidden"),Object(r.a)(t).style("visibility","hidden"===e?"visible":"hidden")}function rn(t){return t.toLowerCase().replace(/\s|,|^\d/g,"_")}var an=function(t,e,n,i,a,o){Object(r.a)(t).selectAll(".interaction-filter-container").remove();const s=Object(r.a)(t).append("div").attr("class","interaction-filter-container");for(const t of e)if(t.items.length>0){const e=s.append("div").attr("class","interaction-filter");e.append("a").text(t.label).attr("class","button dropdown").attr("data-toggle","iv_"+t.name).on("click",nn);const r=e.append("ul").attr("id","iv_"+t.name).attr("class","dropdown-pane");if(r.append("li").text("None").on("click",()=>a(t.name,t.label)),"tree"===t.type)bt(t.items,e=>{e.type=t.name,n.push(e),r.datum(e).append("li").style("padding-left",e.depth+"em").attr("id",t=>rn(t.name)).text(t=>t.name).on("click",e=>i(e,t.name))});else{for(const e of t.items)e.type=t.name,n.push(e);r.selectAll("li").data(t.items).enter().append("li").attr("id",t=>rn(t.name)).text(t=>t.name.toLowerCase()).on("click",e=>{i(e,t.name)})}}return s.append("button").attr("class","iv_reset").text("Reset filters").on("click",()=>(o(),!1)),n};n(373);function on(t,e){return[{name:"subcellularLocations",label:"Subcellular location",type:"tree",items:t},{name:"diseases",label:"Diseases",items:e}]}class sn extends HTMLElement{constructor(){super(),this.mode="ADJACENCY_GRAPH",this.filters=[],this.nodes=null,this.clickFilter=this.clickFilter.bind(this),this.resetFilter=this.resetFilter.bind(this),this.resetAllFilters=this.resetAllFilters.bind(this),this.updateFilterSelection=this.updateFilterSelection.bind(this),this.filterData=this.filterData.bind(this),this.getNodeByAccession=this.getNodeByAccession.bind(this)}connectedCallback(){this._accession=this.getAttribute("accession"),this.render()}static get observedAttributes(){return["accession"]}attributeChangedCallback(t,e,n){"accession"===t&&null!=e&&e!==n&&(this._accession=n,this.render())}set accession(t){this._accession=t}get accession(){return this._accession}clickFilter(t,e){var n;Object(i.a)(".dropdown-pane").style("visibility","hidden"),this.filters.filter(t=>t.type===e).forEach(t=>t.selected=!1),t.selected=!t.selected,Object(r.a)(`[data-toggle=iv_${e}]`).text((n=t.name).length>25?n.substr(0,24)+"...":n),this.updateFilterSelection()}resetFilter(t,e){Object(i.a)(".dropdown-pane").style("visibility","hidden"),this.filters.filter(e=>e.type===t).forEach(t=>t.selected=!1),Object(r.a)(`[data-toggle=iv_${t}]`).text(e),this.updateFilterSelection()}updateFilterSelection(){for(const t of this.filters){Object(r.a)("#"+rn(t.name)).classed("active",t.selected)}this.filterData()}resetAllFilters(){this.filters.filter(t=>t.selected).forEach(t=>t.selected=!1),on().forEach(t=>{Object(r.a)(`[data-toggle=iv_${t.name}]`).text(t.label)}),this.updateFilterSelection()}getNodeByAccession(t){return this.nodes.find(e=>e.accession===t)}filterData(){const t=this.filters.filter(t=>t.selected),e=[];Object(i.a)(".cell").attr("opacity",n=>{const i=this.getNodeByAccession(n.source),r=this.getNodeByAccession(n.id),s=((t,e,n)=>{if(n.length<=0)return!0;const i=Object(a.a)(t.filterTerms,e.filterTerms);return Object(o.a)(i,n.map(t=>t.name)).length===n.length})(i,r,t);return s&&(e.push(i.accession),e.push(r.accession)),s?1:.1}),Object(i.a)(".interaction-viewer text").attr("fill-opacity",t=>e.includes(t.accession)?1:.1)}async render(){if(!this._accession)return;this.style.display="block",this.style.minHeight="6em",Object(r.a)(this).select(".interaction-title").remove(),Object(r.a)(this).select("svg").remove(),Object(r.a)(this).select(".interaction-tooltip").remove();const t=await function(t){const e=`https://www.ebi.ac.uk/proteins/api/proteins/interaction/${t}.json`;return fetch(e).then(t=>404===t.status?null:t.ok?204===t.status?null:t.json():(console.error(new Error(`Request Failed: Status = ${t.status}; URI = ${e}; Time = ${new Date}`)),null)).then(t=>t)}(this._accession);if(t){const{data:n,subcellulartreeMenu:i,diseases:r}=function(t){const e=[],n={};t=t.map(t=>(t.interactions||(t.interactions=[]),t));for(const e of t)for(const n of e.interactions){const i=t.find(t=>t.accession===n.accession2);if(i&&!i.interactions.find(t=>t.id===e.accession)){const t=ft(n);t.id=e.accession,i.interactions.push(t)}}for(const i of t){i.filterTerms=[];const r=[];for(const e of i.interactions)"SELF"===e.interactionType?(e.source=i.accession,e.id=i.accession,vt(e,r)):t.some(t=>t.accession===e.id)&&(e.source=i.accession,vt(e,r));if(i.interactions=r,i.subcellularLocations&&i.subcellularLocations.filter(t=>t.locations).forEach(t=>{for(const n of t.locations){mt(n.location.value,e);const t=n.location.value.split(", ");i.filterTerms=i.filterTerms.concat(t)}}),i.diseases)for(const t of i.diseases)t.diseaseId&&(n[t.diseaseId]={name:t.diseaseId,selected:!1},i.filterTerms.push(t.diseaseId))}return{data:t,subcellulartreeMenu:e,diseases:Object.values(n)}}(t);switch(this.nodes=n,this.dispatchEvent(new CustomEvent("protvista-event",{detail:{loaded:!0,error:e},bubbles:!0})),an(this,on(i,r),this.filters,this.clickFilter,this.resetFilter,this.resetAllFilters),this.mode){case"ADJACENCY_GRAPH":en(this,this._accession,t,on(i,r))}}var e}}e.a=sn},384:function(t,e,n){"use strict";n.d(e,"a",(function(){return T}));var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16);function a(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(t){return"string"==typeof t&&o.test(t)},l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));var u,h,d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[t[e+0]]+l[t[e+1]]+l[t[e+2]]+l[t[e+3]]+"-"+l[t[e+4]]+l[t[e+5]]+"-"+l[t[e+6]]+l[t[e+7]]+"-"+l[t[e+8]]+l[t[e+9]]+"-"+l[t[e+10]]+l[t[e+11]]+l[t[e+12]]+l[t[e+13]]+l[t[e+14]]+l[t[e+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n},p=0,f=0;var g=function(t,e,n){var i=e&&n||0,r=e||new Array(16),o=(t=t||{}).node||u,s=void 0!==t.clockseq?t.clockseq:h;if(null==o||null==s){var l=t.random||(t.rng||a)();null==o&&(o=u=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==s&&(s=h=16383&(l[6]<<8|l[7]))}var c=void 0!==t.msecs?t.msecs:Date.now(),g=void 0!==t.nsecs?t.nsecs:f+1,m=c-p+(g-f)/1e4;if(m<0&&void 0===t.clockseq&&(s=s+1&16383),(m<0||c>p)&&void 0===t.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=c,f=g,h=s;var b=(1e4*(268435455&(c+=122192928e5))+g)%4294967296;r[i++]=b>>>24&255,r[i++]=b>>>16&255,r[i++]=b>>>8&255,r[i++]=255&b;var v=c/4294967296*1e4&268435455;r[i++]=v>>>8&255,r[i++]=255&v,r[i++]=v>>>24&15|16,r[i++]=v>>>16&255,r[i++]=s>>>8|128,r[i++]=255&s;for(var y=0;y<6;++y)r[i+y]=o[y];return e||d(r)};var m=[{name:"ECO:0000269",description:"Manual assertion based on experiment",shortDescription:"Publication",acronym:"EXP",isManual:!0},{name:"ECO:0000303",description:"Manual assertion based on opinion",shortDescription:"Publication",acronym:"NAS",isManual:!0},{name:"ECO:0000305",description:"Manual assertion inferred by curator",shortDescription:"Curated",acronym:"IC",isManual:!0},{name:"ECO:0000250",description:"Manual assertion inferred from sequence similarity",shortDescription:"By similarity",acronym:"ISS",isManual:!0},{name:"ECO:0000255",description:"Manual assertion according to rules",shortDescription:"Sequence Analysis",acronym:"ISM",isManual:!0},{name:"ECO:0000244",description:"Manual assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXM",isManual:!0},{name:"ECO:0000312",description:"Manual assertion inferred from database entries",shortDescription:"Imported",acronym:"MI",isManual:!0},{name:"ECO:0000256",description:"Automatic assertion according to rules",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000259",description:"Automatic assertion inferred from signature match",shortDescription:"Automatic annotation",acronym:"AA"},{name:"ECO:0000213",description:"Automatic assertion inferred from combination of experimental and computational evidence",shortDescription:"Combined sources",acronym:"MIXA"},{name:"ECO:0000313",description:"Automatic assertion inferred from database entries",shortDescription:"Imported",acronym:"AI"}];const b=t=>t?`\n      <ul>${t.map(t=>{const e=m.find(e=>e.name===t.code);return e?`<li title='${e.description}' style="padding: .25rem 0">${e.shortDescription}:&nbsp;${t.source?(n=t.source,n.name.toLowerCase()==="PubMed".toLowerCase()?`${n.id}&nbsp;(<a href='${n.url}' style="color:#FFF" target='_blank'>${n.name}</a>&nbsp;<a href='${n.alternativeUrl}' style="color:#FFF" target='_blank'>EuropePMC</a>)`:`&nbsp;<a href='${n.url}' style="color:#FFF" target='_blank'>${n.id}</a>&nbsp;(${n.name})`):""}</li>`:"";var n}).join("")}</ul>\n    `:"",v=t=>`<ul>${t.map(t=>`<li style="padding: .25rem 0">${t.name} ${t.url?`<a href="${t.url}" style="color:#FFF" target="_blank">${t.id}</a>`:`${t.name} ${t.id}`}</li>`).join("")}</ul>`;HTMLElement;var y=n(182);var _,w,x,C,E,S,M,A,O=t=>{return`\n                <h5>Variant</h5><p>${t.wildType} > ${t.alternativeSequence}</p>\n                ${t.populationFrequencies?(i=t.populationFrequencies,"<hr/><h5>Population frequencies</h5>"+i.map(t=>`<p>${t.frequency} - ${t.populationName} (${t.source})</p>`).join("")):""}\n                ${t.consequenceType?`<h5>Consequence</h5><p>${t.consequenceType}</p>`:""}\n                ${t.somaticStatus?`<h5>Somatic</h5><p>${0===t.somaticStatus?"No":"Yes"}</p>`:""}\n                ${t.genomicLocation?`<h5>Location</h5><p>${t.genomicLocation}</p>`:""}\n                ${t.ftId?`<h5>Feature ID</h5><p>${t.ftId}</p>`:""}\n                ${t.descriptions?(n=t.descriptions,`<hr/><h5>Description</h5>${n.map(t=>`<p>${t.value}</p>`).join("")}\n  `):""}\n                ${t.association?(e=t.association,null==e?void 0:e.map(t=>`\n              <h4>Disease association</h4><p>${t.name}</p>\n              ${t.description?`<>${t.description}</p>`:""}\n              ${t.dbReferences?"<h5>Cross-references</h5>"+v(t.dbReferences):""}\n              ${b(t.evidences)}\n          `).join("")):""}\n                ${t.predictions?(t=>{const e=Object(y.a)(t,"predAlgorithmNameType");return Object.keys(e).map(t=>{const n=Object(y.a)(e[t],"predictionValType");return{algorithm:t,values:Object.keys(n).map(t=>({name:t,count:n[t].length}))}}).map(t=>`<h6>${t.algorithm}</h6><ul class="no-bullet">${t.values.map(t=>`<li>${t.name}</li>`).join("")}</ul>`).join("")})(t.predictions):""}\n\n                \n        `;var e,n,i};!function(t){t.A="A",t.C="C",t.D="D",t.E="E",t.Empty="*",t.F="F",t.G="G",t.H="H",t.I="I",t.K="K",t.L="L",t.M="M",t.N="N",t.Nl="NL",t.P="P",t.Q="Q",t.R="R",t.S="S",t.T="T",t.V="V",t.W="W",t.Y="Y"}(_||(_={})),function(t){t.CLINVAR="ClinVar",t.ESP="ESP",t.EXAC="ExAC",t.GENOMES1K="1000Genomes",t.BOVINE_SNP50="BovineSNP50",t.BOVINE_LD="BovineLD",t.BOVINE_HD="BovineHD",t.EQUINE_SNP50="EquineSNP50",t.CHICKEN_600K="Chicken600K",t.KG_HQ="1kg_hq",t.COSMIC="cosmic curated",t.REVIEWED="reviewed",t.UNIPROT="UniProt",t.DBSNP="dbSNP",t.ENSEMBL="Ensembl",t.ENSEMBL_PLANTS="EnsemblPlants",t.VECTORBASE="VectorBase",t.REFSEQ="RefSeq",t.DBGAP="dbGaP",t.DDD="DDD",t.PHARMCOGKB="PharmGKB",t.ENSEMBL_FUNGI="EnsemblFungi",t.ENSEMBL_METAZOA="EnsemblMetazoa",t.GNOMAD_V2="gnomAD_v2.0",t.GNOMAD_V3="gnomAD_v3.0",t.TCGA="NCI-TCGA",t.TCGA_COSMIC="NCI-TCGA Cosmic",t.DECIPHER="ddG2P",t.TOPMED="TOPMed",t.GNOMAD="gnomAD",t.PHARMGKB="pharmgkb",t.SGRP="SGRP",t.SGD="SGD",t.JEFFARES_SNPS="Jeffares_SNPs",t.JEFFARES_INDELS="Jeffares_Indels"}(w||(w={})),function(t){t.Benign="Benign",t.Disease="Disease",t.LikelyBenign="Likely benign",t.LikelyPathogenic="Likely pathogenic",t.Pathogenic="Pathogenic",t.Protective="Protective",t.VariantOfUncertainSignificance="Variant of uncertain significance"}(x||(x={})),function(t){t.Empty="-",t.Frameshift="frameshift",t.InframeDeletion="inframe deletion",t.Insertion="insertion",t.Missense="missense",t.StopGained="stop gained"}(C||(C={})),function(t){t.PolyPhen="PolyPhen",t.Sift="SIFT"}(E||(E={})),function(t){t.Benign="benign",t.Deleterious="deleterious",t.DeleteriousLowConfidence="deleterious - low confidence",t.PossiblyDamaging="possibly damaging",t.ProbablyDamaging="probably damaging",t.Tolerated="tolerated",t.ToleratedLowConfidence="tolerated - low confidence",t.Unknown="unknown"}(S||(S={})),function(t){t.LargeScaleStudy="large_scale_study",t.Mixed="mixed",t.UniProt="uniprot"}(M||(M={})),function(t){t.Variant="VARIANT"}(A||(A={}));const k=(t,e)=>{const n=t?t.map(t=>t.name):[];return"uniprot"!==e&&"mixed"!==e||n.push("uniprot"),n},T=t=>{const{sequence:e,features:n}=t,i=n.map(t=>({type:A.Variant,accession:t.genomicLocation,variant:t.alternativeSequence?t.alternativeSequence:"-",start:t.begin,end:t.end,tooltipContent:O(t),association:t.association,sourceType:t.sourceType,xrefNames:k(t.xrefs,t.sourceType),clinicalSignificances:t.clinicalSignificances,hasPredictions:t.predictions&&t.predictions.length>0,protvistaFeatureId:g()}));return i?{sequence:e,variants:i}:null}},385:function(t,e,n){"use strict";var i=n(308),r=n(191),a=n(212),o=n(215),s=n(182);var l=function(t){const{variants:e,sequence:n}=t;if(!n||!e)return null;const i=n.split("").map((t,e)=>({type:"VARIANT",normal:t,pos:e+1,variants:[]}));return e.forEach(t=>{i[t.start-1]&&i[t.start-1].variants.push(t)}),i};var c=class{constructor(){this._frequency=Object(r.k)().exponent(.001).domain([0,1]).range([5,10]),this.drawVariationPlot=this.drawVariationPlot.bind(this)}drawVariationPlot(t,e){const n=e.getSingleBaseWidth()/2;t.each((t,i,a)=>{const o=Object(r.l)(a[i]),s=t.filter(t=>0!==t.variants.length),l=o.selectAll("g").data(s,t=>t.pos);l.exit().remove();const c=l.enter().append("g").merge(l).selectAll("circle").data(t=>t.variants);c.exit().remove(),c.enter().append("circle").merge(c).attr("class","feature").attr("title",t=>t.start).attr("r",t=>t.size?t.size:5).attr("cx",t=>e.getXFromSeqPosition(t.start)+n).attr("cy",t=>e._yScale(t.variant.charAt(0))).attr("name",t=>{const e="*"===t.alternativeSequence?"STOP":t.alternativeSequence;return t.internalId=`var_${t.wildType}${t.start}${e}`,t.internalId}).attr("fill",t=>e._colorConfig?e._colorConfig(t):t.color).call(e.bindEvents,e)})}};const u=["G","A","V","L","I","S","T","C","M","D","N","E","Q","R","K","H","F","Y","W","P","d","*"],h=(t,e)=>{if(!t||t.length<=0)return null;const n=t[0];return n.forEach((n,i)=>{const r=t.map(t=>t[i].variants);n.variants=e(...r)}),n};class d extends i.a{connectedCallback(){super.connectedCallback();const t=document.createElement("style");t.innerHTML=d.css,this.appendChild(t),this._height=Number(this.getAttribute("height"))?Number(this.getAttribute("height")):430,this._width=this._width?this._width:0,this._yScale=Object(r.i)(),this._yScale=Object(r.j)().domain(u).range([0,this._height-this.margin.top-this.margin.bottom])}processData(t){this._originalData=l(t)}static get css(){return"\n    <style>\n    protvista-variation {\n      display: flex;\n      width: 100%;\n    }\n    \n    protvista-variation svg {\n      background-color: #fff;\n    }\n    \n    protvista-variation circle {\n      opacity: 0.6;\n    }\n    protvista-variation circle:hover {\n      opacity: 0.9;\n    }\n    protvista-variation .tick line,\n    protvista-variation .axis path {\n      opacity: 0.1;\n    }\n    \n    .protvista-highlight {\n      fill: #ffe999;\n    }\n    \n    protvista-variation .variation-y-right line,\n    protvista-variation .axis path {\n      fill: none;\n      stroke: none;\n    }\n    \n    </style>\n    "}_createFeatures(){this._variationPlot=new c;const t=super.svg.select("g.sequence-features"),e=t.attr("transform",`translate(0, ${this.margin.top})`).append("g").attr("clip-path","url(#plotAreaClip)");this._clipPath=t.append("clipPath").attr("id","plotAreaClip").append("rect").attr("width",this.getWidthWithMargins()).attr("height",this._height).attr("transform",`translate(0, -${this.margin.top})`),this._series=e.datum(this._data),this._axisLeft=t.append("g"),this._axisRight=t.append("g"),this.updateScale()}set filters(t){super.filters=t,this.updateData(this._data),this.refresh()}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Object(s.a)(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return h(e,a.a)});this._data=h(e,o.a)}set colorConfig(t){this._colorConfig=t}get colorConfig(){return this._colorConfig}refresh(){this._series&&(this._clipPath.attr("width",this.getWidthWithMargins()),this.updateScale(),this._series.call(this._variationPlot.drawVariationPlot,this),this._updateHighlight())}updateScale(){this._yAxisLScale=Object(r.b)().scale(this._yScale).tickSize(-this.getWidthWithMargins()),this._yAxisRScale=Object(r.c)().scale(this._yScale),this._axisLeft.attr("class","variation-y-left axis").attr("transform",`translate(${this.margin.left},0)`).call(this._yAxisLScale),this._axisRight.attr("transform",`translate(${this.getWidthWithMargins()-this.margin.right+2}, 0)`).attr("class","variation-y-right axis").call(this._yAxisRScale)}updateData(t){this._series&&this._series.datum(t)}}e.a=d},386:function(t,e,n){"use strict";var i="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==i&&i,r="URLSearchParams"in i,a="Symbol"in i&&"iterator"in Symbol,o="FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch(t){return!1}}(),s="FormData"in i,l="ArrayBuffer"in i;if(l)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(t){return t&&c.indexOf(Object.prototype.toString.call(t))>-1};function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function d(t){return"string"!=typeof t&&(t=String(t)),t}function p(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return a&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function g(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function b(t){var e=new FileReader,n=m(e);return e.readAsArrayBuffer(t),n}function v(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:o&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:s&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():l&&o&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l&&(ArrayBuffer.prototype.isPrototypeOf(t)||u(t))?this._bodyArrayBuffer=v(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var t=g(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=g(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(b)}),this.text=function(){var t,e,n,i=g(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=m(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=h(t),e=d(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},f.prototype.delete=function(t){delete this.map[h(t)]},f.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},f.prototype.set=function(t,e){this.map[h(t)]=d(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),p(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),p(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),p(t)},a&&(f.prototype[Symbol.iterator]=f.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,r=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(n=e.method||this.method||"GET",i=n.toUpperCase(),_.indexOf(i)>-1?i:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var a=/([?&])_=[^&]*/;if(a.test(this.url))this.url=this.url.replace(a,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function x(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}})),e}function C(t,e){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},y.call(w.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},C.error=function(){var t=new C(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];C.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new C(null,{status:e,headers:{location:t}})};var S=i.DOMException;try{new S}catch(t){(S=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function M(t,e){return new Promise((function(n,r){var a=new w(t,e);if(a.signal&&a.signal.aborted)return r(new S("Aborted","AbortError"));var s=new XMLHttpRequest;function c(){s.abort()}s.onload=function(){var t,e,i={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}})),e)};i.url="responseURL"in s?s.responseURL:i.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;setTimeout((function(){n(new C(r,i))}),0)},s.onerror=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){r(new S("Aborted","AbortError"))}),0)},s.open(a.method,function(t){try{return""===t&&i.location.href?i.location.href:t}catch(e){return t}}(a.url),!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&(o?s.responseType="blob":l&&a.headers.get("Content-Type")&&-1!==a.headers.get("Content-Type").indexOf("application/octet-stream")&&(s.responseType="arraybuffer")),!e||"object"!=typeof e.headers||e.headers instanceof f?a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})):Object.getOwnPropertyNames(e.headers).forEach((function(t){s.setRequestHeader(t,d(e.headers[t]))})),a.signal&&(a.signal.addEventListener("abort",c),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",c)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}M.polyfill=!0,i.fetch||(i.fetch=M,i.Headers=f,i.Request=w,i.Response=C);var A=n(296),O=n.n(A);class k extends HTMLElement{constructor(){super(),this._mappings=[],this.loadMolecule=this.loadMolecule.bind(this),this._planHighlight=this._planHighlight.bind(this),this.propagateHighlight=this.propagateHighlight.bind(this)}get css(){return`\n    :root {\n      --blue: 0, 112, 155;\n    }\n  \n    protvista-structure h4 {\n      display: inline;\n      margin-right: 1em;\n    }\n      \n    .litemol-container {\n      position: relative;\n      height: ${this._height};\n    }\n\n    .lm-viewport-controls {\n      display: ${this.hideViewportControls?"none":"block"};\n    }\n    `}get accession(){return this._accession}set accession(t){return this.setAttribute("accession",t),this._accession}get pdbId(){return this._pdbID}set pdbId(t){this.setAttribute("pdbid",t),this._pdbID=t}get height(){return this.getAttribute("height")}get hideViewportControls(){return this.getAttribute("hide-viewport-controls")}connectedCallback(){this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._pdbId=this.getAttribute("pdb-id"),this._accession=this.getAttribute("accession"),this._height=this.getAttribute("height")||"480px",this._highlight=this.getAttribute("highlight")&&k._formatHighlight(this.getAttribute("highlight"));const t=document.createElement("style");t.innerHTML=this.css,this.appendChild(t);const e=document.createElement("div");e.className="litemol-container",e.id="litemol-instance",this.messageContainer=document.createElement("span"),this.appendChild(this.messageContainer),this.appendChild(e),this.loadLiteMol()}disconnectedCallback(){this.manager&&this.manager.unregister(this)}static get observedAttributes(){return["highlight","pdb-id","height"]}static _formatHighlight(t){return t.split(",").map(t=>{const[e,n]=t.split(":");return{start:Number(e),end:Number(n)}})}attributeChangedCallback(t,e,n){if(e!==n){const e=parseFloat(n);switch(this["_"+t]="number"==typeof e?n:e,t){case"pdb-id":this._pdbId=n,this.selectMolecule(this._pdbId);break;case"accession":this._accession=n;break;case"highlight":this._highlight=k._formatHighlight(this.getAttribute("highlight"));break;case"height":this._height=n}this._planHighlight(!0)}}_planHighlight(){this._plannedRender||(this._plannedRender=!0,requestAnimationFrame(()=>{this._plannedRender=!1,this._selectedMolecule&&this.highlightChain()}))}async loadPDBEntry(t){try{const e=await fetch("https://www.ebi.ac.uk/pdbe/api/mappings/uniprot/"+t);return await e.json()}catch(t){throw this.addMessage("Couldn't load PDB entry"),new Error(t)}}async selectMolecule(t){const e=await this.loadPDBEntry(t),n=this.processMapping(e);await this.loadMolecule(t),this._selectedMolecule={id:t,mappings:n},this._planHighlight()}loadLiteMol(){const{Plugin:t}=O.a;this.Command=O.a.Bootstrap.Command,this.Query=O.a.Core.Structure.Query,this.Bootstrap=O.a.Bootstrap,this.Core=O.a.Core,this.Tree=this.Bootstrap.Tree,this.CoreVis=O.a.Visualization,this.Transformer=this.Bootstrap.Entity.Transformer,this.Visualization=this.Bootstrap.Visualization,this.Event=this.Bootstrap.Event,this.Context=t.Components.Context,this._liteMol=t.create({target:this.querySelector("#litemol-instance"),viewportBackground:"#fff",layoutState:{hideControls:!0},allowAnalytics:!1}),this.Event.Molecule.ModelSelect.getStream(this._liteMol.context).subscribe(t=>this.propagateHighlight(t))}loadMolecule(t){this._liteMol.clear();const e=this._liteMol.createTransform();return e.add(this._liteMol.root,this.Transformer.Data.Download,{url:`https://www.ebi.ac.uk/pdbe/coordinates/${t.toLowerCase()}/full?encoding=BCIF`,type:"Binary",_id:t}).then(this.Transformer.Data.ParseBinaryCif,{id:t},{isBinding:!0,ref:"cifDict"}).then(this.Transformer.Molecule.CreateFromMmCif,{blockIndex:0},{isBinding:!0}).then(this.Transformer.Molecule.CreateModel,{modelIndex:0},{isBinding:!1,ref:"model"}).then(this.Transformer.Molecule.CreateMacromoleculeVisual,{polymer:!0,polymerRef:"polymer-visual",het:!0,water:!0}),this._liteMol.applyTransform(e)}getTheme(){const t=new Map;return t.set("Uniform",this.CoreVis.Color.fromRgb(207,178,178)),t.set("Selection",this.CoreVis.Color.fromRgb(255,0,0)),t.set("Highlight",this.CoreVis.Theme.Default.HighlightColor),this.Visualization.Molecule.uniformThemeProvider(void 0,{colors:t})}addMessage(t){this.removeMessage(),this._liteMol.command(this.Bootstrap.Command.Toast.Show,{key:"UPMessage",message:t,timeoutMs:3e4})}removeMessage(){this._liteMol.command(this.Bootstrap.Command.Toast.Hide,{key:"UPMessage"})}processMapping(t){return Object.values(t)[0].UniProt[this._accession]?Object.values(t)[0].UniProt[this._accession].mappings:null}translatePositions(t,e,n="UP_PDB"){if("string"==typeof this.highlight||Number.isNaN(t)||Number.isNaN(e))return null;for(const i of this._selectedMolecule.mappings)if(i.unp_end-i.unp_start==i.end.residue_number-i.start.residue_number){if("UP_PDB"===n&&t>=i.unp_start&&e<=i.unp_end||"PDB_UP"===n&&t>=i.start.residue_number&&e<=i.end.residue_number){const r=i.unp_start-i.start.residue_number;return{entity:i.entity_id,chain:i.chain_id,start:"UP_PDB"===n?t-r:t+r,end:"UP_PDB"===n?e-r:e+r}}}else this.addMessage("Mismatch between protein sequence and structure residues");return null}propagateHighlight(t){if(!t.data||!t.data.residues)return;const e=t.data.residues.map(t=>this.translatePositions(t.seqNumber,t.seqNumber,"PDB_UP")).map(t=>`${t.start}:${t.end}`),n=new CustomEvent("change",{detail:{highlight:e.join(",")},bubbles:!0,cancelable:!0});this.dispatchEvent(n)}highlightChain(){if(!this._highlight)return;this.Command.Visual.ResetTheme.dispatch(this._liteMol.context,void 0),this.Command.Tree.RemoveNode.dispatch(this._liteMol.context,"sequence-selection");const t=this._liteMol.context.select("polymer-visual")[0];if(!t)return;const e=this._highlight.map(({start:t,end:e})=>this.translatePositions(t,e)).filter(t=>t);if(!e||0===e.length)return;const n=e.map(t=>this.Query.sequence(t.entity.toString(),t.chain,{seqNumber:t.start},{seqNumber:t.end})),i=this.getTheme(),r=this._liteMol.createTransform();n.forEach(e=>r.add(t,this.Transformer.Molecule.CreateSelectionFromQuery,{query:e},{ref:"sequence-selection"})),this._liteMol.applyTransform(r).then(()=>{this.Command.Visual.UpdateBasicTheme.dispatch(this._liteMol.context,{visual:t,theme:i})}),this.removeMessage()}}e.a=k},396:function(t,e,n){"use strict";var i=n(267);e.a=function(t){return(null==t?0:t.length)?Object(i.a)(t,1):[]}},397:function(t,e,n){"use strict";var i=n(310);e.a=function(t){return t&&t.length?Object(i.a)(t):[]}},401:function(t,e,n){"use strict";var i=n(267),r=n(92),a=n(119),o=n(121),s=n(56);var l=function(t,e){var n=-1,i=Object(s.a)(t)?Array(t.length):[];return Object(o.a)(t,(function(t,r,a){i[++n]=e(t,r,a)})),i};var c=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t},u=n(91),h=n(42);var d=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,r=t==t,a=Object(h.a)(t),o=void 0!==e,s=null===e,l=e==e,c=Object(h.a)(e);if(!s&&!c&&!a&&t>e||a&&o&&l&&!s&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!a&&!c&&t<e||c&&n&&r&&!i&&!a||s&&n&&r||!o&&r||!l)return-1}return 0};var p=function(t,e,n){for(var i=-1,r=t.criteria,a=e.criteria,o=r.length,s=n.length;++i<o;){var l=d(r[i],a[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return t.index-e.index},f=n(60);var g=function(t,e,n){var i=-1;e=Object(r.a)(e.length?e:[f.a],Object(u.a)(a.a));var o=l(t,(function(t,n,a){return{criteria:Object(r.a)(e,(function(e){return e(t)})),index:++i,value:t}}));return c(o,(function(t,e){return p(t,e,n)}))},m=n(265),b=n(63),v=n(66),y=n(39);var _=function(t,e,n){if(!Object(y.a)(n))return!1;var i=typeof e;return!!("number"==i?Object(s.a)(n)&&Object(v.a)(e,n.length):"string"==i&&e in n)&&Object(b.a)(n[e],t)},w=Object(m.a)((function(t,e){if(null==t)return[];var n=e.length;return n>1&&_(t,e[0],e[1])?e=[]:n>2&&_(e[0],e[1],e[2])&&(e=[e[0]]),g(t,Object(i.a)(e,1),[])}));e.a=w}}]);
//# sourceMappingURL=default-vendors.9041d1.js.map